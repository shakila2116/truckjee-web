function ZE(a){"use strict";if(this.state="loading",this.mode="richtext",this.afterload=[],a&&"plaintext"===a.mode&&(this.mode="plaintext"),this.initobj=a||{},this.outerdiv=document.getElementById(a.id),this.editordiv=void 0,this.toolbardiv=void 0,this.toolbarobject=void 0,this.popupid="ze_popups",this.popupdiv=void 0,"smartCompose"===a.editorType?this.createEditor():(this.createGeneralToolbar(),this.createEditor()),ZE_Init.needEditorStats&&(this.clickCount={}),ZE_Init.needplaintext&&!this.initobj.avoidPlainText){var b=!ZE_Init.needEditorFocus;"plaintext"===this.mode&&this.plainText(a.content,{avoidFocus:b,plainTextData:ZE_Init.plainTextDataDef})}ZE.sendInitRequest()}ZE.create=function(a){"use strict";if(ZE_Init.loading){var b=function(){ZE_Init.loadURL(ZE_Init.jsPath+"/js/zep1.min.js","js")};setTimeout(b,0),delete ZE_Init.loading}return new ZE(a)},ZE.prototype.afterEditorLoad=function(a){"use strict";var b=this;b.state?b.afterload.push(a):a()},ZE.prototype.setContent=function(a,b){"use strict";var c,d=this,e=d.mode,f={};if("undefined"!=typeof a)if(d.state)c=function(a){return function(){d.setContent(a)}}(a),d.afterload.push(c);else if(e&&"plaintext"===e)d._textarea.value=a;else{d.initobj.handlePasteImages&&(f.oldState=b),d.squireInstance.setHTML(a,f),d.win.focus(),b||d.saveCurrentState();try{d.updateToolbar()}catch(g){}}},ZE.setProcessedContent=function(a){"use strict";var b=this,c=b.mode;a=c&&"plaintext"===c?a.replace(/\n/gi,"<br/>"):a.replace(/<br.*?>/gi,"\n")},ZE.i18n=function(a){"use strict";var b=ZE_Init.language;return b&&"en"!==b?ZE.i18nObj[a]||a:a},ZE.prototype.focusAtStart=function(a){"use strict";var b=this,c=b.win,d=b.doc,e=c.getSelection()||d.selection;if(e){var f=b._createRange(e);d.body.firstChild?(f.setStart(d.body.firstChild,0),f.setEnd(d.body.firstChild,0),e.removeAllRanges(),e.addRange(f)):e.collapse(d.body,0)}a?c.focus():setTimeout(function(){c.focus()},300)},ZE.prototype.getRawContent=function(){"use strict";var a=this;return a.scspan&&"none"!==a.scspan.style.display&&(a.removeSpellcheckspans(),a.scspan.style.display="none"),a.getContent()},ZE.prototype.getContent=function(a){"use strict";var b,c,d,e,f=this,g=f.mode;if(g&&"plaintext"===g){if(b=f._textarea,b&&(c=b.value,f.scspan&&"none"!==f.scspan.style.display&&(c=f.getSpellcheckRemovedContent("plaintext"),c=ZE.getText(c)),c))return ZE_Init.setContentProcessed&&(c=c.replace(/\r+/gi,""),c=c.replace(/\n/gi,"<br />")),c}else if(d=f.doc)return e=f.scspan&&"none"!==f.scspan.style.display?f.getSpellcheckRemovedContent("richtext"):a&&a.plaintext?d.body.innerText:d.body.innerHTML;return""},ZE.prototype.confirmPlainText=function(a){"use strict";var b=this,c=ZE.i18n;confirm(c("When you switch to plain text mode, you will loose the formatting and images. Continue ?"))&&(b.plainText(a),ZE_Init.modeChange&&ZE_Init.modeChange(b.mode))},ZE.prototype.plainText=function(a,b){"use strict";var c=this,d=c.toolbardiv.getElementsByTagName("ul"),e=c.toolbardiv.getElementsByTagName("font"),f=c._textarea,g=d.length;b=b||{},c.mode="plaintext";for(var h=0;h<g;h++)d[h].style.display="none",e[h]&&(e[h].style.display="none");var i=c.toolbarobject.otheroptions,j=c.toolbarobject.spellcheck,k=c.toolbarobject.attach;i&&(i.parentNode.parentNode.style.display=""),k&&(k.parentNode.parentNode.style.display=""),j&&(j.parentNode.parentNode.style.display=""),f||(f=document.createElement("textarea"),f.className="ze_area",c._textarea=f,c.editordiv.appendChild(f),f.onbeforedeactivate=function(){var a=document.selection;a&&(c.textrange=a.createRange())},ZE._addEvent(f,"keyup",function(){var a=this.value;c.initobj.contentChanged&&"function"==typeof c.initobj.contentChanged&&a!==c._textareaValue&&(c._textareaValue=a,c.initobj.contentChanged())}),ZE_Init.avoidDropDragHandle||ZE._addEvent(f,"dragover",function(a){var b,d=a.dataTransfer,e=ZE.i18n;if((null!==d.types||d.files&&d.files.length>0)&&(d.files&&d.files.length>0||(d.types.indexOf?d.types.indexOf("Files")>-1:d.types.contains("application/x-moz-file"))||"Files"===d.types[0])){var f,g;if(f=document.getElementById("mask_editor"),b=d.effectAllowed,d.dropEffect="move"===b||"linkMove"===b?"move":"copy",!f){f=document.createElement("div"),f.contentEditable="false",f.id="mask_editor",document.body.appendChild(f),ZE._addEvent(f,"dragover",function(a){clearTimeout(c.dragTimer);var b=a.dataTransfer.effectAllowed;a.dataTransfer.dropEffect="move"===b||"linkMove"===b?"move":"copy",c._stopEvent(a)}),ZE._addEvent(f,"dragleave",function(a){c.dragTimer=setTimeout(function(){var a=document.getElementById("mask_editor");a&&a.parentElement.removeChild(a)},250),c._stopEvent(a)}),ZE._addEvent(f,"drop",function(a){c._stopEvent(a),f&&f.parentElement.removeChild(f);var b=a.dataTransfer.files;b&&0!==b.length&&ZE_Init.fileUpload(c,b,a)});var h=c._textarea.getBoundingClientRect();f.style.left=h.left+"px",f.style.width=h.right+"px",f.style.height=h.height+"px",f.style.width=h.width+"px",f.style.top=h.top+"px",f.style.position="absolute",g=document.createElement("div"),g.className="ze_drag",g.contentEditable="false";var i=document.createElement("span");g.appendChild(i),i.innerHTML=e("Drop Files to Attach"),f.appendChild(g)}c._stopEvent(a)}})),a&&(f.value=b.plainTextData?a:ZE.getText(a)),c._textareaValue=f.value,c.iframe.style.display="none",f.style.height=c.iframe.style.height,f.style.display="";try{b.avoidFocus||(f.focus(),f.setSelectionRange&&f.setSelectionRange(0,0))}catch(l){}},ZE.prototype.richText=function(a){"use strict";for(var b=this,c=b.toolbardiv.getElementsByTagName("ul"),d=b._textarea,e=c.length,f=b.toolbardiv.getElementsByTagName("font"),g=0;g<e;g++)c[g].style.display="",f[g]&&(f[g].style.display="");b.mode="richtext",d.style.display="none",a?b.squireInstance.setHTML(ZE.getFormattedContent(a)):b.squireInstance.setHTML(""),ZE_Init.modeChange&&ZE_Init.modeChange(b.mode),b.stack&&b.stack.commands.length>0&&(b.stack.clearStack(),b.saveCurrentState({cursorPosition:{start:0,end:0}})),b.iframe.style.height=d.style.height,b.iframe.style.display="",setTimeout(function(){b.focusAtStart(!0),b.squireInstance.focus(),b.updateToolbar()},0)},ZE.getFormattedContent=function(a){"use strict";return a.replace(/ /gi," ").replace(/</gi,"&lt;").replace(/>/gi,"&gt;").replace(/\n/gi,"<br>")},ZE._setAttribute=function(a,b,c){"use strict";a.setAttribute(b,c)},ZE._appendChildren=function(a,b){"use strict";for(var c=b.length,d=0;d<c;d++)a.appendChild(b[d])},ZE._setStyle=function(a,b,c){"use strict";if("object"==typeof b)for(var d=Object.keys(b),e=d.length,f=0;f<e;f++)a.style[d[f]]=b[d[f]];else"string"==typeof b&&(a.style[b]=c)},ZE.setCss=function(a,b,c){"use strict";a.style[b]=c},ZE.getText=function(a){"use strict";if(a){var b=function(a){var b,c,d=[],e=[],f=[];if(b=document.createElement("div"),b.innerHTML="",a=a.replace(/\n+/gi,""),a=a.replace(/\r+/gi,""),a=a.replace(/<!--.*?-->/gi,""),a=a.replace(/<head>.*?<\/head>/gi,""),d=a.match(/<a .*? data-hugatt="hugatt".*?<\/a>/g),d||(d=a.match(/<a .*? data-hugatt="hugatt".*?<\/a>/g)),d){for(c=0;c<d.length;c++)b.innerHTML+=d[c],e.push(new RegExp(d[c]));for(f=b.getElementsByTagName("a"),c=0;c<d.length;c++){var g=f[c].innerHTML+"\n"+f[c].getAttribute("href");a=a.replace(e[c],g)}}return a=a.replace(/<div .*? data-hugatt="hugatt".*?><\/div>/g,""),a=a.replace(/<br.*?>/gi,"\n"),a=a.replace(/<hr.*?>/gi,"\n"),a=a.replace(/<\/p>/gi,"\n"),a=a.replace(/<\/h[1-6]>/gi,"\n"),a=a.replace(/<\/tr>/gi,"\n"),a=a.replace(/<\/li>/gi,"\n"),a=a.replace(/<\/td>/gi," "),a=a.replace(/<\/th>/gi,""),a=a.replace(/<.*?>/gi,""),a=a.replace(/&nbsp;/gi," "),a=a.replace(/&lt;/gi,"<"),a=a.replace(/&gt;/gi,">"),a=a.replace(/&quot;/gi,'"'),a=a.replace(/&amp;/gi,"&")},c=a.search(/<blockquote/gi);if(c!==-1){var d=a.search(/<blockquote/gi),e=a.toLowerCase().lastIndexOf("</blockquote>"),f=a.substring(d,e+13);return a=a.replace(f,"##===###===##"),f=b(f),f=f.replace(/\n/gi,"\n > "),f=" > "+f,a=b(a),a.search(/##===###===##/gi)!==-1&&(a=a.replace("##===###===##",f)),a}return b(a)}return""},ZE.prototype.setMode=function(a){"use strict";var b=this,c=b.mode;"plaintext"===a?c!==a&&b.confirmPlainText(""):"richtext"!==c&&b.richText("")},ZE.getCSRFCookie=function(a){"use strict";var b="ZE_CSRF_TOKEN",c=document.cookie.indexOf(b);if(c>-1){var d=b.length,e=a.doc.cookie.indexOf(b)+d,f=a.doc.cookie.indexOf(";",e);f>-1&&(f=a.doc.cookie.length);var g=a.doc.cookie.substring(e+1,f);return g}return null},ZE.getContextValue=function(){"use strict";return ZE_Init.contextVal?"/"+ZE_Init.contextVal:""},ZE.sendInitRequest=function(a){"use strict";var b=document.getElementById("ze_img_request"),c=ZE.getContextValue();b||(b=document.createElement("iframe"),b.name="ze_img_request",b.id="ze_img_request",b.style.width="0px",b.style.height="0px",b.style.border="0px",b.src=c+"/ze/blank?t="+(new Date).getTime(),document.body.appendChild(b)),"true"===a&&(b.src=c+"/ze/blank?t="+(new Date).getTime())},ZE.getCSRFParamName=function(){"use strict";return ZE_Init.csrfParamVal||"zereqid"},ZE.getCSRFCookie=function(a){"use strict";if(ZE_Init.csrfCookieVal&&ZE_Init.csrfParamVal)return ZE_Init.csrfCookieVal;var b=ZE_Init.csrfCookieName||"ZE_CSRF_TOKEN",c=document.cookie.indexOf(b);if(c>-1){var d=b.length,e=a.doc.cookie.indexOf(b)+d,f=a.doc.cookie.indexOf(";",e);f>-1&&(f=a.doc.cookie.length);var g=a.doc.cookie.substring(e+1,f);return g}return null},ZE.addClass=function(a,b){"use strict";a.className.indexOf(b)==-1&&(a.className?a.className+=" "+b:a.className=b)},ZE.removeClass=function(a,b){"use strict";a.className=a.className.replace(b,""),a.className=ZE.trim(a.className)},ZE._addEvent=function(a,b,c){"use strict";a&&(document.addEventListener?a.addEventListener(b,c,!0):a.attachEvent("on"+b,c))},ZE._removeEvent=function(a,b,c){"use strict";a&&(document.removeEventListener?a.removeEventListener(b,c,!0):a.detachEvent("on"+b,c))},ZE.hasClass=function(a,b){"use strict";return a.className.indexOf(b)>-1},ZE.showOverlay=function(){"use strict";var a;document.getElementById("ze_orly")||(a=document.createElement("div"),a.id="ze_overlay",a.className="ze_orly",document.body.appendChild(a),a.addEventListener("mousedown",function(a){a.preventDefault(),a.stopPropagation()},!1))},ZE.hideOverlay=function(){"use strict";var a=document.getElementById("ze_overlay");a.parentNode.removeChild(a)},ZE.trim=function(a){"use strict";return a=a.replace(/^\s*(.*)/,"$1"),a=a.replace(/(.*?)\s*$/,"$1")},ZE.prototype.getFormattingValues=function(a){"use strict";var b,c=this;c.win.getSelection?b=c.win.getSelection():c.doc.selection&&"Control"!==c.doc.selection.type&&(b=c.doc.selection);for(var d,e=b.anchorNode;null!=e;){if(e.className&&e.className===a){switch(a){case"size":d=e.style.fontSize;break;case"highlight":d=e.style.backgroundColor}break}e=e.parentNode}return d},ZE.prototype.extend=function(a,b){"use strict";var c,d;for(c in b)d=b[c],void 0!==d&&(a[c]=d);return a},ZE.prototype.saveCursorPosition=function(a){"use strict";var b,c=this,d=c.win,e=c.doc;if(d.getSelection&&e.createRange){var f=c.win.getSelection();if(f.rangeCount>0){var g=c.win.getSelection().getRangeAt(0),h=g.cloneRange();return h.selectNodeContents(a),h.setEnd(g.startContainer,g.startOffset),b=h.toString().length,{start:b,end:b+g.toString().length}}return{start:0,end:0}}if(e.selection){var i=e.selection.createRange(),j=e.body.createTextRange();return j.moveToElementText(a),j.setEndPoint("EndToStart",i),b=j.text.length,{start:b,end:b+i.text.length}}},ZE.prototype.restoreCursorPosition=function(a,b){"use strict";var c=this,d=c.win,e=c.doc,f=!1;if(d.getSelection&&e.createRange){var g=0,h=c.doc.createRange();h.setStart(a,0),h.collapse(!0),0==b.start&&0==b.end&&(f=!0);var i,j=[a],k=!1,l=!1;if(!f)for(;!l&&(i=j.pop());)if(3===i.nodeType){var m=g+i.length;!k&&b.start>=g&&b.start<=m&&(h.setStart(i,b.start-g),k=!0),k&&b.end>=g&&b.end<=m&&(h.setEnd(i,b.end-g),l=!0),g=m}else for(var n=i.childNodes.length;n--;)j.push(i.childNodes[n]);var o=c.win.getSelection();o.removeAllRanges(),o.addRange(h)}else if(e.selection){var p=e.body.createTextRange();p.moveToElementText(a),p.collapse(!0),p.moveEnd("character",b.end),p.moveStart("character",b.start),p.select()}},ZE.prototype.saveCurrentState=function(a){"use strict";var b,c=this,d=c.doc;a=a||{},b=a.cursorPosition,c.stack&&(b?c.stack.execute(new c.EditorState(d.body,c.getContent(),b)):c.stack.execute(new c.EditorState(d.body,c.getContent(),c.saveCursorPosition(d.body))),c.initobj.contentChanged&&"function"==typeof c.initobj.contentChanged&&!a.suppressContentChange&&c.initobj.contentChanged())},ZE.prototype.getPosFromCursor=function(a,b){"use strict";var c=this,d=c.squireInstance.getPath(),e=[],f=b?b:0;d.length>0&&(e=d.split(">"));var g,h=-1;for(g=e.length-1;g>=0;g--)if(e[g]===a){if(0===f){h=g;break}f-=1}return h},ZE.prototype.fontsizeConversion=function(a,b){"use strict";var c={8:"10",10:"13",12:"16",14:"18",18:"24",24:"32",36:"48"},d=Math.round(.75*b),e={1:"8",2:"10",3:"12",4:"14",5:"18",6:"24",7:"36"},f={1:"10",2:"13",3:"16",4:"18",5:"24",6:"32",7:"48"};return"pttopx"===a?c[b]:"pxtopt"===a?d:"fontvaltopt"===a?e[b]:"fontvaltopx"===a?f[b]:void 0},ZE.tabHandler=function(a,b,c){"use strict";var d=this,e=b.getSelection().anchorNode;if(ZE_Init.tabKeyHandling&&(a.preventDefault(),!c.queryCommandState("insertOrderedList")&&!c.queryCommandState("insertUnOrderedList"))){for(b.getSelection().collapseToStart();null!==e;){if("TD"===e.nodeName){e=b.getSelection();var f=document.createRange(),g=e.anchorNode.parentNode,h=g;return 3===b.getSelection().anchorNode.nodeType?(h=g.parentElement,g=h.nextSibling):(h=g,g=h.nextSibling),null===g&&(g=e.anchorNode.parentElement.parentElement.nextSibling,g=g&&"TR"===g.nodeName?g.firstChild:d.createNewTableRow(e)),f.setStart(g.firstChild,0),f.collapse(!0),e.removeAllRanges(),void e.addRange(f)}e=e.parentElement}c.execCommand("insertHTML",!1,"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;")}},ZE.fsDisp={1:"8",2:"10",3:"12",4:"14",5:"18",6:"24",7:"36"},ZE.ffDisp={arial:"Arial","comic sans ms":"Comic Sans MS",verdana:"Verdana",georgia:"Georgia",tahoma:"Tahoma",calibri:"Calibri","courier new":"Courier New",serif:"Serif","sans-serif":"Serif","arial narrow":"Narrow","arial black":"Wide","times new roman":"Times New Roman",garamond:"Garamond",batang:"Serif","trebuchet ms":"Trebuchet",times:"Times New Roman"},ZE.getHookMethod=function(a,b){"use strict";if("function"==typeof b)return function(c,d,e){e.originator&&e.originator===a&&b(c,d)}},ZE.addHook=function(a,b){"use strict";"function"==typeof b&&DOMPurify.addHook(a,b)},ZE.removeHook=function(a,b){"use strict";"function"==typeof b&&DOMPurify.removeHook(a,b)},ZE.createDraftToolbar=function(a){"use strict";var b,c,d,e,f,g,h,i,j,k,l,m,n,o={},p=document,q=(p.body,ZE.i18n),r=0,b=a;for(c=p.createElement("div"),c.className="ze_SCmb",d=b.length,r=0;r<d;r++){for(e=p.createElement("ul"),h=b[r],i=0,j=h.length;i<j;i++){if(k=h[i],l=k[0],m=k[2],f=p.createElement("li"),e.appendChild(f),"otheroptions"===l&&(e.className="ze_frt",e.style.display=""),n=p.createElement("b"),"attach"===l&&(n.className="ze_Sel ze_bg"),"fontsize"===l){var s=p.createElement("span");n.style.minWidth="36px",n.appendChild(s),s.className="ze_pdl"}var t,u=p.createElement("span");u.className=m,"fontsize"===l&&(u.style.cssFloat="right"),n.appendChild(u),"attach"!==l&&"alignoptions"!==l&&"listoptions"!==l&&"spellcheck"!==l||(t=document.createElement("span"),t.className="zei-arrow",n.appendChild(t)),f.appendChild(n),n.title=q(k[1]),o[l]=n,0!==i&&(g=document.createElement("div"),n.appendChild(g))}c.appendChild(e)}return c},function(){var a;a=this.ze_Undo={},a.Stack=function(){this.commands=[],this.stackPosition=-1,this.lastSavedState="",this.execute=function(a){this.lastSavedState!=a.newValue&&(this.lastSavedState=a.newValue,this.clearRedo(),this.stackPosition+1>100&&(this.commands.splice(0,1),this.stackPosition-=1),this.commands.push(a),this.stackPosition++)},this.clearStack=function(){this.stackPosition=-1,this.commands.splice(0,this.commands.length),this.lastSavedState=""},this.undo=function(){this.stackPosition>0&&(this.stackPosition--,this.commands[this.stackPosition].undo(),this.commands[this.stackPosition].setFocus(),this.lastSavedState=this.commands[this.stackPosition].newValue)},this.canUndo=function(){return this.stackPosition>0},this.redo=function(){this.stackPosition++,this.commands[this.stackPosition].redo(),this.lastSavedState=this.commands[this.stackPosition].newValue,this.commands[this.stackPosition].setFocus()},this.canRedo=function(){return this.stackPosition<this.commands.length-1},this.clearRedo=function(){this.commands=this.commands.slice(0,this.stackPosition+1)}}}.call(this),function(a,b){"use strict";function c(a,b,c){this.root=this.currentNode=a,this.nodeType=b,this.filter=c}function d(a,b){for(var c=a.length;c--;)if(!b(a[c]))return!1;return!0}function e(a){return a.nodeType===M&&!!ta[a.nodeName]}function f(a){if(oa&&ya.has(a))return ya.get(a);var b,c=a.nodeType;return b=c===N?va:c!==M&&c!==P?ua:d(a.childNodes,g)?sa.test(a.nodeName)?va:wa:xa,oa&&ya.set(a,b),b}function g(a){return f(a)===va}function h(a){return f(a)===wa}function i(a){return f(a)===xa}function j(a,b){var d=new c(b,Q,h);return d.currentNode=a,d}function k(a,b){return a=j(a,b).previousNode(),a!==b?a:null}function l(a,b){return a=j(a,b).nextNode(),a!==b?a:null}function m(a,b){return!e(a)&&a.nodeType===b.nodeType&&a.nodeName===b.nodeName&&"A"!==a.nodeName&&a.className===b.className&&(!a.style&&!b.style||a.style.cssText===b.style.cssText)}function n(a,b,c){if(a.nodeName!==b)return!1;for(var d in c)if(a.getAttribute(d)!==c[d])return!1;return!0}function o(a,b,c,d){for(;a&&a!==b;){if(n(a,c,d))return a;a=a.parentNode}return null}function p(a,b){for(;b;){if(b===a)return!0;b=b.parentNode}return!1}function q(a,b){var c,d,e,f,g="";return a&&a!==b&&(g=q(a.parentNode,b),a.nodeType===M&&(g+=(g?">":"")+a.nodeName,(c=a.id)&&(g+="#"+c),(d=a.className.trim())&&(e=d.split(/\s\s*/),e.sort(),g+=".",g+=e.join(".")),(f=a.dir)&&(g+="[dir="+f+"]"),e&&(qa.call(e,W)>-1&&(g+="[backgroundColor="+a.style.backgroundColor.replace(/ /g,"")+"]"),qa.call(e,X)>-1&&(g+="[color="+a.style.color.replace(/ /g,"")+"]"),qa.call(e,Y)>-1&&(g+="[fontFamily="+a.style.fontFamily.replace(/ /g,"")+"]"),qa.call(e,Z)>-1&&(g+="[fontSize="+a.style.fontSize+"]")))),g}function r(a){var b=a.nodeType;return b===M?a.childNodes.length:a.length||0}function s(a){var b=a.parentNode;return b&&b.removeChild(a),a}function t(a,b){var c=a.parentNode;c&&c.replaceChild(b,a)}function u(a){for(var b=a.ownerDocument.createDocumentFragment(),c=a.childNodes,d=c?c.length:0;d--;)b.appendChild(a.firstChild);return b}function v(a,c,d,e){var f,g,h,i,j=a.createElement(c);if(d instanceof Array&&(e=d,d=null),d)for(f in d)g=d[f],g!==b&&j.setAttribute(f,d[f]);if(e)for(h=0,i=e.length;h<i;h+=1)j.appendChild(e[h]);return j}function w(a,b){var c,d,f=a.ownerDocument,h=a;if(a===b&&((d=a.firstChild)&&"BR"!==d.nodeName||(c=E(f).createDefaultBlock(),d?a.replaceChild(c,d):a.appendChild(c),a=c,c=null)),a.nodeType===N)return h;if(g(a)){for(d=a.firstChild;la&&d&&d.nodeType===N&&!d.data;)a.removeChild(d),d=a.firstChild;d||(la?(c=f.createTextNode($),E(f)._didAddZWS()):c=f.createTextNode(""))}else if(ka){for(;a.nodeType!==N&&!e(a);){if(d=a.firstChild,!d){c=f.createTextNode("");break}a=d}a.nodeType===N?/^ +$/.test(a.data)&&(a.data=""):e(a)&&a.parentNode.insertBefore(f.createTextNode(""),a)}else if(!a.querySelector("BR"))for(c=v(f,"BR");(d=a.lastElementChild)&&!g(d);)a=d;if(c)try{a.appendChild(c)}catch(i){E(f).didError({name:"Squire: fixCursor – "+i,message:"Parent: "+a.nodeName+"/"+a.innerHTML+" appendChild: "+c.nodeName})}return h}function x(a,b){var c,d,e,f,h=a.childNodes,j=a.ownerDocument,k=null,l=E(j)._config;for(c=0,d=h.length;c<d;c+=1)e=h[c],f="BR"===e.nodeName,!f&&g(e)?(k||(k=v(j,l.blockTag,l.blockAttributes)),k.appendChild(e),c-=1,d-=1):(f||k)&&(k||(k=v(j,l.blockTag,l.blockAttributes)),w(k,b),f?a.replaceChild(k,e):(a.insertBefore(k,e),c+=1,d+=1),k=null),i(e)&&x(e,b);return k&&a.appendChild(w(k,b)),a}function y(a,b,c,d){var e,f,g,h=a.nodeType;if(h===N&&a!==c)return y(a.parentNode,a.splitText(b),c,d);if(h===M){if("number"==typeof b&&(b=b<a.childNodes.length?a.childNodes[b]:null),a===c)return b;for(e=a.parentNode,f=a.cloneNode(!1);b;)g=b.nextSibling,f.appendChild(b),b=g;return"OL"===a.nodeName&&o(a,d,"BLOCKQUOTE")&&(f.start=(+a.start||1)+a.childNodes.length-1),w(a,d),w(f,d),(g=a.nextSibling)?e.insertBefore(f,g):e.appendChild(f),y(e,f,c,d)}return b}function z(a,b){for(var c,d,e,f=a.childNodes,h=f.length,i=[];h--;)if(c=f[h],d=h&&f[h-1],h&&g(c)&&m(c,d)&&!ta[c.nodeName])b.startContainer===c&&(b.startContainer=d,b.startOffset+=r(d)),b.endContainer===c&&(b.endContainer=d,b.endOffset+=r(d)),b.startContainer===a&&(b.startOffset>h?b.startOffset-=1:b.startOffset===h&&(b.startContainer=d,b.startOffset=r(d))),b.endContainer===a&&(b.endOffset>h?b.endOffset-=1:b.endOffset===h&&(b.endContainer=d,b.endOffset=r(d))),s(c),c.nodeType===N?d.appendData(c.data):i.push(u(c));else if(c.nodeType===M){for(e=i.length;e--;)c.appendChild(i.pop());z(c,b)}}function A(a,b){if(a.nodeType===N&&(a=a.parentNode),a.nodeType===M){var c={startContainer:b.startContainer,startOffset:b.startOffset,endContainer:b.endContainer,endOffset:b.endOffset};z(a,c),b.setStart(c.startContainer,c.startOffset),b.setEnd(c.endContainer,c.endOffset)}}function B(a,b,c){for(var d,e,f=b;1===f.parentNode.childNodes.length;)f=f.parentNode;"TD"!=f.nodeName&&(s(f),e=a.childNodes.length,d=a.lastChild,d&&"BR"===d.nodeName&&(a.removeChild(d),e-=1),a.appendChild(u(b)),c.setStart(a,e),c.collapse(!0),A(a,c),ga&&(d=a.lastChild)&&"BR"===d.nodeName&&a.removeChild(d))}function C(a,b){var c,d,e=a.previousSibling,f=a.firstChild,g=a.ownerDocument,h="LI"===a.nodeName;if(!h||f&&/^[OU]L$/.test(f.nodeName))if(e&&m(e,a)){if(!i(e)){if(!h)return;d=v(g,"DIV"),d.appendChild(u(e)),e.appendChild(d)}s(a),c=!i(a),e.appendChild(u(a)),c&&x(e,b),f&&C(f,b)}else h&&(e=v(g,"DIV"),a.insertBefore(e,f),w(e,b))}function D(a){this.isShiftDown=a.shiftKey}function E(a){for(var b,c=ib.length;c--;)if(b=ib[c],b._doc===a)return b;return null}function F(a,b,c){var d,e;if(a||(a={}),b)for(d in b)!c&&d in a||(e=b[d],a[d]=e&&e.constructor===Object?F(a[d],e,c):e);return a}function G(a,b){a.nodeType===O&&(a=a.body);var c,d=a.ownerDocument,e=d.defaultView;this._win=e,this._doc=d,this._root=a,this._events={},b&&b.getEditorInstance&&(this._editorRef=b.getEditorInstance),this._isFocused=!1,this._lastSelection=null,ma&&this.addEventListener("beforedeactivate",this.getSelection),this._hasZWS=!1,this._lastAnchorNode=null,this._lastFocusNode=null,this._path="",this._willUpdatePath=!1,"onselectionchange"in d?this.addEventListener("selectionchange",this._updatePathOnEvent):(this.addEventListener("keyup",this._updatePathOnEvent),this.addEventListener("mouseup",this._updatePathOnEvent)),this._undoIndex=-1,this._undoStack=[],this._undoStackLength=0,this._isInUndoState=!1,this._ignoreChange=!1,this._ignoreAllChanges=!1,na?(c=new MutationObserver(this._docWasChanged.bind(this)),c.observe(a,{childList:!0,attributes:!0,characterData:!0,subtree:!0}),this._mutation=c):this.addEventListener("keyup",this._keyUpDetectChange),this._restoreSelection=!1,this.addEventListener("blur",H),this.addEventListener("mousedown",I),this.addEventListener("touchstart",I),this.addEventListener("focus",J),this._awaitingPaste=!1,this.addEventListener(fa?"beforecut":"cut",eb),this.addEventListener("copy",fb),this.addEventListener("keydown",D),this.addEventListener("keyup",D),this.addEventListener(fa?"beforepaste":"paste",gb),this.addEventListener("drop",hb),this.addEventListener(ga?"keypress":"keydown",Pa),this._keyHandlers=Object.create(Ra),this.setConfig(b&&b.config),fa&&(e.Text.prototype.splitText=function(a){var b=this.ownerDocument.createTextNode(this.data.slice(a)),c=this.nextSibling,d=this.parentNode,e=this.length-a;return c?d.insertBefore(b,c):d.appendChild(b),e&&this.deleteData(a,e),b}),a.setAttribute("contenteditable","true");try{d.execCommand("enableObjectResizing",!1,"false"),d.execCommand("enableInlineTableEditing",!1,"false")}catch(f){}ib.push(this)}function H(){this._restoreSelection=!0}function I(){this._restoreSelection=!1}function J(){this._restoreSelection&&this.setSelection(this._lastSelection)}function K(a,b,c){var d,e;for(d=b.firstChild;d;d=e){if(e=d.nextSibling,g(d)){if(d.nodeType===N||"BR"===d.nodeName||"IMG"===d.nodeName){c.appendChild(d);continue}}else if(h(d)){c.appendChild(a.createDefaultBlock([K(a,d,a._doc.createDocumentFragment())]));continue}K(a,d,c)}return c}var L=2,M=1,N=3,O=9,P=11,Q=1,R=4,S=0,T=1,U=2,V=3,W="highlight",X="colour",Y="font",Z="size",$="​",_=a.defaultView,aa=navigator.userAgent,ba=/iP(?:ad|hone|od)/.test(aa),ca=/Mac OS X/.test(aa),da=/Android/.test(aa),ea=/Gecko\//.test(aa),fa=/Trident\/[456]\./.test(aa),ga=!!_.opera,ha=/Edge\//.test(aa),ia=!ha&&/WebKit\//.test(aa),ja=/Trident\/[4567]\./.test(aa),ka=fa||ga,la=fa||ia,ma=fa,na="undefined"!=typeof MutationObserver,oa="undefined"!=typeof WeakMap,pa=/[^ \t\r\n]/,qa=Array.prototype.indexOf;Object.create||(Object.create=function(a){var b=function(){};return b.prototype=a,new b});var ra={1:1,2:2,3:4,8:128,9:256,11:1024};c.prototype.nextNode=function(){for(var a,b=this.currentNode,c=this.root,d=this.nodeType,e=this.filter;;){for(a=b.firstChild;!a&&b&&b!==c;)a=b.nextSibling,a||(b=b.parentNode);if(!a)return null;if(ra[a.nodeType]&d&&e(a))return this.currentNode=a,a;b=a}},c.prototype.previousNode=function(){for(var a,b=this.currentNode,c=this.root,d=this.nodeType,e=this.filter;;){if(b===c)return null;if(a=b.previousSibling)for(;b=a.lastChild;)a=b;else a=b.parentNode;if(!a)return null;if(ra[a.nodeType]&d&&e(a))return this.currentNode=a,a;b=a}},c.prototype.previousPONode=function(){for(var a,b=this.currentNode,c=this.root,d=this.nodeType,e=this.filter;;){for(a=b.lastChild;!a&&b&&b!==c;)a=b.previousSibling,a||(b=b.parentNode);if(!a)return null;if(ra[a.nodeType]&d&&e(a))return this.currentNode=a,a;b=a}};var sa=/^(?:#text|A(?:BBR|CRONYM)?|B(?:R|D[IO])?|C(?:ITE|ODE)|D(?:ATA|EL|FN)|EM|FONT|HR|I(?:FRAME|MG|NPUT|NS)?|KBD|Q|R(?:P|T|UBY)|S(?:AMP|MALL|PAN|TR(?:IKE|ONG)|U[BP])?|TIME|U|VAR|WBR)$/,ta={BR:1,HR:1,IFRAME:1,IMG:1,INPUT:1},ua=0,va=1,wa=2,xa=3,ya=oa?new WeakMap:null,za=function(a,b){for(var c=a.childNodes;b&&a.nodeType===M;)a=c[b-1],c=a.childNodes,b=c.length;return a},Aa=function(a,b){if(a.nodeType===M){var c=a.childNodes;if(b<c.length)a=c[b];else{for(;a&&!a.nextSibling;)a=a.parentNode;a&&(a=a.nextSibling)}}return a},Ba=function(a,b){var c,d,e,f,g=a.startContainer,h=a.startOffset,i=a.endContainer,j=a.endOffset;g.nodeType===N?(c=g.parentNode,d=c.childNodes,h===g.length?(h=qa.call(d,g)+1,a.collapsed&&(i=c,j=h)):(h&&(f=g.splitText(h),i===g?(j-=h,i=f):i===c&&(j+=1),g=f),h=qa.call(d,g)),g=c):d=g.childNodes,e=d.length,h===e?g.appendChild(b):g.insertBefore(b,d[h]),g===i&&(j+=d.length-e),a.setStart(g,h),a.setEnd(i,j)},Ca=function(a,b,c){var d=a.startContainer,e=a.startOffset,f=a.endContainer,g=a.endOffset;b||(b=a.commonAncestorContainer),b.nodeType===N&&(b=b.parentNode);for(var h,i,j,k=y(f,g,b,c),l=y(d,e,b,c),m=b.ownerDocument.createDocumentFragment();l!==k;)h=l.nextSibling,m.appendChild(l),l=h;return d=b,e=k?qa.call(b.childNodes,k):b.childNodes.length,j=b.childNodes[e],i=j&&j.previousSibling,i&&i.nodeType===N&&j.nodeType===N&&(d=i,e=i.length,i.appendData(j.data),s(j)),a.setStart(d,e),a.collapse(!0),w(b,c),m},Da=function(a,b){Ha(a);var c=a.startContainer,d=a.endContainer,e=(g(c)||h(c))&&(g(d)||h(d)),f=Ca(a,null,b);Ga(a),c=Ia(a,b),e&&(d=Ja(a,b),c&&d&&c!==d&&B(c,d,a)),c&&w(c,b);var i=b.firstChild;return i&&"BR"!==i.nodeName?a.collapse(!1):(w(b,b),a.selectNodeContents(b.firstChild)),f},Ea=function(a,b,c){for(var d=!0,e=b.childNodes,f=e.length;f--;)if(!g(e[f])){d=!1;break}if(a.collapsed||Da(a,c),Ga(a),d)Ba(a,b),a.startContainer!==a.endContainer&&A(a.endContainer,a),A(a.startContainer,a),a.collapse(!1);else{for(var j,m,n,p,q,r=a.startContainer,s=y(r,a.startOffset,o(r.parentNode,c,"BLOCKQUOTE")||o(r.parentNode,c,"TD")||c,c),t=s.previousSibling,u=t,v=u.childNodes.length,x=s,z=0,B=s.parentNode;(j=u.lastChild)&&j.nodeType===M;){if("BR"===j.nodeName){v-=1;break}u=j,v=u.childNodes.length}for(;(j=x.firstChild)&&j.nodeType===M&&"BR"!==j.nodeName;)x=j;for(q=u.childNodes[v]||null;(j=b.firstChild)&&g(j);)u.insertBefore(j,q);for(;(j=b.lastChild)&&g(j);)x.insertBefore(j,x.firstChild),z+=1;for(m=b;m=l(m,c);)w(m,c);if(B.insertBefore(b,s),p=t.nextSibling,m=k(p,c),m&&!/\S/.test(m.textContent))do B=m.parentNode,B.removeChild(m),m=B;while(m&&!m.lastChild&&m!==c);if(t.parentNode||(t=p.previousSibling),u.parentNode||(u=t||p.parentNode,v=t?t.childNodes.length:0),i(p)&&C(p,c),n=s.previousSibling,m=h(s)?s:l(s,c),m&&!/\S/.test(m.textContent))do B=m.parentNode,B.removeChild(m),m=B;while(m&&!m.lastChild&&m!==c);s.parentNode||(s=n.nextSibling),z||(x=n,z=n.childNodes.length),s&&i(s)&&C(s,c),a.setStart(u,v),a.setEnd(x,z),Ga(a)}},Fa=function(a,b,c){var d=b.ownerDocument.createRange();if(d.selectNode(b),c){var e=a.compareBoundaryPoints(V,d)>-1,f=a.compareBoundaryPoints(T,d)<1;return!e&&!f}var g=a.compareBoundaryPoints(S,d)<1,h=a.compareBoundaryPoints(U,d)>-1;return g&&h},Ga=function(a){for(var b,c=a.startContainer,d=a.startOffset,f=a.endContainer,g=a.endOffset,h=!0;c.nodeType!==N&&(b=c.childNodes[d],b&&!e(b));)c=b,d=0;if(g)for(;f.nodeType!==N;){if(b=f.childNodes[g-1],!b||e(b)){if(h&&b&&"BR"===b.nodeName){g-=1,h=!1;continue}break}f=b,g=r(f)}else for(;f.nodeType!==N&&(b=f.firstChild,b&&!e(b));)f=b;a.collapsed?(a.setStart(f,g),a.setEnd(c,d)):(a.setStart(c,d),a.setEnd(f,g))},Ha=function(a,b){var c,d=a.startContainer,e=a.startOffset,f=a.endContainer,g=a.endOffset,h=!0;for(b||(b=a.commonAncestorContainer);d!==b&&!e;)c=d.parentNode,e=qa.call(c.childNodes,d),d=c;for(;;){if(h&&f.nodeType!==N&&f.childNodes[g]&&"BR"===f.childNodes[g].nodeName&&(g+=1,h=!1),f===b||g!==r(f))break;c=f.parentNode,g=qa.call(c.childNodes,f)+1,f=c}a.setStart(d,e),a.setEnd(f,g)},Ia=function(a,b){var c,d=a.startContainer;return g(d)?c=k(d,b):d!==b&&h(d)?c=d:(c=za(d,a.startOffset),c=l(c,b)),c&&Fa(a,c,!0)?c:null},Ja=function(a,b){var c,d,e=a.endContainer;if(g(e))c=k(e,b);else if(e!==b&&h(e))c=e;else{if(c=Aa(e,a.endOffset),!c||!p(b,c))for(c=b;d=c.lastChild;)c=d;c=k(c,b)}return c&&Fa(a,c,!0)?c:null},Ka=new c(null,R|Q,function(a){return a.nodeType===N?pa.test(a.data):"IMG"===a.nodeName||"INPUT"===a.nodeName}),La=function(a,b){var c,d=a.startContainer,e=a.startOffset;if(Ka.root=null,d.nodeType===N){if(e)return!1;c=d}else if(c=Aa(d,e),c&&!p(b,c)&&(c=null),!c&&(c=za(d,e),c.nodeType===N&&c.length))return!1;return Ka.currentNode=c,Ka.root=Ia(a,b),!Ka.previousNode()},Ma=function(a,b){var c,d=a.endContainer,e=a.endOffset;if(Ka.root=null,d.nodeType===N){if(c=d.data.length,c&&e<c)return!1;Ka.currentNode=d}else Ka.currentNode=za(d,e);return Ka.root=Ja(a,b),!Ka.nextNode()},Na=function(a,b){var c,d=Ia(a,b),e=Ja(a,b);d&&e&&(c=d.parentNode,a.setStart(c,qa.call(c.childNodes,d)),c=e.parentNode,a.setEnd(c,qa.call(c.childNodes,e)+1))},Oa={8:"backspace",9:"tab",13:"enter",32:"space",33:"pageup",34:"pagedown",37:"left",39:"right",46:"delete",219:"[",221:"]"},Pa=function(a){var b=a.keyCode,c=Oa[b],d="",e=this.getSelection();a.defaultPrevented||(c||(c=String.fromCharCode(b).toLowerCase(),/^[A-Za-z0-9]$/.test(c)||(c="")),ga&&46===a.which&&(c="."),111<b&&b<124&&(c="f"+(b-111)),"backspace"!==c&&"delete"!==c&&(a.altKey&&(d+="alt-"),a.ctrlKey&&(d+="ctrl-"),a.metaKey&&(d+="meta-")),a.shiftKey&&(d+="shift-"),c=d+c,this._keyHandlers[c]?this._keyHandlers[c](this,a,e):1!==c.length||e.collapsed||(this.saveUndoState(e),Da(e,this._root),this._ensureBottomLine(),this.setSelection(e),this._updatePath(e,!0)))},Qa=function(a,b){try{b||(b=a.getSelection());var c,d=b.startContainer;for(d.nodeType===N&&(d=d.parentNode),c=d;g(c)&&(!c.textContent||c.textContent===$)&&0==c.getElementsByTagName("img").length;)d=c,c=d.parentNode;d!==c&&(b.setStart(c,qa.call(c.childNodes,d)),b.collapse(!0),c.removeChild(d),h(c)||(c=k(c,a._root)),w(c,a._root),Ga(b)),d===a._root&&(d=d.firstChild)&&"BR"===d.nodeName&&s(d),a._ensureBottomLine(),a.setSelection(b),
a._updatePath(b,!0)}catch(e){a.didError(e)}},Ra={enter:function(a,b,c){var d,e,f,g,h=a._root;b.preventDefault();var i=a._editorRef().initobj;if("function"==typeof i.isEnterKeyHandler){var j=i.isEnterKeyHandler();if(j===!0)return!0}if(g=document.getElementById("ze_autofill"),g&&g.getElementsByClassName("sel").length)return!0;if(a._recordUndoState(c),Cb(c.startContainer,h,a),a._removeZWS(),a._getRangeAndRemoveBookmark(c),c.collapsed||Da(c,h),d=Ia(c,h),!d||/^T[HD]$/.test(d.nodeName))return Ba(c,a.createElement("BR")),c.collapse(!1),a.setSelection(c),void a._updatePath(c,!0);if((e=o(d,h,"LI"))&&(d=e),!(d.textContent||d.getElementsByTagName("img").length>0)){if(o(d,h,"UL")||o(d,h,"OL"))return a.modifyBlocks(Ab,c);if(o(d,h,"BLOCKQUOTE"))return a.modifyBlocks(ub,c)}for(f=rb(a,d,c.startContainer,c.startOffset),nb(d),_a(d),w(d,h);f.nodeType===M;){var k,l=f.firstChild;if("A"===f.nodeName&&(!f.textContent||f.textContent===$)&&0==f.getElementsByTagName("img").length){l=a._doc.createTextNode(""),t(f,l),f=l;break}for(;l&&l.nodeType===N&&!l.data&&(k=l.nextSibling,k&&"BR"!==k.nodeName);)s(l),l=k;if(!l||"BR"===l.nodeName||l.nodeType===N&&!ga)break;f=l}c=a._createRange(f,0),a.setSelection(c),a._updatePath(c,!0),f.nodeType===N&&(f=f.parentNode),f.getBoundingClientRect().top+16>a._doc.documentElement.clientHeight&&f.scrollIntoView(!1)},backspace:function(a,b,c){var d=a._root;if(a._removeZWS(),a.saveUndoState(c),c.collapsed)if(La(c,d)){b.preventDefault();var e,f=Ia(c,d);if(!f)return;x(f.parentNode,d),e=k(f,d);var g=e&&o(e,d,"TABLE",{contenteditable:"false"});if(g&&(e=g),e){if(!e.isContentEditable)return void s(e);for(B(e,f,c),f=e.parentNode;f!==d&&!f.nextSibling;)f=f.parentNode;f!==d&&"TD"!=f.nodeName&&"TR"!=f.nodeName&&(f=f.nextSibling)&&C(f,d),a.setSelection(c)}else if(f){if(o(f,d,"UL")||o(f,d,"OL"))return a.modifyBlocks(Ab,c);if(o(f,d,"BLOCKQUOTE"))return a.modifyBlocks(tb,c);a.setSelection(c),a._updatePath(c,!0)}}else a.setSelection(c),setTimeout(function(){Qa(a)},0);else b.preventDefault(),Da(c,d),Qa(a,c)},"delete":function(a,b,c){var d,e,f,g,h,i,j=a._root;if(a._removeZWS(),a.saveUndoState(c),c.collapsed)if(Ma(c,j)){if(b.preventDefault(),d=Ia(c,j),!d)return;if(x(d.parentNode,j),e=l(d,j)){if(!e.isContentEditable)return void s(e);for(B(d,e,c),e=d.parentNode;e!==j&&!e.nextSibling;)e=e.parentNode;e!==j&&(e=e.nextSibling)&&C(e,j),a.setSelection(c),a._updatePath(c,!0)}}else{if(f=c.cloneRange(),Ha(c,a._root),g=c.endContainer,h=c.endOffset,g.nodeType===M&&(i=g.childNodes[h],i&&"IMG"===i.nodeName))return b.preventDefault(),s(i),Ga(c),void Qa(a,c);a.setSelection(f),setTimeout(function(){Qa(a)},0)}else b.preventDefault(),Da(c,j),Qa(a,c)},tab:function(a,b,c){var d,e,f=a._root;a._removeZWS();var g=!1;if(c.collapsed&&La(c,f))for(d=Ia(c,f);e=d.parentNode;){if("UL"===e.nodeName||"OL"===e.nodeName){d.previousSibling&&(b.preventDefault(),a.modifyBlocks(zb,c)),g=!0;break}d=e}!g&&window.ZE&&ZE.tabHandler&&ZE.tabHandler(b,a._win,a._doc)},"shift-tab":function(a,b,c){var d,e=a._root;a._removeZWS(),c.collapsed&&La(c,e)&&(d=c.startContainer,(o(d,e,"UL")||o(d,e,"OL"))&&(b.preventDefault(),a.modifyBlocks(Ab,c)))},space:function(a,b,c){var d,e;a._recordUndoState(c),Cb(c.startContainer,a._root,a),a._getRangeAndRemoveBookmark(c),d=c.endContainer,e=d.parentNode,c.collapsed&&"A"===e.nodeName&&!d.nextSibling&&c.endOffset===r(d)?c.setStartAfter(e):c.collapsed||(Da(c,a._root),a._ensureBottomLine(),a.setSelection(c),a._updatePath(c,!0)),a.setSelection(c)},left:function(a){a._removeZWS()},right:function(a){a._removeZWS()}};ca&&ea&&(Ra["meta-left"]=function(a,b){b.preventDefault();var c=mb(a);c&&c.modify&&c.modify("move","backward","lineboundary")},Ra["meta-right"]=function(a,b){b.preventDefault();var c=mb(a);c&&c.modify&&c.modify("move","forward","lineboundary")}),ca||(Ra.pageup=function(a){a.moveCursorToStart()},Ra.pagedown=function(a){a.moveCursorToEnd()});var Sa={1:10,2:13,3:16,4:18,5:24,6:32,7:48},Ta={backgroundColor:{regexp:pa,replace:function(a,b){return v(a,"SPAN",{"class":W,style:"background-color:"+b})}},color:{regexp:pa,replace:function(a,b){return v(a,"SPAN",{"class":X,style:"color:"+b})}},fontWeight:{regexp:/^bold|^700/i,replace:function(a){return v(a,"B")}},fontStyle:{regexp:/^italic/i,replace:function(a){return v(a,"I")}},fontFamily:{regexp:pa,replace:function(a,b){return v(a,"SPAN",{"class":Y,style:"font-family:"+b})}},fontSize:{regexp:pa,replace:function(a,b){return v(a,"SPAN",{"class":Z,style:"font-size:"+b})}},textDecoration:{regexp:/^underline/i,replace:function(a){return v(a,"U")}}},Ua=function(a){return function(b,c){var d=v(b.ownerDocument,a);return c.replaceChild(d,b),d.appendChild(u(b)),d}},Va=function(a,b){var c,d,e,f,g,h,i=a.style,j=a.ownerDocument;for(c in Ta)d=Ta[c],e=i[c],e&&d.regexp.test(e)&&(h=d.replace(j,e),g||(g=h),f&&f.appendChild(h),f=h,a.style[c]="");return g&&(f.appendChild(u(a)),"SPAN"===a.nodeName?b.replaceChild(g,a):a.appendChild(g)),f||a},Wa={P:Va,SPAN:Va,STRONG:Ua("B"),EM:Ua("I"),INS:Ua("U"),STRIKE:Ua("S"),IMG:function(a){if(a.getAttribute("style")){if(a.style.width){var b=a.style.width;b=b.replace("px",""),a.setAttribute("width",b)}if(a.style.height){var c=a.style.height;c=c.replace("px",""),a.setAttribute("height",c)}}return a},FONT:function(a,b){var c,d,e,f,g,h=a.face||a.style.fontFamily,i=a.size,j=a.color||a.style.color,k=a.ownerDocument;if(h&&(c=v(k,"SPAN",{"class":"font",style:"font-family:"+h}),g=c,f=c),i&&(d=v(k,"SPAN",{"class":"size",style:"font-size:"+Sa[i]+"px"}),g||(g=d),f&&f.appendChild(d),f=d),j)if(/^#?([\dA-F]{3}){1,2}$/i.test(j))"#"!==j.charAt(0)&&(j="#"+j),e=v(k,"SPAN",{"class":"colour",style:"color:"+j}),g||(g=e),f&&f.appendChild(e),f=e;else if(j.indexOf("rgb")>-1){j=j.replace(/rgb\(|\)/g,"").split(",");for(var l=j.length,m=0;m<l;m++)j[m]=parseInt(j[m],10).toString(16),j[m]=1==j[m].length?"0"+j[m]:j[m];j="#"+j.join(""),e=v(k,"SPAN",{"class":"colour",style:"color:"+j}),g||(g=e),f&&f.appendChild(e),f=e}return g||(g=f=v(k,"SPAN")),b.replaceChild(g,a),f.appendChild(u(a)),f},TT:function(a,b){var c=v(a.ownerDocument,"SPAN",{"class":"font",style:'font-family:menlo,consolas,"courier new",monospace'});return b.replaceChild(c,a),c.appendChild(u(a)),c}},Xa=/^(?:A(?:DDRESS|RTICLE|SIDE|UDIO)|BLOCKQUOTE|CAPTION|D(?:[DLT]|IV)|F(?:IGURE|IGCAPTION|OOTER)|H[1-6]|HEADER|L(?:ABEL|EGEND|I)|O(?:L|UTPUT)|P(?:RE)?|SECTION|T(?:ABLE|BODY|D|FOOT|H|HEAD|R)|COL(?:GROUP)?|UL)$/,Ya=/^(?:HEAD|META|STYLE)/,Za=new c(null,R|Q,function(){return!0}),$a=function Gb(a,b,c){var d,e,f,h,i,j,k,l,m,n,o,p,q,r,s=a.childNodes;for(c=c||{},r=function(){var a=this;a.setAttribute("orig_width",a.width),a.setAttribute("orig_height",a.height),"undefined"!=typeof ZE&&ZE.setImageSizeOptions(a,"bestfit",q.editordiv.offsetWidth),a.removeAttribute("data-zeLoad")},d=a;g(d);)d=d.parentNode;for(Za.root=d,e=0,f=s.length;e<f;e+=1)if(h=s[e],i=h.nodeName,j=h.nodeType,k=Wa[i],j===M){if(l=h.childNodes.length,k)h=k(h,a);else{if(Ya.test(i)){a.removeChild(h),e-=1,f-=1;continue}if(!Xa.test(i)&&!g(h)){e-=1,f+=l-1,a.replaceChild(u(h),h);continue}}if("IMG"===i&&c.handleWaitingImages)if(h.className.indexOf("ze_img_upload")>-1){var t=h.getAttribute("id");if(q=c.editorRef(),t&&q._unusedImagesList[t])h.setAttribute("data-zeload",!0),h.onload=r,h.src=q._unusedImagesList[t],h.removeAttribute("id"),h.removeAttribute("class"),delete q._unusedImagesList[t];else if(t&&!q._pendingImagesList[t]){a.removeChild(h),e-=1,f-=1;continue}}else h.hasAttribute("data-zeload")&&(q=c.editorRef(),h.onload=r);l&&Gb(h,b||"PRE"===i,c)}else{if(j===N){if(o=h.data,m=!pa.test(o.charAt(0)),n=!pa.test(o.charAt(o.length-1)),b||!m&&!n)continue;if(m){for(Za.currentNode=h;(p=Za.previousPONode())&&(i=p.nodeName,!("IMG"===i||"#text"===i&&pa.test(p.data)));)if(!g(p)){p=null;break}o=o.replace(/^[ \t\r\n]+/g,p?" ":"")}if(n){for(Za.currentNode=h;(p=Za.nextNode())&&!("IMG"===i||"#text"===i&&pa.test(p.data));)if(!g(p)){p=null;break}o=o.replace(/[ \t\r\n]+$/g,p?" ":"")}if(o){h.data=o;continue}}a.removeChild(h),e-=1,f-=1}return a},_a=function Hb(a){for(var b,c=a.childNodes,d=c.length;d--;)b=c[d],b.nodeType!==M||e(b)?b.nodeType!==N||b.data||a.removeChild(b):(Hb(b),g(b)&&!b.firstChild&&a.removeChild(b))},ab=function(a){return a.nodeType===M?"BR"===a.nodeName:pa.test(a.data)},bb=function(a){for(var b,d=a.parentNode;g(d);)d=d.parentNode;return b=new c(d,Q|R,ab),b.currentNode=a,!!b.nextNode()},cb=function(a,b){var c,d,e,f=a.querySelectorAll("BR"),h=[],i=f.length;for(c=0;c<i;c+=1)h[c]=bb(f[c]);for(;i--;)d=f[i],e=d.parentNode,e&&(h[i]?g(e)||x(e,b):s(d))},db=function(a,b){var c=b.ownerDocument.body;b.setAttribute("style","position:fixed;overflow:hidden;bottom:100%;right:100%;"),c.appendChild(b),a.setData("text/html",b.innerHTML),a.setData("text/plain",b.innerText||b.textContent),c.removeChild(b)},eb=function(a){var b=a.clipboardData,c=this.getSelection(),d=this.createElement("div"),e=this._root,f=this;this.saveUndoState(c),ha||ba||!b?setTimeout(function(){try{f._ensureBottomLine()}catch(a){f.didError(a)}},0):(Ha(c,e),d.appendChild(Da(c,e)),db(b,d),a.preventDefault()),this.setSelection(c)},fb=function(a){if(!ea){var b,c,d,e,f,g,h=a.clipboardData,i=this.getSelection(),j=this.createElement("div"),k=this._root;if(!ha&&!ba&&h){for(i=i.cloneRange(),b=Ia(i,k),c=Ja(i,k),d=b===c?b:k,Ga(i),Ha(i,d),e=i.cloneContents(),f=i.commonAncestorContainer,f.nodeType===N&&(f=f.parentNode);f&&f!==d;)g=f.cloneNode(!1),g.appendChild(e),e=g,f=f.parentNode;j.appendChild(e),db(h,j),a.preventDefault()}}},gb=function(a){var b,c,d,e,f,g=a.clipboardData,h=g&&g.items,i=this.isShiftDown,j=!1,k=!1,l=null,m=this;if(!ha&&h&&!ea){for(a.preventDefault(),b=h.length;b--;){if(c=h[b],d=c.type,!i&&"text/html"===d)return void c.getAsString(function(a){m.insertHTML(a,!0)});"text/plain"===d&&(l=c),!i&&/^image\/.*/.test(d)&&(k=!0)}return void(k?(this.fireEvent("dragover",{dataTransfer:g,preventDefault:function(){j=!0}}),j&&this.fireEvent("drop",{dataTransfer:g,editorCustomPaste:!0})):l&&c.getAsString(function(a){m.insertPlainText(a,!0)}))}if(e=g&&g.types,!ha&&e&&(qa.call(e,"text/html")>-1||!ea&&qa.call(e,"text/plain")>-1&&qa.call(e,"text/rtf")<0))return a.preventDefault(),void(!i&&(f=g.getData("text/html"))?this.insertHTML(f,!0):((f=g.getData("text/plain"))||(f=g.getData("text/uri-list")))&&this.insertPlainText(f,!0));this._awaitingPaste=!0;var n=this._doc.body,o=this.getSelection(),p=o.startContainer,q=o.startOffset,r=o.endContainer,t=o.endOffset,u=this.createElement("DIV",{contenteditable:"true",style:"position:fixed; overflow:hidden; top:0; right:100%; width:1px; height:1px;"});n.appendChild(u),o.selectNodeContents(u),this.setSelection(o),setTimeout(function(){try{m._awaitingPaste=!1;for(var a,b,c="",d=u;u=d;)d=u.nextSibling,s(u),a=u.firstChild,a&&a===u.lastChild&&"DIV"===a.nodeName&&(u=a),c+=u.innerHTML;b=m._createRange(p,q,r,t),m.setSelection(b),c&&m.insertHTML(c,!0)}catch(e){m.didError(e)}},0)},hb=function(a){for(var b=a.dataTransfer.types,c=b.length,d=!1,e=!1;c--;)switch(b[c]){case"text/plain":d=!0;break;case"text/html":e=!0;break;default:return}(e||d)&&this.saveUndoState()},ib=[],jb=G.prototype,kb=function(a,b,c){var d=c._doc,e=a?DOMPurify.sanitize(a,{WHOLE_DOCUMENT:!1,RETURN_DOM:!0,RETURN_DOM_FRAGMENT:!0}):null;return e?d.importNode(e,!0):d.createDocumentFragment()};jb.testPresenceinSelection=function(a,b,c,d){var e=this.getPath(),f=d.test(e)|this.hasFormat(c);return!(a!=b||!f)},jb.setConfig=function(a){return a=F({blockTag:"DIV",blockAttributes:null,tagAttributes:{blockquote:null,ul:null,ol:null,li:null,a:null},leafNodeNames:ta,undo:{documentSizeThreshold:-1,undoLimit:-1},isSetHTMLSanitized:!0,sanitizeToDOMFragment:"undefined"!=typeof DOMPurify&&DOMPurify.isSupported?kb:null},a,!0),a.blockTag=a.blockTag.toUpperCase(),this._config=a,this},jb.createElement=function(a,b,c){return v(this._doc,a,b,c)},jb.createDefaultBlock=function(a){var b=this._config;return w(this.createElement(b.blockTag,b.blockAttributes,a),this._root)},jb.didError=function(a){console.log(a)},jb.getDocument=function(){return this._doc},jb.getRoot=function(){return this._root},jb.modifyDocument=function(a){this._ignoreAllChanges=!0,this._mutation&&this._mutation.disconnect(),a(),this._ignoreAllChanges=!1,this._mutation&&(this._mutation.observe(this._root,{childList:!0,attributes:!0,characterData:!0,subtree:!0}),this._ignoreChange=!1)};var lb={pathChange:1,select:1,input:1,undoStateChange:1};jb.fireEvent=function(a,b){var c,d,e,f=this._events[a];if(/^(?:focus|blur)/.test(a))if(c=p(this._root,this._doc.activeElement),"focus"===a){if(!c||this._isFocused)return this;this._isFocused=!0}else{if(c||!this._isFocused)return this;this._isFocused=!1}if(f)for(b||(b={}),b.type!==a&&(b.type=a),f=f.slice(),d=f.length;d--;){e=f[d];try{e.handleEvent?e.handleEvent(b):e.call(this,b)}catch(g){g.details="Squire: fireEvent error. Event type: "+a,this.didError(g)}}return this},jb.destroy=function(){var a,b=ib.length,c=this._events;for(a in c)this.removeEventListener(a);for(this._mutation&&this._mutation.disconnect();b--;)ib[b]===this&&ib.splice(b,1);this._undoIndex=-1,this._undoStack=[],this._undoStackLength=0},jb.handleEvent=function(a){this.fireEvent(a.type,a)},jb.addEventListener=function(a,b){var c=this._events[a],d=this._root;return b?(c||(c=this._events[a]=[],lb[a]||("selectionchange"===a&&(d=this._doc),d.addEventListener(a,this,!0))),c.push(b),this):(this.didError({name:"Squire: addEventListener with null or undefined fn",message:"Event type: "+a}),this)},jb.removeEventListener=function(a,b){var c,d=this._events[a],e=this._root;if(d){if(b)for(c=d.length;c--;)d[c]===b&&d.splice(c,1);else d.length=0;d.length||(delete this._events[a],lb[a]||("selectionchange"===a&&(e=this._doc),e.removeEventListener(a,this,!0)))}return this},jb._createRange=function(a,b,c,d){if(a instanceof this._win.Range)return a.cloneRange();var e=this._doc.createRange();return e.setStart(a,b),c?e.setEnd(c,d):e.setEnd(a,b),e},jb.getCursorPosition=function(a){if(!a&&!(a=this.getSelection())||!a.getBoundingClientRect)return null;var b,c,d=a.getBoundingClientRect();return d&&!d.top&&(this._ignoreChange=!0,b=this._doc.createElement("SPAN"),b.textContent=$,Ba(a,b),d=b.getBoundingClientRect(),c=b.parentNode,c.removeChild(b),A(c,a)),d},jb._moveCursorTo=function(a){var b=this._root,c=this._createRange(b,a?0:b.childNodes.length);return Ga(c),this.setSelection(c),this},jb.moveCursorToStart=function(){return this._moveCursorTo(!0)},jb.moveCursorToEnd=function(){return this._moveCursorTo(!1)};var mb=function(a){return a._win.getSelection()||null};jb.setSelection=function(a){if(a)if(this._lastSelection=a,this._isFocused)if(da&&!this._restoreSelection)H.call(this),this.blur(),this.focus();else{ba&&this._win.focus();var b=mb(this);b&&(b.removeAllRanges(),b.addRange(a))}else H.call(this);return this},jb.getSelection=function(){var a,b,c,d=mb(this),f=this._root;return d&&d.rangeCount&&(a=d.getRangeAt(0).cloneRange(),b=a.startContainer,c=a.endContainer,b&&e(b)&&a.setStartBefore(b),c&&e(c)&&a.setEndBefore(c)),a&&p(f,a.commonAncestorContainer)?this._lastSelection=a:a=this._lastSelection,a||(a=this._createRange(f.firstChild,0)),a},jb.getSelectedText=function(){var a,b=this.getSelection(),d=new c(b.commonAncestorContainer,R|Q,function(a){return Fa(b,a,!0)}),e=b.startContainer,f=b.endContainer,h=d.currentNode=e,i="",j=!1;for(d.filter(h)||(h=d.nextNode());h;)h.nodeType===N?(a=h.data,a&&/\S/.test(a)&&(h===f&&(a=a.slice(0,b.endOffset)),h===e&&(a=a.slice(b.startOffset)),i+=a,j=!0)):("BR"===h.nodeName||j&&!g(h))&&(i+="\n",j=!1),h=d.nextNode();return i},jb.getPath=function(){return this._path};var nb=function(a,b){for(var d,e,f,h=new c(a,R,function(){return!0},(!1));e=h.nextNode();)for(;(f=e.data.indexOf($))>-1&&(!b||e.parentNode!==b);){if(1===e.length){do d=e.parentNode,d.removeChild(e),e=d,h.currentNode=d;while(g(e)&&!r(e));break}e.deleteData(f,1)}};jb._didAddZWS=function(){this._hasZWS=!0},jb._removeZWS=function(){this._hasZWS&&(nb(this._root),this._hasZWS=!1)},jb._updatePath=function(a,b){var c,d=a.startContainer,e=a.endContainer;(b||d!==this._lastAnchorNode||e!==this._lastFocusNode)&&(this._lastAnchorNode=d,this._lastFocusNode=e,c=d&&e?d===e?q(e,this._root):"(selection)":"",this._path!==c&&(this._path=c,this.fireEvent("pathChange",{path:c}))),a.collapsed||this.fireEvent("select")},jb._updatePathOnEvent=function(){var a=this;a._willUpdatePath||(a._willUpdatePath=!0,setTimeout(function(){a._willUpdatePath=!1,a._updatePath(a.getSelection())},0))},jb.focus=function(){return this._root.focus(),ja&&this.fireEvent("focus"),this},jb.blur=function(){return this._root.blur(),ja&&this.fireEvent("blur"),this};var ob="squire-selection-start",pb="squire-selection-end";jb._saveRangeToBookmark=function(a){var b,c=this.createElement("INPUT",{id:ob,type:"hidden"}),d=this.createElement("INPUT",{id:pb,type:"hidden"});Ba(a,c),a.collapse(!1),Ba(a,d),c.compareDocumentPosition(d)&L&&(c.id=pb,d.id=ob,b=c,c=d,d=b),a.setStartAfter(c),a.setEndBefore(d)},jb._getRangeAndRemoveBookmark=function(a){var b=this._root,c=b.querySelector("#"+ob),d=b.querySelector("#"+pb);if(c&&d){var e=c.parentNode,f=d.parentNode,g=qa.call(e.childNodes,c),h=qa.call(f.childNodes,d);e===f&&(h-=1),s(c),s(d),a||(a=this._doc.createRange()),a.setStart(e,g),a.setEnd(f,h),A(e,a),e!==f&&A(f,a),a.collapsed&&(e=a.startContainer,e.nodeType===N&&(f=e.childNodes[a.startOffset],f&&f.nodeType===N||(f=e.childNodes[a.startOffset-1]),f&&f.nodeType===N&&(a.setStart(f,0),a.collapse(!0))))}return a||null},jb._keyUpDetectChange=function(a){var b=a.keyCode;a.ctrlKey||a.metaKey||a.altKey||!(b<16||b>20)||!(b<33||b>45)||this._docWasChanged()},jb._docWasChanged=function(){if(oa&&(ya=new WeakMap),!this._ignoreAllChanges){if(na&&this._ignoreChange)return void(this._ignoreChange=!1);this._isInUndoState&&(this._isInUndoState=!1,this.fireEvent("undoStateChange",{canUndo:!0,canRedo:!1})),this.fireEvent("input")}},jb._recordUndoState=function(a){if(!this._isInUndoState){var b,c=this._undoIndex+=1,d=this._undoStack,e=this._config.undo,f=e.documentSizeThreshold,g=e.undoLimit;c<this._undoStackLength&&(d.length=this._undoStackLength=c),a&&this._saveRangeToBookmark(a),b=this._getHTML(),f>-1&&2*b.length>f&&g>-1&&c>g&&(d.splice(0,c-g),c=this._undoIndex=g,this._undoStackLength=g),d[c]=b,this._undoStackLength+=1,this._isInUndoState=!0}},jb.saveUndoState=function(a){return a===b&&(a=this.getSelection()),this._isInUndoState||(this._recordUndoState(a),this._getRangeAndRemoveBookmark(a)),this},jb.undo=function(){if(0!==this._undoIndex||!this._isInUndoState){this._recordUndoState(this.getSelection()),this._undoIndex-=1,this._setHTML(this._undoStack[this._undoIndex]);var a=this._getRangeAndRemoveBookmark();a&&this.setSelection(a),this._isInUndoState=!0,this.fireEvent("undoStateChange",{canUndo:0!==this._undoIndex,canRedo:!0}),this.fireEvent("input")}return this},jb.redo=function(){var a=this._undoIndex,b=this._undoStackLength;if(a+1<b&&this._isInUndoState){this._undoIndex+=1,this._setHTML(this._undoStack[this._undoIndex]);var c=this._getRangeAndRemoveBookmark();c&&this.setSelection(c),this.fireEvent("undoStateChange",{canUndo:!0,canRedo:a+2<b}),this.fireEvent("input")}return this},jb.hasFormat=function(a,b,d){if(a=a.toUpperCase(),b||(b={}),!d&&!(d=this.getSelection()))return!1;!d.collapsed&&d.startContainer.nodeType===N&&d.startOffset===d.startContainer.length&&d.startContainer.nextSibling&&d.setStartBefore(d.startContainer.nextSibling),!d.collapsed&&d.endContainer.nodeType===N&&0===d.endOffset&&d.endContainer.previousSibling&&d.setEndAfter(d.endContainer.previousSibling);var e,f,g=this._root,h=d.commonAncestorContainer;if(o(h,g,a,b))return!0;if(h.nodeType===N)return!1;e=new c(h,R,function(a){return Fa(d,a,!0)},(!1));for(var i=!1;f=e.nextNode();){if(!o(f,g,a,b))return!1;i=!0}return i},jb.getFontInfo=function(a){var c,d,e,f={color:b,backgroundColor:b,family:b,size:b},g=0;if(!a&&!(a=this.getSelection()))return f;if(c=a.commonAncestorContainer,a.collapsed||c.nodeType===N)for(c.nodeType===N&&(c=c.parentNode);g<4&&c;)(d=c.style)&&(!f.color&&(e=d.color)&&(f.color=e,g+=1),!f.backgroundColor&&(e=d.backgroundColor)&&(f.backgroundColor=e,g+=1),!f.family&&(e=d.fontFamily)&&(f.family=e,g+=1),!f.size&&(e=d.fontSize)&&(f.size=e,g+=1)),c=c.parentNode;return f},jb._addFormat=function(a,b,d){var e,f,h,i,j,k,l,m,n,p=this._root;if(d.collapsed){for(e=w(this.createElement(a,b),p),Ba(d,e),d.setStart(e.firstChild,e.firstChild.length),d.collapse(!0),n=e;g(n);)n=n.parentNode;nb(n,e)}else{if(f=new c(d.commonAncestorContainer,R|Q,function(a){return(a.nodeType===N||"BR"===a.nodeName||"IMG"===a.nodeName)&&Fa(d,a,!0)},(!1)),h=d.startContainer,j=d.startOffset,i=d.endContainer,k=d.endOffset,f.currentNode=h,f.filter(h)||(h=f.nextNode(),j=0),!h)return d;do l=f.currentNode,m=!o(l,p,a,b),m&&(l===i&&l.length>k&&l.splitText(k),l===h&&j&&(l=l.splitText(j),i===h&&(i=l,k-=j),h=l,j=0),e=this.createElement(a,b),t(l,e),e.appendChild(l));while(f.nextNode());i.nodeType!==N&&(l.nodeType===N?(i=l,k=l.length):(i=l.parentNode,k=1)),d=this._createRange(h,j,i,k)}return d},jb._removeFormat=function(a,b,c,d){this._saveRangeToBookmark(c);var e,f=this._doc;c.collapsed&&(la?(e=f.createTextNode($),this._didAddZWS()):e=f.createTextNode(""),Ba(c,e));for(var h=c.commonAncestorContainer;g(h);)h=h.parentNode;var i=c.startContainer,j=c.startOffset,k=c.endContainer,l=c.endOffset,m=[],o=function(a,b){if(!Fa(c,a,!1)){var d,e,f=a.nodeType===N;if(!Fa(c,a,!0))return void("INPUT"===a.nodeName||f&&!a.data||m.push([b,a]));if(f)a===k&&l!==a.length&&m.push([b,a.splitText(l)]),a===i&&j&&(a.splitText(j),m.push([b,a]));else for(d=a.firstChild;d;d=e)e=d.nextSibling,o(d,b)}},p=Array.prototype.filter.call(h.getElementsByTagName(a),function(d){return Fa(c,d,!0)&&n(d,a,b)});return d||p.forEach(function(a){o(a,a)}),m.forEach(function(a){var b=a[0].cloneNode(!1),c=a[1];t(c,b),b.appendChild(c)}),p.forEach(function(a){t(a,u(a))}),this._getRangeAndRemoveBookmark(c),e&&c.collapse(!1),A(h,c),c},jb.changeFormat=function(a,b,c,d){return c||(c=this.getSelection())?(this.saveUndoState(c),b&&(c=this._removeFormat(b.tag.toUpperCase(),b.attributes||{},c,d)),a&&(c=this._addFormat(a.tag.toUpperCase(),a.attributes||{},c)),this.setSelection(c),this._updatePath(c,!0),na||this._docWasChanged(),this):this};var qb={DT:"DD",DD:"DT",LI:"LI"},rb=function(a,b,c,d){var e=qb[b.nodeName],f=null,g=y(c,d,b.parentNode,a._root),h=a._config;return e||(e=h.blockTag,f=h.blockAttributes),n(g,e,f)||(b=v(g.ownerDocument,e,f),g.dir&&(b.dir=g.dir),t(g,b),b.appendChild(u(g)),g=b),g};jb.forEachBlock=function(a,b,c){if(!c&&!(c=this.getSelection()))return this;b&&this.saveUndoState(c);var d=this._root,e=Ia(c,d),f=Ja(c,d);if(e&&f)do if(a(e)||e===f)break;while(e=l(e,d));return b&&(this.setSelection(c),this._updatePath(c,!0),na||this._docWasChanged()),this},jb.modifyBlocks=function(a,b){if(!b&&!(b=this.getSelection()))return this;this._isInUndoState?this._saveRangeToBookmark(b):this._recordUndoState(b);var c,d=this._root;return Na(b,d),Ha(b,d),c=Ca(b,d,d),Ba(b,a.call(this,c)),b.endOffset<b.endContainer.childNodes.length&&C(b.endContainer.childNodes[b.endOffset],d),C(b.startContainer.childNodes[b.startOffset],d),this._getRangeAndRemoveBookmark(b),this.setSelection(b),this._updatePath(b,!0),na||this._docWasChanged(),this};var sb=function(a){return this.createElement("BLOCKQUOTE",this._config.tagAttributes.blockquote,[a])},tb=function(a){var b=this._root,c=a.querySelectorAll("blockquote");return Array.prototype.filter.call(c,function(a){return!o(a.parentNode,b,"BLOCKQUOTE")}).forEach(function(a){t(a,u(a))}),a},ub=function(){return this.createDefaultBlock([this.createElement("INPUT",{id:ob,type:"hidden"}),this.createElement("INPUT",{id:pb,type:"hidden"})])},vb=function(a,b,c){for(var d,e,f,g,h=j(b,a._root),i=a._config.tagAttributes,k=i[c.toLowerCase()],l=i.li;d=h.nextNode();)"LI"===d.parentNode.nodeName&&(d=d.parentNode,h.currentNode=d.lastChild),"LI"!==d.nodeName?(g=a.createElement("LI",l),d.dir&&(g.dir=d.dir),(f=d.previousSibling)&&f.nodeName===c?(f.appendChild(g),s(d)):t(d,a.createElement(c,k,[g])),g.appendChild(u(d)),h.currentNode=g):(d=d.parentNode,e=d.nodeName,e!==c&&/^[OU]L$/.test(e)&&t(d,a.createElement(c,k,[u(d)])))},wb=function(a){return vb(this,a,"UL"),a},xb=function(a){return vb(this,a,"OL"),a},yb=function(a){var b,c,d,e,f,g=a.querySelectorAll("UL, OL"),i=a.querySelectorAll("LI"),j=this._root;for(b=0,c=g.length;b<c;b+=1)d=g[b],e=u(d),x(e,j),t(d,e);for(b=0,c=i.length;b<c;b+=1)f=i[b],h(f)?t(f,this.createDefaultBlock([u(f)])):(x(f,j),t(f,u(f)));return a},zb=function(a){var b,c,d,e,f,g,h=a.querySelectorAll("LI"),j=this._config.tagAttributes;for(b=0,c=h.length;b<c;b+=1)d=h[b],i(d.firstChild)||(e=d.parentNode.nodeName,f=d.previousSibling,f&&(f=f.lastChild)&&f.nodeName===e||(g=j[e.toLowerCase()],f=this.createElement(e,g),t(d,f)),f.appendChild(d));return a},Ab=function(a){var b=this._root,c=a.querySelectorAll("LI");return Array.prototype.filter.call(c,function(a){return!i(a.firstChild)}).forEach(function(c){var d,e=c.parentNode,f=e.parentNode,g=c.firstChild,h=g;if(c.previousSibling&&(e=y(e,c,f,b)),/^[OU]L$/.test(f.nodeName))f.insertBefore(c,e),e.firstChild||f.removeChild(e);else for(;h&&(d=h.nextSibling,!i(h));)f.insertBefore(h,e),h=d;for("LI"===f.nodeName&&g.previousSibling&&y(f,g,f.parentNode,b);c!==a&&!c.childNodes.length;)e=c.parentNode,e.removeChild(c),c=e},this),x(a,b),a};jb._ensureBottomLine=function(){var a=this._root,b=a.lastElementChild;b&&b.nodeName===this._config.blockTag&&h(b)||(b&&"BR"==b.nodeName&&a.removeChild(b),a.appendChild(this.createDefaultBlock()))},jb.setKeyHandler=function(a,b){return this._keyHandlers[a]=b,this},jb._getHTML=function(){return this._root.innerHTML},jb._setHTML=function(a){var b=this._root,c=b;c.innerHTML=a;do w(c,b);while(c=l(c,b));this._ignoreChange=!0},jb.getHTML=function(a){var b,c,d,e,f,g,h=[];if(a&&(g=this.getSelection())&&this._saveRangeToBookmark(g),ka)for(b=this._root,c=b;c=l(c,b);)c.textContent||c.querySelector("BR")||(d=this.createElement("BR"),c.appendChild(d),h.push(d));if(e=this._getHTML().replace(/\u200B/g,""),ka)for(f=h.length;f--;)s(h[f]);return g&&this._getRangeAndRemoveBookmark(g),e},jb.setHTML=function(a,b){var c,d,e,f=this._config,g=f.isSetHTMLSanitized?f.sanitizeToDOMFragment:null,h=this._root;b=b||{};var i;"function"==typeof g?e=g(a,!1,this):(d=this.createElement("DIV"),d.innerHTML=a,e=this._doc.createDocumentFragment(),e.appendChild(u(d))),$a(e,!1,{editorRef:this._editorRef,handleWaitingImages:b.oldState}),cb(e,h),x(e,h);for(var j=e;j=l(j,h);)w(j,h);for(this._ignoreChange=!0;c=h.lastChild;)h.removeChild(c);h.appendChild(e),w(h,h),b.oldState&&(i=this._editorRef(),i.updateStateHTML(i.stack.stackPosition,h.innerHTML)),this._undoIndex=-1,this._undoStack.length=0,this._undoStackLength=0,this._isInUndoState=!1;var k=this._getRangeAndRemoveBookmark()||this._createRange(h.firstChild,0);return this.saveUndoState(k),this._lastSelection=k,H.call(this),this._updatePath(k,!0),this},jb.insertElement=function(a,b){if(b||(b=this.getSelection()),b.collapse(!0),g(a))Ba(b,a),b.setStartAfter(a);else{for(var c,d,e=this._root,f=Ia(b,e)||e;f!==e&&!f.nextSibling;)f=f.parentNode;f!==e&&(c=f.parentNode,d=y(c,f.nextSibling,e,e)),d?e.insertBefore(a,d):(e.appendChild(a),d=this.createDefaultBlock(),e.appendChild(d)),b.setStart(d,0),b.setEnd(d,0),Ga(b)}return this.focus(),this.setSelection(b),this._updatePath(b),na||this._docWasChanged(),this},jb.insertImage=function(a,b){var c=this.createElement("IMG",F({src:a},b,!0));return this.insertElement(c),c};var Bb=/\b((?:(?:ht|f)tps?:\/\/|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,}\/)(?:[^\s()<>]+|\([^\s()<>]+\))+(?:\((?:[^\s()<>]+|(?:\([^\s()<>]+\)))*\)|[^\s`!()\[\]{};:'".,<>?«»“”‘’]))|([\w\-.%+]+@(?:[\w\-]+\.)+[A-Z]{2,}\b)/i,Cb=function(a,b,d){for(var e,f,g,h,i,j,k,l=a.ownerDocument,m=new c(a,R,function(a){return!o(a,b,"A")},(!1)),n=d._config.tagAttributes.a;e=m.nextNode();)for(f=e.data,g=e.parentNode;h=Bb.exec(f);)i=h.index,j=i+h[0].length,i&&(k=l.createTextNode(f.slice(0,i)),g.insertBefore(k,e)),k=d.createElement("A",F({href:h[1]?/^(?:ht|f)tps?:/.test(h[1])?h[1]:"http://"+h[1]:"mailto:"+h[2]},n,!1)),k.textContent=f.slice(i,j),g.insertBefore(k,e),e.data=f=f.slice(j)},Db=function(a,b){a=a.replace("border=0","border=1");var c=a.lastIndexOf("<!--EndFragment-->");a=a.slice(0,c);var d,e,f,g,h,i=/<style([.\s\S])*>([.\s\S])*<\/style>/i.exec(a)[0],j=a.slice(a.search("<body")),k=/\.x([a-z][0-9]+)[\n]?(\s)*{([""#a-zA-Z0-9\n\s.:,;-]*)/g,l=i?i.match(k):[],m=l?l.length:0,n=[],o=[],p=b.createDocumentFragment(),q=b.createElement("div");if(q.innerHTML=j,p.appendChild(q),m){for(var r=0;r<m;r++)d=l[r].search("{"),n[r]=l[r].slice(0,d).trim(),o[r]=l[r].slice(d+1,l[r].length);e=n.length;var s=/([""\.a-zA-Z0-9-\n\s#:,])*/g;for(f=0;f<e;f++){var t,u,v,w,x={},y=q.firstElementChild.querySelectorAll(n[f]),z=y.length,A=o[f].match(s),B=A.length;for(h=0;h<B;h++)A[h]=A[h].trim(),A[h].length>0&&(t=A[h].slice(0,A[h].search(":")),x[t]=A[h].slice(A[h].search(":")+1,A[h].length));for(u=Object.keys(x),v=u.length,g=0;g<z;g++)for(w=0;w<v;w++)y[g].style[u[w]]=x[u[w]]}}return q.innerHTML};jb.insertHTML=function(a,b,c){var c,d=this._config;c=c||{};var e,f,g,h,i,j,k,m,n=d.isInsertedHTMLSanitized&&!c.avoidSanitize?d.sanitizeToDOMFragment:null,o=this.getSelection(),p=this._doc;if("function"==typeof n?h=n(a,b,this):(b&&(m=a.search(/<meta .* content=Excel\.Sheet>/g),m>0?a=Db(a,p):(e=a.indexOf("<!--StartFragment-->"),f=a.lastIndexOf("<!--EndFragment-->"),e>-1&&f>-1&&(a=a.slice(e+20,f)))),g=this.createElement("DIV"),g.innerHTML=a,h=p.createDocumentFragment(),h.appendChild(u(g))),b&&this._editorRef().initobj.handlePasteImages&&"IMG"===h.firstChild.nodeName){if("data:"===h.firstChild.src.substr(0,5))return this._editorRef()._uploadInlineImages({dataURI:h.firstChild.src}),void this.focus();if("webkit-fake"===h.firstChild.src.substr(0,11))return void this.focus()}this.saveUndoState(o);try{for(i=this._root,j=h,k={fragment:h,preventDefault:function(){this.defaultPrevented=!0},defaultPrevented:!1},Cb(h,h,this),$a(h),cb(h,null),_a(h),h.normalize();j=l(j,h);)w(j,null);b&&this.fireEvent("willPaste",k),k.defaultPrevented||(Ea(o,k.fragment,i),na||this._docWasChanged(),o.collapse(!1),this._ensureBottomLine()),this.setSelection(o),this._updatePath(o,!0),b&&this.focus()}catch(q){this.didError(q)}return this};var Eb=function(a){return a.split("&").join("&amp;").split("<").join("&lt;").split(">").join("&gt;").split('"').join("&quot;")};jb.insertPlainText=function(a,b){var c,d,e,f,g=a.split("\n"),h=this._config,i=h.blockTag,j=h.blockAttributes,k="</"+i+">",l="<"+i;for(c in j)l+=" "+c+'="'+Eb(j[c])+'"';for(l+=">",d=0,e=g.length;d<e;d+=1)f=g[d],f=Eb(f).replace(/ (?= )/g,"&nbsp;"),d&&d+1<e&&(f=l+(f||"<BR>")+k),g[d]=f;return this.insertHTML(g.join(""),b)};var Fb=function(a,b,c){return function(){return this[a](b,c),this.focus()}};jb.addStyles=function(a){if(a){var b=this._doc.documentElement.firstChild,c=this.createElement("STYLE",{type:"text/css"});c.appendChild(this._doc.createTextNode(a)),b.appendChild(c)}return this},jb.bold=Fb("changeFormat",{tag:"B"}),jb.italic=Fb("changeFormat",{tag:"I"}),jb.underline=Fb("changeFormat",{tag:"U"}),jb.strikethrough=Fb("changeFormat",{tag:"S"}),jb.subscript=Fb("changeFormat",{tag:"SUB"},{tag:"SUP"}),jb.superscript=Fb("changeFormat",{tag:"SUP"},{tag:"SUB"}),jb.removeBold=Fb("changeFormat",null,{tag:"B"}),jb.removeItalic=Fb("changeFormat",null,{tag:"I"}),jb.removeUnderline=Fb("changeFormat",null,{tag:"U"}),jb.removeStrikethrough=Fb("changeFormat",null,{tag:"S"}),jb.removeSubscript=Fb("changeFormat",null,{tag:"SUB"}),jb.removeSuperscript=Fb("changeFormat",null,{tag:"SUP"}),jb.makeLink=function(a,b){var c=this.getSelection();if(c.collapsed){var d=a.indexOf(":")+1;if(d)for(;"/"===a[d];)d+=1;Ba(c,this._doc.createTextNode(a.slice(d)))}return b=F(F({href:a},b,!0),this._config.tagAttributes.a,!1),this.changeFormat({tag:"A",attributes:b},{tag:"A"},c),this.focus()},jb.removeLink=function(){return this.changeFormat(null,{tag:"A"},this.getSelection(),!0),this.focus()},jb.setFontFace=function(a){return this.changeFormat(a?{tag:"SPAN",attributes:{"class":"font",
style:"font-family: "+a+", sans-serif;"}}:null,{tag:"SPAN",attributes:{"class":"font"}}),this.focus()},jb.setFontSize=function(a){return this.changeFormat(a?{tag:"SPAN",attributes:{"class":"size",style:"font-size: "+("number"==typeof a?a+"px":a)}}:null,{tag:"SPAN",attributes:{"class":"size"}}),this.focus()},jb.setTextColour=function(a){return this.changeFormat(a?{tag:"SPAN",attributes:{"class":"colour",style:"color:"+a}}:null,{tag:"SPAN",attributes:{"class":"colour"}}),this.focus()},jb.setHighlightColour=function(a){return this.changeFormat(a?{tag:"SPAN",attributes:{"class":"highlight",style:"background-color:"+a}}:a,{tag:"SPAN",attributes:{"class":"highlight"}}),this.focus()},jb.setTextAlignment=function(a){return this.forEachBlock(function(b){b.className=(b.className.split(/\s+/).filter(function(a){return!/align/.test(a)}).join(" ")+" align-"+a).trim(),b.style.textAlign=a},!0),this.focus()},jb.setTextDirection=function(a){return this.forEachBlock(function(b){b.dir=a},!0),this.focus()},jb.removeAllFormatting=function(a){if(!a&&!(a=this.getSelection())||a.collapsed)return this;for(var b=this._root,c=a.commonAncestorContainer;c&&!h(c);)c=c.parentNode;if(c||(Na(a,b),c=b),c.nodeType===N)return this;this.saveUndoState(a),Ha(a,c);for(var d,e,f=c.ownerDocument,g=a.startContainer,i=a.startOffset,j=a.endContainer,k=a.endOffset,l=f.createDocumentFragment(),m=f.createDocumentFragment(),n=y(j,k,c,b),o=y(g,i,c,b);o!==n;)d=o.nextSibling,l.appendChild(o),o=d;return K(this,l,m),m.normalize(),o=m.firstChild,d=m.lastChild,e=c.childNodes,o?(c.insertBefore(m,n),i=qa.call(e,o),k=qa.call(e,d)+1):(i=qa.call(e,n),k=i),a.setStart(c,i),a.setEnd(c,k),A(c,a),Ga(a),this.setSelection(a),this._updatePath(a,!0),this.focus()},jb.increaseQuoteLevel=Fb("modifyBlocks",sb),jb.decreaseQuoteLevel=Fb("modifyBlocks",tb),jb.makeUnorderedList=Fb("modifyBlocks",wb),jb.makeOrderedList=Fb("modifyBlocks",xb),jb.removeList=Fb("modifyBlocks",yb),jb.increaseListLevel=Fb("modifyBlocks",zb),jb.decreaseListLevel=Fb("modifyBlocks",Ab),"object"==typeof exports?module.exports=G:"function"==typeof define&&define.amd?define(function(){return G}):(_.Squire=G,top!==_&&"true"===a.documentElement.getAttribute("data-squireinit")&&(_.editor=new G(a),_.onEditorLoad&&(_.onEditorLoad(_.editor),_.onEditorLoad=null)))}(document),function(a){"use strict";var b="undefined"==typeof window?null:window;"function"==typeof define&&define.amd?define(function(){return a(b)}):"object"==typeof module&&module.hasOwnProperty("exports")?module.exports=a(b):b.DOMPurify=a(b)}(function a(b){"use strict";var c=function(b){return a(b)};if(c.version="0.7.4",!b||!b.document||9!==b.document.nodeType)return c.isSupported=!1,c;var d=b.document,e=d,f=b.DocumentFragment,g=b.HTMLTemplateElement,h=b.NodeFilter,i=b.NamedNodeMap||b.MozNamedAttrMap,j=b.Text,k=b.Comment,l=b.DOMParser;"function"==typeof g&&(d=d.createElement("template").content.ownerDocument);var m=d.implementation,n=d.createNodeIterator,o=d.getElementsByTagName,p=d.createDocumentFragment,q=e.importNode,r={};c.isSupported="undefined"!=typeof m.createHTMLDocument&&9!==d.documentMode;var s=function(a,b){for(var c=b.length;c--;)a[b[c]]=!0;return a},t=function(a){var b,c={};for(b in a)a.hasOwnProperty(b)&&(c[b]=a[b]);return c},u=null,v=s({},["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr","svg","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","switch","symbol","text","textpath","title","tref","tspan","view","vkern","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","feSpecularLighting","feTile","feTurbulence","math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmuliscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mpspace","msqrt","mystyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","#text"]),w=null,x=s({},["accept","action","align","alt","autocomplete","background","bgcolor","border","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","coords","datetime","default","dir","disabled","download","enctype","face","for","headers","height","hidden","high","href","hreflang","id","ismap","label","lang","list","loop","low","max","maxlength","media","method","min","multiple","name","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","rows","rowspan","spellcheck","scope","selected","shape","size","span","srclang","start","src","step","style","summary","tabindex","title","type","usemap","valign","value","width","xmlns","accent-height","accumulate","additivive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","clip","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mode","min","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","surfacescale","targetx","targety","transform","text-anchor","text-decoration","text-rendering","textlength","u1","u2","unicode","values","viewbox","visibility","vert-adv-y","vert-origin-x","vert-origin-y","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","y","y1","y2","z","zoomandpan","accent","accentunder","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","display","displaystyle","fence","frame","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),y=null,z=null,A=!0,B=!1,C=!1,D=/\{\{[\s\S]*|[\s\S]*\}\}/gm,E=/<%[\s\S]*|[\s\S]*%>/gm,F=!1,G=!1,H=!1,I=!1,J=!0,K=!0,L=s({},["audio","head","math","script","style","svg","video"]),M=s({},["audio","video","img","source"]),N=s({},["alt","class","for","id","label","name","pattern","placeholder","summary","title","value","style","xmlns"]),O=null,P=d.createElement("form"),Q=function(a){"object"!=typeof a&&(a={}),u="ALLOWED_TAGS"in a?s({},a.ALLOWED_TAGS):v,w="ALLOWED_ATTR"in a?s({},a.ALLOWED_ATTR):x,y="FORBID_TAGS"in a?s({},a.FORBID_TAGS):{},z="FORBID_ATTR"in a?s({},a.FORBID_ATTR):{},A=a.ALLOW_DATA_ATTR!==!1,B=a.SAFE_FOR_JQUERY||!1,C=a.SAFE_FOR_TEMPLATES||!1,F=a.WHOLE_DOCUMENT||!1,G=a.RETURN_DOM||!1,H=a.RETURN_DOM_FRAGMENT||!1,I=a.RETURN_DOM_IMPORT||!1,J=a.SANITIZE_DOM!==!1,K=a.KEEP_CONTENT!==!1,C&&(A=!1),H&&(G=!0),a.ADD_TAGS&&(u===v&&(u=t(u)),s(u,a.ADD_TAGS)),a.ADD_ATTR&&(w===x&&(w=t(w)),s(w,a.ADD_ATTR)),K&&(u["#text"]=!0),Object&&"freeze"in Object&&Object.freeze(a),O=a},R=function(a){try{a.parentNode.removeChild(a)}catch(b){a.outerHTML=""}},S=function(a){var b,c;try{b=(new l).parseFromString(a,"text/html");var d=b.getElementsByTagName("head")[0];b.getElementsByTagName("body")[0].appendChild(d.childNodes[0])}catch(e){}return b||(b=m.createHTMLDocument(""),c=b.body,c.parentNode.removeChild(c.parentNode.firstElementChild),c.outerHTML=a),"function"==typeof b.getElementsByTagName?b.getElementsByTagName(F?"html":"body")[0]:o.call(b,F?"html":"body")[0]},T=function(a){return n.call(a.ownerDocument||a,a,h.SHOW_ELEMENT|h.SHOW_COMMENT|h.SHOW_TEXT,function(){return h.FILTER_ACCEPT},!1)},U=function(a){return!(a instanceof j||a instanceof k)&&!("string"==typeof a.nodeName&&"string"==typeof a.textContent&&"function"==typeof a.removeChild&&a.attributes instanceof i&&"function"==typeof a.removeAttribute&&"function"==typeof a.setAttribute)},V=function(a){var b,c;if(_("beforeSanitizeElements",a,null),U(a))return R(a),!0;if(b=a.nodeName.toLowerCase(),_("uponSanitizeElement",a,{tagName:b}),!u[b]||y[b]){if(K&&!L[b]&&"function"==typeof a.insertAdjacentHTML)try{a.insertAdjacentHTML("AfterEnd",a.innerHTML)}catch(d){}return R(a),!0}return!B||a.firstElementChild||a.content&&a.content.firstElementChild||(a.innerHTML=a.textContent.replace(/</g,"&lt;")),C&&3===a.nodeType&&(c=a.textContent,c=c.replace(D," "),c=c.replace(E," "),a.textContent=c),_("afterSanitizeElements",a,null),!1},W=/^data-[\w.\u00B7-\uFFFF-]/,X=/^(?:(?:(?:f|ht)tps?|mailto|tel):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,Y=/[\x00-\x20\xA0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,Z=function(a){var c,e,f,g,h,i,j,k;if(_("beforeSanitizeAttributes",a,null),i=a.attributes){for(j={attrName:"",attrValue:"",keepAttr:!0},k=i.length;k--;)if(c=i[k],e=c.name,f=c.value,g=e.toLowerCase(),j.attrName=g,j.attrValue=f,j.keepAttr=!0,_("uponSanitizeAttribute",a,j),f=j.attrValue,"name"===g&&"IMG"===a.nodeName&&i.id?(h=i.id,i=Array.prototype.slice.apply(i),a.removeAttribute("id"),a.removeAttribute(e),i.indexOf(h)>k&&a.setAttribute("id",h.value)):("id"===e&&a.setAttribute(e,""),a.removeAttribute(e)),j.keepAttr&&(!J||"id"!==g&&"name"!==g||!(f in b||f in d||f in P))&&(C&&(f=f.replace(D," "),f=f.replace(E," ")),w[g]&&!z[g]&&(N[g]||X.test(f.replace(Y,""))||"src"===g&&0===f.indexOf("data:")&&M[a.nodeName.toLowerCase()])||A&&W.test(g)))try{a.setAttribute(e,f)}catch(l){}_("afterSanitizeAttributes",a,null)}},$=function(a){var b,c=T(a);for(_("beforeSanitizeShadowDOM",a,null);b=c.nextNode();)_("uponSanitizeShadowNode",b,null),V(b)||(b.content instanceof f&&$(b.content),Z(b));_("afterSanitizeShadowDOM",a,null)},_=function(a,b,d){r[a]&&r[a].forEach(function(a){a.call(c,b,d,O)})};return c.sanitize=function(a,d){var g,h,i,j,k;if(a||(a=""),"string"!=typeof a){if("function"!=typeof a.toString)throw new TypeError("toString is not a function");a=a.toString()}if(!c.isSupported)return"object"==typeof b.toStaticHTML||"function"==typeof b.toStaticHTML?b.toStaticHTML(a):a;if(Q(d),!G&&!F&&a.indexOf("<")===-1)return a;if(g=S(a),!g)return G?null:"";for(j=T(g);h=j.nextNode();)3===h.nodeType&&h===i||V(h)||(h.content instanceof f&&$(h.content),Z(h),i=h);if(G){if(H)for(k=p.call(g.ownerDocument);g.firstChild;)k.appendChild(g.firstChild);else k=g;return I&&(k=q.call(e,k,!0)),k}return F?g.outerHTML:g.innerHTML},c.addHook=function(a,b){"function"==typeof b&&(r[a]=r[a]||[],r[a].push(b))},c.removeHook=function(a){r[a]&&r[a].pop()},c.removeHooks=function(a){r[a]&&(r[a]=[])},c.removeAllHooks=function(){r=[]},c}),ZE.prototype.createGeneralToolbar=function(){"use strict";var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p=this,q={},r=p.initobj.toolbar,s=document,t=(s.body,s.createDocumentFragment()),u=ZE.i18n,v=(ZE_Init.imgPath,0);a=p.initobj.toolbarOrder?p.initobj.toolbarOrder:r?ZE_Init.toolbarOrderGenerate(r):ZE_Init.toolbarOrder,d=function(a){return function(b){p._stopEvent(b);var c=p._getSelection();try{p._createRange(c)}catch(d){p.range?(p.range.select(),delete p.range):p.win.focus()}return p.execCommand(b,a),!1}},b=s.createElement("div"),b.className="ze",ZE_Init.needEditorBorder||(b.style.borderWidth="0px"),p.editordiv=b,t.appendChild(b),p.toolbarobject=q,c=s.createElement("div"),p.initobj.toolbardirection?c.className="ze_SCmb ze_SCmbfrt":c.className="ze_SCmb",b.appendChild(c),p.toolbardiv=c;var w=function(a){return p._stopEvent(a),!1};o=function(){return function(a){p._stopEvent(a);var b,c=a.target.className,d=p._getSelection();try{p._createRange(d)}catch(e){p.range?(p.range.select(),delete p.range):p.win.focus()}switch(c){case"zei-order":b="insertorderedlist";break;case"zei-unorder":b="insertunorderedlist";break;case"zei-textleft":b="j-left";break;case"zei-textright":b="j-right";break;case"zei-textfull":b="j-full";break;case"zei-textcenter":b="j-center"}return p.execCommand(a,b),p.saveCurrentState(),!1}};var x,y,z,A=0,B=0;y=p.outerdiv.offsetWidth,p.outerdiv.appendChild(t);var C=function(){x=s.createElement("div"),x.id="alter_toolbar",x.className="ze_SCmb ze_alttool",p.editordiv.appendChild(x),x.style.display="none",p.alterTool=x};for(e=a.length,v=0;v<e;v++){for(f=s.createElement("ul"),B>c.offsetWidth-150&&0===A&&v!==e-1&&!p.initobj.avoidMoreOption?(C(),i=[["more","More","zei-more"]],v--,A=1):i=a[v],j=0,k=i.length;j<k;j++){if(l=i[j],m=l[0],n=l[2],g=s.createElement("li"),f.appendChild(g),"otheroptions"===m&&(f.style["float"]="right",f.style.display=""),"plainText"===m&&(f.style.display=""),z=s.createElement("b"),"attach"===m&&(z.className="ze_Sel ze_bg"),"fontsize"===m){var D=s.createElement("span");z.style.minWidth="36px",z.appendChild(D),D.className="ze_pdl"}var E,F=s.createElement("span");F.className=n,"plainText"===m&&(z.innerHTML="plainText"),z.appendChild(F),"attach"!==m&&"alignoptions"!==m&&"listoptions"!==m&&"spellcheck"!==m||(E=document.createElement("span"),E.className="zei-arrow",z.appendChild(E)),g.appendChild(z),z.title=u(l[1]),"alignoptions"===m||"listoptions"===m?(ZE._addEvent(E,"click",d(m)),ZE._addEvent(E,"mousedown",w),ZE._addEvent(F,"click",o()),ZE._addEvent(F,"mousedown",w)):"custom"===m?(ZE._addEvent(z,"click",l[2]),ZE._addEvent(z,"mousedown",w)):(ZE._addEvent(z,"click",d(m)),ZE._addEvent(z,"mousedown",w)),q[m]=z,0!==j&&(h=document.createElement("div"),z.appendChild(h))}var G;if(G="more"!==m&&"otheroptions"!==m&&1===A?x:c,G.appendChild(f),B+=f.offsetWidth,v!==e-1&&"more"!==m){var H=document.createElement("font");G.appendChild(H)}}q.heading&&!function(){var a=q.heading.appendChild(s.createElement("span"));a.className="ze_heading_menu",a.appendChild(s.createTextNode("Nr"))}(),"function"==typeof ZE_Init.afterToolbarGenerate&&ZE_Init.afterToolbarGenerate(q),p.outerdiv.appendChild(t)},ZE.prototype.expandToolbar=function(a){"use strict";var b,c,d,e,f=this,g=document;g.body;if(b=a.currentTarget,c=f.alterTool,d=c.style,"none"!==d.display)return d.display="none",void(b.parentNode.style.backgroundColor="");var h=function(){var a=f.alterTool.style;a.left=b.offsetParent.offsetLeft+b.offsetLeft+b.offsetWidth-f.alterTool.offsetWidth+"px",a.top=b.getBoundingClientRect().top+"px"},i=function(c){var d,g=f.alterTool;if(a)for(d=c.target;null!==d&&(d!==g&&d!==b);d=d.parentNode);d||e()};e=function(){var a=f.alterTool;a&&(a.style.display="none",b.parentNode.style.backgroundColor="",ZE._removeEvent(document,"mousedown",i),ZE._removeEvent(f.doc,"mousedown",i))},d.display="",b.parentNode.style.backgroundColor="#f1f1f1",h(),f.removeAlterToolbar=function(){"none"!==f.alterTool.style.display&&e()},ZE._addEvent(document,"mousedown",i),ZE._addEvent(f.doc,"mousedown",i)},ZE.prototype.resizeToolbar=function(a){"use strict";var b,c,d=this;b=d.initToolbarBlock?d.initToolbarBlock:ZE_Init.initToolbarBlock,d.initToolbarBlock=a;var e=d.toolbardiv.getElementsByTagName("ul"),f=d.toolbardiv.getElementsByTagName("font"),g=e.length;if(a!==b){var h=e[b-1];if(h.style.display="",h.parentNode.removeChild(h),a>b)for(c=b-1;c<a-1;c++)e[c].style.display="",f[c-1].style.display="";else for(f[a-1].style.display="none",c=a-1;c<g-2;c++)e[c].style.display="none",f[c-1].style.display="none";e[a-1].parentNode.insertBefore(h,e[a-1]),h.previousSibling.style.display=""}},ZE.prototype.updateToolbar=function(){"use strict";var a,b,c,d,e=this,f=e.toolbarobject;"comment"===e.initobj.type?(a=document,e.doc=document):a=e.doc;for(b in f)switch(b){case"bold":case"italic":case"underline":case"strikethrough":case"superscript":case"subscript":case"insertorderedlist":case"insertunorderedlist":a.queryCommandState(b)?f[b].className.search("ze_esel")<0&&ZE.addClass(f[b],"ze_esel"):ZE.removeClass(f[b],"ze_esel");break;case"alignoptions":a.queryCommandState("justifyright")?f[b].firstChild.setAttribute("class","zei-textright"):a.queryCommandState("justifycenter")?f[b].firstChild.setAttribute("class","zei-textcenter"):a.queryCommandState("justifyfull")?f[b].firstChild.setAttribute("class","zei-textjustify"):f[b].firstChild.setAttribute("class","zei-textleft");break;case"listoptions":break;case"forecolor":var g=a.queryCommandValue("forecolor")||"black";d=g,"number"==typeof d?f[b].firstChild.style.color="rgb("+(255&d)+","+(d>>8&255)+","+(d>>16&255)+")":f[b].firstChild.style.color=g;break;case"backcolor":try{c=a.queryCommandValue("backcolor")||a.queryCommandValue("hilitecolor"),/transparent/i.test(c)?c=e.getFormattingValues("highlight")||"white":"rgba(0, 0, 0, 0)"===c&&(c="white"),d=c,"number"==typeof d?(parseInt(d+""),f[b].firstChild.style.borderBottom="3px rgb("+(255&d)+","+(d>>8&255)+","+(d>>16&255)+") solid"):f[b].firstChild.style.borderBottom="3px "+c+" solid"}catch(h){}break;case"fontfamily":try{var i=a.queryCommandValue("fontname")||ZE_Init.defaultFontFamily;f[b].firstChild.style.fontFamily=i,i=i.split(",")[0],i=i.replace(/['"]/gi,""),"smartCompose"===e.initobj.editorType&&(f[b].firstChild.innerHTML=ZE.ffDisp[i.toLowerCase()])}catch(h){}break;case"fontsize":try{var j=a.queryCommandValue("fontsize");if(j)f[b].firstChild.innerHTML=ZE.fsDisp[j];else{var k=e.getFormattingValues("size");k?f[b].firstChild.innerHTML=e.fontsizeConversion("pxtopt",parseInt(k)):0===j?f[b].firstChild.innerHTML=ZE.fsDisp[2]:f[b].firstChild.innerHTML=parseInt(ZE_Init.defaultFontSize)}}catch(h){}}},ZE.prototype.createEditor=function(){"use strict";var a,b,c,d,e,f,g,h,j,l,m,n,o,p,q,r,s,t,u=this,v=document,w=0,x=0,y=0,z=0,A=u.initobj,B=v.getElementById(A.id),C=A.editorheight;u.initobj.contactsArray=[],"smartCompose"===u.initobj.editorType&&(t=v.createElement("div"),t.className="ze",u.editordiv=t),ZE.is_chrome=navigator.userAgent.toLowerCase().indexOf("chrome")>-1,a="comment"===A.type?v.createElement("div"):v.createElement("iframe"),u.iframe=a,a.className="ze_area",C?a.style.height=C+"px":a.style.height=B.getBoundingClientRect().height-u.toolbardiv.getBoundingClientRect().height+"px",p=function(){var a,b=v.getElementsByClassName("ze_tbEd"),c=v.getElementsByClassName("IconDiv")[0];a=function(){u.insertIconRef.className="ui-insert",u.insertIconRef.style.visibility="",u.initobj.microParaToolbar?(u.paraIconRef.className="ui-paragraph",u.paraIconRef.style.visibility=""):u.paraIconRef.style.visibility="hidden"},o=v.getElementById("stickIcon"),o?"zei-unlink"!==o.className&&(b[0].parentElement.removeChild(b[0]),c.parentElement.removeChild(c)):(a(),b[0].parentElement.removeChild(b[0])),b[1]&&(a(),b[1].parentElement.removeChild(b[1]))},c=function(){var c,f,g,h,j,l,m,n=a.contentWindow,o=A.content;"comment"!==A.type?(b=n.document||a.contentDocument,u.win=n,u.doc=b,c=b.body,a.onload=null,m=function(a){var d=b.getElementsByTagName("head")[0],e=b.createElement("link");e.type="text/css",e.rel="stylesheet",e.href=ZE_Init.cssPath+"/css/"+a,d||(c.parentNode.insertBefore(b.createElement("head"),c),d=b.getElsetementsByTagName("head")[0]),d&&d.appendChild(e)},ZE_Init.needResizeImage&&m("editor.min.css"),m("editor1.min.css"),u.doc.body.contentEditable=!0,u.doc.body.setAttribute("data-gramm","false")):(n=a,b=v,u.win=window,u.doc=a,u.doc.body=a,u.iframe.contentWindow=window),ZE.prototype.PlaceIcon=function(){var a,c,d,e=b.getSelection().anchorNode;e&&(3===e.nodeType?(c=0,d=b.createRange(),d.setStart(e,c),d.setEnd(e,c+1),a=d.getBoundingClientRect()):a=e.getBoundingClientRect(),u._microdiv.style.left=u.editordiv.offsetLeft-50+"px",u._microdiv.style.top=a.top+u.editordiv.offsetTop+"px")},ZE._addEvent(u.doc,"mousedown",function(a){var b=a.target,c=b.parentElement;if("smartCompose"===u.initobj.editorType&&v.getElementsByClassName("ze_tbEd").length>=1&&p(),!(b.hasAttribute("class")&&"smallDiv"===b.className||null!==c&&c.hasAttribute("id")&&"ze_imgBlock"===c.id)){var d=u.doc.body.getElementsByClassName("smallDiv");if(d.length>1){var e,f,g,h=d.length;for(g=0;g<h;g++)d[0].parentElement.removeChild(d[0]);e=u.doc.body.getElementsByClassName("enc")[0],e&&e.parentElement.removeChild(e),f=u.doc.getElementById("ze_imgBlock"),f&&f.parentElement.removeChild(f)}}var i,j=a.target;try{i=u.doc.getElementById("ze_imgBlock")}catch(k){i=document.getElementById("ze_imgBlock")||null}for(;null!==j;){if("IMG"===j.nodeName&&j.hasAttribute("orig_width"))return u._stopEvent(a),!1;if(j===i)return a.preventDefault(),!1;j=j.parentNode}}),ZE._addEvent(u.doc,"mouseup",function(a){if("smartCompose"===u.initobj.editorType)if(0!==b.getSelection().toString().trim().length){var c=b.getSelection().getRangeAt(0).getBoundingClientRect();u.createToolbar("general",c)}else"comment"!==u.initobj.type&&u.PlaceIcon();u.updateToolbar();for(var d=a.target;null!==d;){if("A"===d.nodeName)return!d.hasAttribute("data-hugatt")&&(u._stopEvent(a),u.showAnchorTag(d,a),!1);if("IMG"===d.nodeName&&d.hasAttribute("orig_width")){if("A"===d.parentNode.nodeName)u._stopEvent(a),u.showAnchorTag(d.parentNode,a);else{var e=b.getElementById("ze_imgBlock");e||(u._stopEvent(a),u.resizeElement(d,a))}return!1}d=d.parentNode}}),document.addEventListener("mousedown",function(a){if("smartCompose"===u.initobj.editorType){for(var b=a.target;null!==b;){if(b.hasAttribute("class")&&"ze_tbEd"===b.className)return!1;b=b.parentElement}null===b&&document.getElementsByClassName("ze_tbEd").length>=1&&p()}},!1),d=function(a){var c,d=a.dataTransfer,e=ZE.i18n;if(u.win.focus(),(null!==d.types||d.files&&d.files.length>0)&&!a.fromPaste&&(d.files&&d.files.length>0||(d.types.indexOf?d.types.indexOf("Files")!==-1:d.types.contains("application/x-moz-file"))||"Files"===d.types[0])){clearTimeout(u.dragTimer);try{c=d.effectAllowed,d.dropEffect="move"===c||"linkMove"===c?"move":"copy"}catch(f){d.dropEffect="move"}var g;g=u.saveSelection();var h,i,j,k,l;if(j=b.getElementById("mask_editor"),!j){j=b.createElement("div"),j.contentEditable="false",j.id="mask_editor",b.body.appendChild(j),l=j.style,h=u.iframe.getBoundingClientRect(),i=u.win.scrollY?u.win.scrollY:u.win.pageYOffset,l.height=h.height+"px",l.width=h.width+"px",l.left="0px",i=u.win.scrollY?u.win.scrollY:u.win.pageYOffset,l.top=0+i+"px",l.position="absolute",k=b.createElement("div"),k.className="ze_drag",k.contentEditable="false";var m=b.createElement("span");k.appendChild(m),m.innerHTML=e("Drop Files to Attach"),j.appendChild(k),k.style.height=.7*u.iframe.offsetHeight+"px",g&&u.restoreSelection(g),u.win.focus()}}u._stopEvent(a)},e=function(a){u.dragTimer=setTimeout(function(){var a=b.getElementById("mask_editor");a&&a.parentElement.removeChild(a)},250),u._stopEvent(a)};var t=function(a,b){var c;for(c=0;c<a.inlineImagesToBe.length;c++)if(a.inlineImagesToBe[c]===b){a.inlineImagesToBe.splice(c,1);break}},B=function(a,b){var c;for(c=0;c<a.waitForResponse.length;c++)if(a.waitForResponse[c]===b){a.waitForResponse.splice(c,1);break}},C=function(a,b){var c,d,e,f=b,g=new XMLHttpRequest,h=new FormData,i=ZE.getCSRFCookie(b);h.append(ZE.getCSRFParamName(),i),a&&h.append("img_file",a,"test.png"),e=ZE_Init.imgAction,ZE_Init.imgParameters&&(e+=ZE_Init.imgParameters),ZE_Init.context&&(c=ZE_Init.imgParameters?e+"&context="+ZE_Init.context:e+"?context="+ZE_Init.context,d="&context="+ZE_Init.context),ZE.captchaParam&&(c=ZE_Init.imgParameters||ZE_Init.context?e+"&"+ZE.captchaParam+d:e+"?"+ZE.captchaParam+d,delete ZE.captchaParam),c+="&uploadMode=drop";var j,k,l=f.doc.createElement("img");try{f.win.focus(),l.src=ZE_Init.imgPath+"/images/process.gif",j=f._getSelection(),k=f._createRange(j),k.insertNode(l),k.selectNode(l),k.collapse(!1),j.removeAllRanges(),j.addRange(k),t(f,a),f.waitForResponse.push(a)}catch(m){return null}return g.onreadystatechange=function(){var c,d=a,e=l;if(4==g.readyState)if(B(f,d),200==g.status){var h=$.parseJSON(g.responseText);h.fileName?(0==f.inlineImagesToBe.length&&delete ZE_Init.captchaProcessing,c=function(a){return function(c){a.onload=function(){a.setAttribute("orig_width",this.width),a.setAttribute("orig_height",this.height),a.setAttribute("size_option","original"),ZE.setImageSizeOptions(this,"bestfit",editorInstance.editordiv.offsetWidth),a.removeAttribute("data-zeload")},a.setAttribute("data-zeload",!0),a.src=c,b.saveCurrentState()}},ZE_Init.inlineImage(c(e),h)):(f.inlineImagesToBe.push(d),e.parentNode.removeChild(e),"HIP_REQUIRED"===h.errorMsg&&(ZE_Init.latesthip=h.hipUrl,ZE.captchaProcessing=function(){D(f)},ZE_Init.captchaInline=!0))}else 500==g.status&&e.parentNode.removeChild(e)},g.open("POST",c,!0),g.send(h),g},D=function(a){var b,c,d,e;for(a.win.focus(),ZE_Init.captchaInline=!1,a.waitForResponse||(a.waitForResponse=[]),c=a.inlineImagesToBe.slice(0),d=c.length,b=0;b<d;b++)if(e=C(c[b],a),!e){a.inlineImagesToBe.splice(0);break}setTimeout(function(){ZE_Init.captchaInline&&ZE.show_CaptchaImage(ZE_Init.latesthip,a)},1e3)},E=function(a){for(var b=a.dataTransfer.items,c=b.length,d=0;d<c;d++)if("file"===b[d].kind&&"image/png"===b[d].type){var e=b[d].getAsFile();e.name||(e.name="Inline_image"+(new Date).getTime()+Math.floor(1e3*Math.random()+1)),u._uploadInlineImages({file:e})}},F=function(a){u._stopEvent(a);var c=b.getElementById("mask_editor");if(c&&c.parentElement.removeChild(c),u.win.focus(),a.editorCustomPaste)return void(u.initobj.handlePasteImages&&E(a));var d=a.dataTransfer.files;if(d&&0!==d.length){var e,f=ZE.i18n,g="inline",h="";for(e=0;e<d.length;e++)if(!d[e].type||d[e].type.indexOf("image")<0){g="attachments";break}if("inline"===g&&ZE_Init.dropInlineImage){for(u.inlineImagesToBe||(u.inlineImagesToBe=[]),e=0;e<d.length;e++)d[e].size>0&&d[e].size/1048576<3?u.inlineImagesToBe.push(d[e]):h+=d[e].name+",";""!==h&&alert(f("Files "+h+" cant be uploaded as they violate size restriction")),D(u)}else ZE_Init.fileUpload(u,d,a)}};ZE._addEvent(b,"drop",F),ZE._addEvent(b,"dragover",d),ZE._addEvent(b,"dragleave",e),u._unusedImagesList={},u._pendingImagesList={};var G,H=function(){u.stack=new ze_Undo.Stack,G=u.stack,u.EditorState={},u.EditorState=function(a,b,c){this.textarea=a,this.newValue=b,this._currentselection=c,this.undo=function(){u.setContent(this.newValue,!0)},this.redo=function(){u.setContent(this.newValue,!0)},this.setFocus=function(){var a=this._currentselection;u.restoreCursorPosition(u.doc.body,a),u.win.focus()}};var a,c=u.getContent();u.initobj.handleAutoFill&&u.mentionsHandler(),ZE._addEvent(u.doc,"dblclick",function(a){if("smartCompose"===u.initobj.editorType&&3===b.getSelection().anchorNode.nodeType){var c=b.getSelection().getRangeAt(0).getBoundingClientRect();u.createToolbar("general",c)}},!1),ZE._addEvent(b,"keyup",function(d){var e=d.keyCode;if(33!==e&&34!==e||d.stopPropagation(),"smartCompose"===u.initobj.editorType){var f=q===!0&&(37===e||38===e||39===e||40===e),g=r&&65===e||s&&65===e,h=s&&q&&39===e;if((f||g||h)&&3===b.getSelection().anchorNode.nodeType){var i=b.getSelection().getRangeAt(0).getBoundingClientRect();u.createToolbar("general",i)}13!==d.keyCode&&8!==d.keyCode&&38!==d.keyCode&&40!==d.keyCode||"comment"!==u.initobj.type&&u.PlaceIcon()}return u.undo||u.redo?void(c=u.getContent()):(clearTimeout(a),void(a=setTimeout(function(){var a=u.getContent();a!==c&&(u.saveCurrentState(),c=a)},250)))})};H(),ZE._addEvent(u.doc,"keydown",function(a){if("smartCompose"===u.initobj.editorType){var c,d,e;v.getElementsByClassName("ze_SCmb").length>=1&&p(),q=a.shiftKey,r=a.ctrlKey,s=a.metaKey,e=function(a,e){"first"===a?(c=e-1,d=e):"second"===a&&(c=e,d=e+1);var f,g,h=b.getSelection().anchorNode.nodeValue.slice(c,d).toUpperCase(),i=b.getSelection().anchorNode.nodeValue,j=i.substring(0,c)+h+i.substring(d,i.length);b.getSelection().anchorNode.nodeValue="",b.getSelection().anchorNode.nodeValue=j,f=document.createRange(),g=b.getSelection(),f.selectNodeContents(b.getSelection().anchorNode.parentElement),f.collapse(!1),g.removeAllRanges(),g.addRange(f),b.getSelection().anchorNode.parentElement.focus()},null!==b.getSelection().anchorNode.nodeValue&&1===b.getSelection().anchorNode.nodeValue.length&&37!==a.keyCode&&38!==a.keyCode&&39!==a.keyCode&&40!==a.keyCode&&13!==a.keyCode&&8!==a.keyCode&&(z=1),3!==w||32!==a.keyCode&&13!==a.keyCode||(e("second",y),w=0),2===w&&(y=b.getSelection().anchorNode.nodeValue.length,w=3),3!==w&&(w=32===a.keyCode&&1===w?2:0),190===a.keyCode&&(w=1),1!==z||32!==a.keyCode&&13!==a.keyCode||(e("first",z),z=0)}var f,g=a.keyCode,h=a.shiftKey,j=a.metaKey,l=a.altKey,m=a.ctrlKey,n=u.stack;if(13===g&&3===x){var o=u.doc.getSelection();if(3===o.anchorNode.nodeType&&"---"===o.anchorNode.textContent){var t=u.doc.createRange();o.anchorNode.textContent="",u.insertHTML("<hr>")}x=0}if(189===g?x++:x=0,8===g){var A,B,C=u.doc.getSelection().anchorNode,D=[];if(3===C.nodeType&&(C=C.parentElement,"ze_mention"===C.className)){A=C.getAttribute("name");C.innerText.trim();if(D=C.innerText.trim().split(" "),B=D.length,B>1){D.splice(B-1,1),C.innerText="",D.forEach(function(a){C.innerText+=a+" "});var t=document.createRange(),o=b.getSelection();return t.selectNodeContents(b.getSelection().anchorNode),t.collapse(!1),o.removeAllRanges(),o.addRange(t),u.doc.getSelection().anchorNode.parentElement.focus(),u.updateToolbar(),!1}var E=C.getAttribute("name"),F=0,G=u.initobj.contactsArray.length;for(k=0,i=0;i<G;)E===u.initobj.contactsArray[i]?(F++,1===F?(u.initobj.contactsArray.splice(i,1),G=u.initobj.contactsArray.length,i=0):i++):i++;if(1===F){var H=u.initobj.getAutofillContacts(E).result[0];u.initobj.removeEditorAutoFill&&u.initobj.removeEditorAutoFill(H)}C.parentElement.removeChild(C)}}if(u.undo=u.redo=!1,(m||j)&&!l&&!h)switch(f=String.fromCharCode(g).toLowerCase()){case"b":u.execCommand(a,"bold");break;case"u":u.execCommand(a,"underline");break;case"i":u.execCommand(a,"italic");break;case"l":u.execCommand(a,"j-left");break;case"e":u.execCommand(a,"j-center");break;case"r":u.execCommand(a,"j-right");break;case"j":u.execCommand(a,"j-full");break;case"k":u.execCommand(a,"link");break;case"z":u._stopEvent(a),n.canUndo()&&n.undo(),u.undo=!0;break;case"y":u._stopEvent(a),n.canRedo()&&n.redo(),u.redo=!0}u.updateToolbar()}),h=function(a,b){var c,d,e={8:10,10:13,12:16,14:18,18:24,24:32,36:48};if("comment"!==A.type){d=b.indexOf("px")!==-1?b:e[parseInt(b)]+"px",
c=u.doc.createElement("style"),c.type="text/css",c.innerHTML=".ze_body{font-family:"+a+";font-size:"+d+";margin:15px}";var f=u.doc.getElementsByTagName("head")[0];f&&(f.appendChild(c),u.doc.body.className="ze_body")}},j=A.defaultfontfamily||ZE_Init.defaultFontFamily||"",l=A.defaultfontsize||ZE_Init.defaultFontSize||"",h(j,l),delete u.state;var I=function(a){var b=a.createElement("span");a.body.appendChild(b),setTimeout(function(){b.parentNode.removeChild(b)},100)};if(ZE_Init.is_safari&&window.onblur&&(ZE._addEvent(u.doc.body,"focus",function(){I(document)}),ZE._addEvent(u.doc.body,"blur",function(){var a=u.win.getSelection();if(a.isCollapsed){u.pasteHTML&&u.pasteHTML("<span id='temp_123paint'></span>");var b=u.doc.getElementById("temp_123paint");b&&b.parentNode.removeChild(b)}})),ZE._addEvent(u.win,"scroll",function(){var a=document.getElementById("ze_linkBlock");a&&document.body.removeChild(a)}),ZE._addEvent(u.doc.body,"contextmenu",function(a){for(var b=a.target;null!==b;){if("TABLE"===b.nodeName&&"true"!==ZE.getAttribute(b,"data-avoidContext"))return u._stopEvent(a),u.showContextMenu(a,"table",b),!1;b=b.offsetParent}}),"comment"===A.type?u.squireInstance=new Squire(a,{getEditorInstance:function(){return u}}):u.squireInstance=new Squire(u.doc,{getEditorInstance:function(){return u}}),u.squireInstance.addEventListener("dragover",function(a){u._stopEvent(a)}),u.squireInstance.addEventListener("drop",F),"plaintext"!==A.mode&&(o||(o=""),u.squireInstance.setHTML(o)),u.afterload)for(f=u.afterload,g=f.length;g--;)f.shift()();if(delete u.afterload,"richtext"===u.mode&&((ZE_Init.needEditorFocus||u.initobj.needEditorFocus)&&(n.focus(),u.squireInstance.focus()),u.updateToolbar()),u.saveCurrentState({cursorPosition:{start:0,end:0},suppressContentChange:!0}),!ZE_Init.needEditorFocus&&!u.initobj.needEditorFocus&&"richtext"===u.mode){var J=n.getSelection()||u.doc.selection;J.removeAllRanges()}},"comment"===A.type?(u.outerdiv.appendChild(u.editordiv),a.contentEditable=!0,b=a,u.editordiv.appendChild(a),a.focus(),c()):(a.onload=c,a.srcdoc="<!DOCTYPE html>",u.editordiv.appendChild(a),u.outerdiv.appendChild(u.editordiv)),"smartCompose"===u.initobj.editorType&&(u._microdiv=v.createElement("div"),u._microdiv.className="ui-microtoolbar",f=v.createElement("div"),g=v.createElement("div"),f.id="PaIcon",u.paraIconRef=f,f.className="ui-paragraph",l=v.createElement("span"),m=v.createElement("span"),n=v.createElement("span"),l.className="paraClose",l.appendChild(n),m.className="tooltip",m.innerHTML="Paragraph",ZE._appendChildren(f,[l,m]),g.id="InsertIcon",u.insertIconRef=g,g.className="ui-insert",l=v.createElement("span"),m=v.createElement("span"),l.className="insertClose",m.className="tooltip",m.innerHTML="insert",ZE._appendChildren(g,[l,m]),u.initobj.microParaToolbar?ZE._appendChildren(u._microdiv,[g,f]):ZE._appendChildren(u._microdiv,[g]),h=u.editordiv.getBoundingClientRect(),j=u._microdiv.style,j.left=u.editordiv.offsetLeft-50+"px",j.top=u.editordiv.offsetTop+15+"px",j.position="absolute","comment"!==u.initobj.type&&u.editordiv.appendChild(u._microdiv));var D,E,F;E=function(a){a.stopPropagation(),D(u.paraIconRef,a)},F=function(a){a.stopPropagation(),D(u.insertIconRef,a)},D=function(a,b){b.stopPropagation();var c=a,d=v.getElementsByClassName("ze_tbEd"),e=v.getElementById("PaIcon"),f=v.getElementById("InsertIcon");o=v.getElementById("stickIcon"),d[1]&&d[1].parentElement.removeChild(d[1]),"ui-paragraph\tsel"===c.className?d.length>=1&&(o&&"zei-unlink"===o.className||d[0].parentElement.removeChild(d[0]),c.className="",c.className="ui-paragraph",f.style.visibility="",c.previousSibling.style.visibility=""):"ui-insert\tsel"===c.className?d.length>=1&&(o&&"zei-unlink"===o.className||d[0].parentElement.removeChild(d[0]),c.className="",c.className="ui-insert",e.style.visibility="",u.initobj.microParaToolbar?c.nextElementSibling.style.visibility="":c.nextElementSibling.style.visibility="hidden"):"ui-insert"===c.className?(e.style.visibility="hidden",c.childNodes[1].style.visibility="hidden",u.createToolbar("insert",b)):"ui-paragraph"===c.className&&(f.style.visibility="hidden",c.childNodes[1].style.visibility="hidden",u.createToolbar("paragraph",b))},ZE._addEvent(f,"mousedown",E),ZE._addEvent(g,"mousedown",F)},ZE.createNewTableRow=function(a){"use strict";for(var b=function(a,b){for(var c=0,d=a;null!==d;){if(d.nodeName===b)return"TD"===b?c=d.cellIndex:"TR"===b&&(c=d),c;d=d.parentElement}},c=function(a){var b=document,c=b.createDocumentFragment(),d=b.createElement("tr");for(c.appendChild(d),i=0;i<a;i++){var e=b.createElement("td"),f=b.createElement("div");f.appendChild(b.createElement("br")),e.appendChild(f),d.appendChild(e)}return c},d=a.anchorNode,e=d;null!==d;){if("TABLE"===d.nodeName){var f=b(e,"TD"),g=b(e,"TR");if(d.rows.length-1===g.rowIndex&&d.rows[0].cells.length-1===f){var h=c(d.rows[0].cells.length);return g.parentNode.insertBefore(h,g.nextSibling),g.nextSibling.firstChild}return!1}d=d.parentElement}},ZE.prototype._stopEvent=function(a){"use strict";try{a.preventDefault(),a.stopPropagation()}catch(b){a.cancelBubble=!0,a.returnValue=!0}},ZE.getAttribute=function(a,b){"use strict";if(a.hasAttribute(b))return a.getAttribute(b)},ZE.prototype.updateStateHTML=function(a,b){"use strict";var c=this;c.stack.commands[a].newValue=b},ZE.setImageSizeOptions=function(a,b,c){"use strict";var d,e=400,f={},g=a.width||a.naturalWidth,h=a.height|a.naturalHeight,i=parseInt(.75*c);i>e&&(i=e),"small"===b?(d=2.5,g>i&&(d=g/150),f.width=g/d,f.height=h/d,f.sizeOption="small"):"bestfit"===b?(d=1,g>i&&(d=g/i),f.width=g/d,f.height=h/d,f.sizeOption="bestfit"):(f.width=g,f.height=h,f.sizeOption="original"),a.width=f.width,a.height=f.height,a.setAttribute("size_option",f.sizeOption)},ZE.prototype.checkForPendingImages=function(){"use strict";var a,b=this,c=Object.keys(b._pendingImagesList),d=!1;return c.length&&(a=b.doc.body.getElementsByClassName("ze_img_upload"),a.length&&(d=!0)),d},ZE.prototype.clearPendingImages=function(){"use strict";var a,b,c=this,d=c.doc.body.getElementsByClassName("ze_img_upload"),e=d.length;for(c._pendingImagesList={},a=0;a<e;a++)b=d[a],"IMG"===b.nodeName&&b.parentNode.removeChild(b)},ZE.prototype.pasteContent=function(a){"use strict";var b=JSON.stringify(localStorage).length,c=16*b/8192/1e3,d=a.length,e=new Date,f=e.getFullYear(),g=e.getMonth()+1,h=e.getDate(),i=e.getHours(),j=e.getMinutes(),k=e.getSeconds(),l=16*d/8192/1e3;g<10&&(g="0"+g),e=f+"-"+g+"-"+h+"\t"+i+":"+j+":"+k,l+c<=10?localStorage.setItem(e,JSON.stringify(a)):(localStorage.clear(),localStorage.setItem(e,JSON.stringify(a)))},ZE.prototype._uploadInlineImages=function(a){"use strict";var b=this,c=b.doc.createElement("img"),d=function(){return function(a,c){c="ze_"+c+"_refresh";var d=b.doc.getElementById(c);return delete b._pendingImagesList[c],d?(d.onload=function(){d.setAttribute("orig_width",this.width),d.setAttribute("orig_height",this.height),ZE.setImageSizeOptions(d,"bestfit",b.editordiv.offsetWidth),d.removeAttribute("data-zeload")},d.setAttribute("data-zeload",!0),d.src=a,d.removeAttribute("id"),d.removeAttribute("class"),void b.saveCurrentState()):void(b._unusedImagesList[c]=a)}},e=function(){return function(a){c.src=ZE_Init.imgPath+"/images/process.gif",c.id="ze_"+a+"_refresh",b._pendingImagesList[c.id]=!0,c.className="ze_img_upload";var d=b._getSelection(),e=b._createRange(d);e.insertNode(c),e.selectNode(c),e.collapse(!1),d.removeAllRanges(),d.addRange(e)}},f=function(){return function(a){a="ze_"+a+"_refresh";var c=b.doc.getElementById(a);delete b._pendingImagesList[a],c&&c.parentNode.removeChild(c)}};"function"==typeof b.initobj.processPastedFile&&b.initobj.processPastedFile(a,b,e(),d(),f())},ZE.prototype.mentionsHandler=function(){var a=this;$(a.doc).on("keydown",function(a){var b=a.keyCode;38==b||40==b?$("#ze_autofill").length&&a.preventDefault():13==b&&$("#ze_autofill li.sel").length&&(a.preventDefault(),a.stopPropagation(),a.stopImmediatePropagation())});var b=function(a,b,d){var e,f,g=a.keyCode;return 40==g?(e=$("#ze_autofill li.sel"),e.removeClass("sel"),e.next().length?e.next().addClass("sel"):$("#ze_autofill li").first().addClass("sel"),!0):38==g?(e=$("#ze_autofill li.sel"),e.removeClass("sel"),e.prev().length?e.prev().addClass("sel"):$("#ze_autofill li").last().addClass("sel"),!0):13==g?($("#ze_autofill").length&&$("#ze_autofill").is(":visible")&&(a.preventDefault(),a.stopPropagation(),a.stopImmediatePropagation(),e=$("#ze_autofill li.sel"),f=e.data("mention"),c(f,b,d)),!0):void 0},c=function(b,c,d){if(d>-1&&$(c).length){var f=d,g=a.win.getSelection(),h=g.getRangeAt(0);h.setStart(c,f),g.removeAllRanges(),g.addRange(h),a.insertHTML('<a class="ze_mention" name = '+b.eid+"  href='mailto:"+b.eid+"'>"+b.fn+"</a>"),a.initobj.triggerOnMention&&a.initobj.triggerOnMention(b)}e()},d=function(c){var d,e,f,g,i,j,k=a.win.getSelection(),l=k.anchorNode,m=k.getRangeAt(0),n=m.cloneRange();n.setStart(l,0),d=n.cloneContents(),g=d.textContent,i=g.lastIndexOf("@"),j=b(c,l,i),j||(0==i||i>0&&" "==g.charAt(i-1)?(f=$.trim(g.substr(i+1)),e=a.initobj.getAutofillContacts&&a.initobj.getAutofillContacts(f)||[],e.result&&e.result.length?h(e.result,l,i):$("#ze_autofill").remove()):$("#ze_autofill").remove())};$(a.doc).on("keyup",d);var e=function(){var b=document.getElementById("ze_autofill"),c=document,d=a.doc;b&&(document.body.removeChild(b),ZE._removeEvent(c,"mousedown",f),ZE._removeEvent(d,"mousedown",f))},f=function(a){var b,c=document.getElementById("ze_autofill");if(a)for(b=a.target;null!==b&&b!==c;b=b.parentNode);b||e()},g=function(b,c){var d,e,f=a.iframe.getBoundingClientRect(),g=b.style,h=ZE.getPos(a.editordiv);if(a.doc.createRange&&3==c.nodeType){var i=a.doc.createRange();i.selectNodeContents(c),i.getBoundingClientRect&&(d=i.getBoundingClientRect())}d||(d=c.parentNode.getBoundingClientRect());var e=f.top+d.top+d.height,j=f.left+d.left;g.top=parseInt(e)+"px",g.left=parseInt(j)+"px",e+b.offsetHeight>a.editordiv.offsetHeight+h.offsetTop&&(g.top="auto",e=window.innerHeight-e+d.height,g.bottom=parseInt(e)+"px")},h=function(b,d,h){var i,j,k,l=document.createElement("div"),m=document.createElement("ul");for($("#ze_autofill").length&&$("#ze_autofill").remove(),l.id="ze_autofill",l.className="ze_dd ze_autoFill shw ",m.className="ze_tbdr",i=0;i<b.length;i++)j=document.createElement("li"),b[i].photo&&(k=document.createElement("img"),k.src=b[i].photo,j.appendChild(k)),j.appendChild(document.createTextNode(b[i].fn)),$(j).data("mention",b[i]),m.appendChild(j);l.appendChild(m),document.body.appendChild(l),g(l,d),ZE._addEvent(m,"click",function(a){var b,f=d,g=h,i=a.target||a.srcTarget;if(i=$(i).closest("li"),i.length){var b=$(i).data("mention");c(b,f,g),e()}}),ZE._addEvent(document,"mousedown",f),ZE._addEvent(a.doc,"mousedown",f)}};