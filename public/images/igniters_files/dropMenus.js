!function(){"use strict";window.zmDrop=window.zmDrop||{};var a=zmText.get("dropMenus"),b=function(b,c){var d,e=!1;b&&"inline"===b&&(e=!0),c&&(d=c.cmpId);var f=[],g={htm:a.send};g.data={},g.data.action="s",e&&(g.data.cmpId=d);var h={htm:a.sendNow};h.data={},h.data.action="si",e&&(h.data.cmpId=d),f.push(g,h);var i={list:f,clk:function(a){var b=a.action,c=a.cmpId;"s"===b?(zmComp.sendMail({action:"compose",cmpId:c}),zmUtil.hideMenu()):"si"===b&&(zmComp.sendMail({action:"compose",sendIm:!0,cmpId:c}),zmUtil.hideMenu())}};return i},c=function(){var a=$(zmComposeTemplates.getTemplate("schPop")),b=$(zmComposeTemplates.getTemplate("sendLater")),c=$(zmComposeTemplates.getTemplate("recBand")),d=$(zmComposeTemplates.getTemplate("recChild"));return a.find("tbody").append(b,c,d),zmComp.bindScheduleEvents({parentElement:a,scheduleElement:b,recurringBand:c,recurringChild:d}),a},d=function(){var b=zmComp.getCurrentCompId(),c={list:[{htm:a.draft,data:{action:"sdraft",cmpId:b}},{htm:a.template,data:{action:"stemplate",cmpId:b}}],clk:function(a){var b=a.action,c=a.cmpId,d={cmpId:c};switch(b){case"sdraft":d.action="sdraft",zmComp.sendMail(d),zmUtil.hideMenu();break;case"stemplate":d.action="stemplate",zmComp.sendMail(d),zmUtil.hideMenu()}}};return c},e=function(b){var c,d,e=zmComp.getCurrentCompId(),f="",g="",h="",i={},j="";c="msi-tick",d=zmComp.getPriority(zmComp.getCurrentCompId());var k=zmComp.getAskReceipt(e);return"yes"===k&&(j=c),"High"===d?f=c:"Low"===d?h=c:g=c,i={list:[{htm:"<b> "+a.priority+" : </b>",nohover:"nohr"},{htm:"<i class='msi-none "+f+"'></i>"+a.high,data:{action:"h",par:b}},{htm:"<i class='msi-none "+g+"'></i>"+a.medium,data:{action:"m",par:b}},{htm:"<i class='msi-none "+h+"'></i>"+a.low,data:{action:"l",par:b}},{sep:!0},{htm:"<b>"+a.insert+" : </b>",nohover:"nohr"},{htm:a.template,data:{action:"insTemplate",cmpId:e}},{htm:a.signature,data:{action:"sig",cmpId:e}},{sep:!0},{htm:a.encoding+"<i class='msi-rarrow'></i>",childCls:"SC_tin",child:function(){return zmCUtil.compLst("encod",e)}},{sep:!0},{htm:"<i class='"+j+"'></i>"+a.askreceipt,data:{action:"askReceipt",par:k}}],clk:function(a){var b=a.action,c=a.cmpId,d=a.par,e={cmpId:c};switch(b){case"sdraft":e.action="sdraft",zmComp.sendMail(e),zmUtil.hideMenu();break;case"stemplate":e.action="stemplate",zmComp.sendMail(e),zmUtil.hideMenu();break;case"insTemplate":zmCUtil.insTemplate(c),zmUtil.hideMenu();break;case"sig":zmCUtil.insSign(c),zmUtil.hideMenu();break;case"h":zmCUtil.chgPriority("h",d),zmUtil.hideMenu();break;case"m":zmCUtil.chgPriority("m",d),zmUtil.hideMenu();break;case"l":zmCUtil.chgPriority("l",d),zmUtil.hideMenu();break;case"askReceipt":zmCUtil.askRepChk(d,zmComp.getCurrentCompId()),zmUtil.hideMenu()}}}},f=function(b){var c={},d=zmComp.getCurrentCompId();return c.list=[{htm:a.draft,data:{action:"d",par:b}},{htm:a.template,data:{action:"t",par:b}}],c.clk=function(a,b){var c,e=a.action;switch(e){case"d":c={action:"sdraft",cmpId:d},zmComp.sendMail(c),zmUtil.hideMenu();break;case"t":c={action:"stemplate",cmpId:d},zmComp.sendMail(c),zmUtil.hideMenu()}},c},g=function(b){var c,d,e="",f="",g="",h={};return c="msi-tick",d=zmComp.getPriority(zmComp.getCurrentCompId()),"High"===d?e=c:"Low"===d?g=c:f=c,h.list=[{htm:"<i class='msi-none "+e+"'></i>"+a.high,data:{action:"h",par:b}},{htm:"<i class='msi-none "+f+"'></i>"+a.medium,data:{action:"m",par:b}},{htm:"<i class='msi-none "+g+"'></i>"+a.low,data:{action:"l",par:b}}],h.clk=function(a,b){var c=a.action,d=a.par;switch(c){case"h":zmCUtil.chgPriority("h",d),zmUtil.hideMenu();break;case"m":zmCUtil.chgPriority("m",d),zmUtil.hideMenu();break;case"l":zmCUtil.chgPriority("l",d),zmUtil.hideMenu()}},h},h=function(){var b,c=[],d={date:"",size:""},e="<i class='msi-tick'></i>";return"s"===zmail.viewInfo[0].DT&&(d.date=e),"s"===zmail.viewInfo[0].SZ&&(d.size=e),b=zmInit.getListingDetObj(),c=b.fId===zmail.folId.oId?[{htm:d.date+a.date,clk:function(){zmList.changeViewColumns("DT"),zmUtil.hideMenu()}}]:[{htm:d.date+a.date,clk:function(){zmList.changeViewColumns("DT"),zmUtil.hideMenu()}},{htm:d.size+a.size,clk:function(){zmList.changeViewColumns("SZ"),zmUtil.hideMenu()}}]},i=function(){var b,c;return b=[{htm:a.composemail,data:{action:"mail"}},{htm:a.createnote,data:{action:"note"}},{htm:a.createtask,data:{action:"task"}},{htm:a.createevent,data:{action:"event"}},{htm:a.createcontact,data:{action:"contact"}},{htm:a.createlink,data:{action:"link"}}],zmail.showFeature&&(b.push({htm:"Quick Compose",data:{action:"cmpdialog"}}),zmail.trialUsers&&b.push({htm:"Smart Compose",data:{action:"smartdialog"}})),"m"===zmApp.currentApp?b.splice(0,1):"n"===zmApp.currentApp?b.splice(1,1):"t"===zmApp.currentApp?b.splice(2,1):"c"===zmApp.currentApp?b.splice(3,1):"cn"===zmApp.currentApp?b.splice(4,1):"l"===zmApp.currentApp&&b.splice(5,1),c=function(a){var b=a.action;zmUtil.hideMenu(),"mail"===b?zmUtil.compose():"note"===b?zmUtil.loadNotes("popup"):"task"===b?zmUtil.loadTask({action:"addCTask",groupId:zmail.zuid}):"event"===b?zmApp.loadCalendar("/calendar/event"):"contact"===b?zmcontact.showQuickCreate():"cmpdialog"===b?zmUtil.cmpDialog():"link"===b?zmUtil.loadLink({mode:"create",groupId:zmail.zuid,catid:""}):"smartdialog"===b&&zmAppLoader.load("smartcompose").done(function(){zmSCompose.init({eType:"6"})})},{list:b,clk:c}},j=function(b,c){var d,e=zmail.labInfo,f=[],g=0,h={};d="action"===c?b:"listview","flag"===b&&(e={1:{dispName:a.info,id:"1",seq:0},2:{dispName:a.important,id:"2",seq:1},3:{dispName:a.followup,id:"3",seq:2}},"action"===c&&(e[0]={dispName:a.clearflag,id:"0",seq:3}));for(var i in e)h={},"flag"===b?(h.fVal=e[i].id,g=e[i].seq):(h.lId=e[i].id,h.lA="add",h.disp=e[i].dispName),h.action=d,"view"===c&&(h.clk=function(a,b){zmList.bindAction(a,b)},h.view=b,h.viewId=i),f[g]={htm:e[i].dispName,data:h},g++;return"label"===b&&"action"===c&&(0===g&&(f[g++]={htm:a.notagsfound}),f[g++]={sep:!0},h={lA:"deleteall",action:b},f[g++]={htm:a.cleartag,data:h}),f},k=function(a){var b={};return b.divId="zm_dropflag","view"===a?b.list=j("flag","view"):"action"===a&&(b.list=j("flag","action")),b.align="cleft",b.clk=function(a,b){zmList.bindAction(a,b)},b},l=[{htm:a.markfolderread,data:{action:"folread"}},{htm:a.sweep,data:{action:"sweep"}}],m=[{htm:a.markasread,data:{action:"read"}},{htm:a.markasunread,data:{action:"unread"}},{htm:a.flagas+" <i class='msi-rarrow'></i>",data:{action:"flaglist"},child:function(){return k("action")}},{htm:a.markspam,data:{action:"spam"}},{htm:a.marknotspam,data:{action:"notspam"}},{htm:a.forwardasinline,data:{action:"forward"}},{htm:a.forwardmultipleemail,data:{action:"FwdAttach"}}],n=function(){var a=function(a,b){for(var c=zmail.mailObj,d=a.length,e=0;e<d;e++)if(c[a[e]].S?b.unread=!0:b.read=!0,b.unread&&b.read)return};return function(b,c){var d,e,f,g={read:!1,unread:!1},h=zmInit.getListingDetObj(),i=zmail.mailObj,j=zmsuite.getCenter()[0].getNodes()[2].$el;if(b.length&&a(b,g),g.unread&&g.read)return g;for(e=c.length,f=0;f<e;f++)if(d=i[c[f]],d.TS?(g.unread=!0,g.read||(b=zmList.getMailSummaryList(h,d.T),b.length&&a(b,g))):(g.read=!0,!g.unread&&j.find("#thd"+d.M).is(":visible")&&(b=zmList.getMailSummaryList(h,d.T),b.length&&a(b,g))),g.unread&&g.read)return g;return g}}(),o=function(b){var c,d=$.extend([],l.slice()),e=$.extend([],b||m.slice()),f=zmUtil.getSelectedMails(),g=f[0].length+f[1].length,h=window.zmTab&&"zm_Container"===zmTab.currentTab||!1,i=window.zmTab&&zmTab.currentTab.indexOf("zm_srch")!==-1||!1,j=zmUtil.isChildWindow()?$("#zmWindowWrapper").data("detail"):zmsuite.getCenterOuter().$el.data("data-detail"),k=j&&j.fId||zmInit.getListingDetObj().fId,o=zmail.folId,p=k===o.dId||k===o.teId||k===o.oId,q=!h||""===k||p;if(m[e.length-1].htm=a.forwardmultipleemail,q?d.splice(0,2):(0===g||k&&(k===o.sId||k===o.tId||k===o.spId||zmUtil.isSharedFolder(k)))&&d.splice(1,1),g&&!p){if(g>1?e.splice(5,1):1!==g||h||i||(e[6].htm=a.forwardasattachment),e.splice(3,2),k===o.spId&&e.splice(2,1),h||i)c=n(f[0],f[1]);else{c={read:!0,unread:!0};var r=f[0][0];r.indexOf("t")===-1&&(zmail.mailObj[r].S?c.read=!1:c.unread=!1)}c.read?c.unread||e.splice(1,1):e.splice(0,1);var s=e.length-1;delete e[s].state,f[0].length<2&&f[1].length<1&&(zmUtil.isChildWindow()?e.splice(s,1):e[s].htm=a.forwardasattachment),d=q?e:e.concat(d)}return d},p=function(a){var b={};return b.divId="zm_dropflag","view"===a?b.list=j("label","view"):"action"===a&&(b.list=j("label","action")),b.align="cleft",b.clk=function(a,b){zmList.bindAction(a,b)},b},q=function(){var b={},c=[{htm:a.mailWithAttach,data:{action:"view_attach"}},{htm:a.attachmentView,data:{action:"view_attach",isAttachOnly:!0}}];return b.divId="zm_dropAttac",b.list=c,b.align="cleft",b.clk=function(a,b){zmList.bindAction(a,b)},b},r=function(){var b,c=[{htm:a.viewAll,data:{action:"view_all"}},{htm:a.unread,data:{action:"view_unread"}},{htm:a.flagged+"<i class='msi-rarrow'></i>",data:{action:"view_flag"},child:function(){return k("view")}},{htm:a.tags+"<i class='msi-rarrow'></i>",data:{action:"view_label"},child:function(){return p("view")}},{htm:a.attachments+"<i class='msi-rarrow'></i>",data:{action:"view_attach"},child:function(){return q()}},{htm:a.archived,data:{action:"view_archive"}}],d=[{htm:a.info,data:{action:"listview",view:"flag",viewId:1}},{htm:a.important,data:{action:"listview",view:"flag",viewId:2}},{htm:a.followup,data:{action:"listview",view:"flag",viewId:3}},{htm:a.viewAll,data:{action:"view_flag"}}],e=zmInit.getListingDetObj(),f=e.fId;if(f){var g=c.slice();$.isEmptyObject(zmail.labInfo)&&(g[3]=""),(f===zmail.folId.spId||f&&zmail.folTree[0][f]&&0===zmail.folTree[0][f].IA)&&(g[5]=""),zmUtil.isSharedFolder(f)&&(g[4].htm=a.attachments,delete g[4].child),f===zmail.folId.teId&&(g[1]="",g[2]="",g[4]="",g[5]="");for(var h;(h=g.indexOf(""))!==-1;)g.splice(h,1);b=g}else b=d;return b},s=function(){var b,c=[{htm:a.all,data:{action:"select_all"}},{htm:a.none,data:{action:"select_none"}},{htm:a.unread,data:{action:"select_unread"}},{htm:a.read,data:{action:"select_read"}},{htm:a.flagged,data:{action:"select_flag"}},{htm:a.tags,data:{action:"select_label"}},{htm:a.attachments,data:{action:"select_attach"}}],d=zmInit.getListingDetObj(),e=c.slice();return $.isEmptyObject(zmail.labInfo)&&e.splice(4,1),d.fId!==zmail.folId.teId&&d.fId!==zmail.folId.dId&&d.fId!==zmail.folId.oId||e.splice(2,5),b=e},t=function(){var b=[],c={comfort:"",compact:""},d=zmTab.currentTab;return"zm_Container"!==d&&"zm_srch1"!==d||(c.compact="<i class='msi-compact'></i>",c.comfort="<i class='msi-classic'></i>",b=[{htm:c.comfort+" "+a.classic,data:{action:"customize_view",value:"0"}},{htm:c.compact+" "+a.compact,data:{action:"customize_view",value:"1"}}]),b},u={consDropDown:function(a){var b=new zmDropDownMenu(a);b.paint()},show:function(a,j,k,l){var m,n,o,p;switch(j=$(j),k=k||{id:a,par:j},k.cmpId&&(a=k.id),a&&(a=a.replace(/[0-9]/g,"")),a){case"zm_shdLst":j.addClass("SC_bsel"),k.align="pright",k.ulClass="SC_tin",k.list=h();break;case"zm_priLst":j.find("b").addClass("SC_ddn"),k.ulClass="SC_tin",m=g(j),k.list=m.list,k.clk=m.clk,k.align="pright",k.parWidth=!0;break;case"zm_watchLst":$(k.par).find("b").addClass("SC_ddn"),k.onHide=function(){zmWatch.hideWatch(k.cmpId)},k.htm=zmWatch.loadWatch(k.cmpId),k.parWidth=!0,k.loadCopt=!0,k.align="pright";break;case"zm_addWatch":$(k.par).find("b").addClass("SC_ddn"),k.align="mright",k.showArrow=!0,k.direction="top",k.loadHTML=!0,k.onHide=function(){zmWatch.hideWatch(k.cmpId)},k.htm=zmWatch.loadWatch(k.cmpId);break;case"zm_sendLater":k.par=j.find("b"),j.find("b").addClass("SC_ddn"),k.htm=zmSchedule.scheduleDROP(a),k.loadCopt=!0,k.align="pright";break;case"zm_recurring":k.par=j.find("b"),j.find("b").addClass("SC_ddn"),k.htm=zmSchedule.scheduleDROP(a),k.loadCopt=!0,k.align="pright";break;case"zm_savecomp":j.find("b").addClass("SC_ddn"),k.ulClass="SC_tin",p=f(j),k.list=p.list,k.clk=p.clk;break;case"zm_compactLst":j.find("b").addClass("SC_ddn"),k.ulClass="SC_tin",n=e(j),k.list=n.list,k.clk=n.clk;break;case"zm_SndLst":k.par=j;var q;l&&(q=l.snd_type);var r=b(q,l);j.find("b").addClass("SC_ddn"),k.list=r.list,k.clk=r.clk;break;case"zm_ScheduleLst":k.par=j,j.find("b").addClass("SC_ddn"),k.htm=c();break;case"zm_SveLst":k.par=j,j.find("b").addClass("SC_ddn"),k.list=d().list,k.clk=d().clk,k.align="pright",k.loadCopt=!0,k.parWidth=!0;break;case"zm_createLst":o=i(),k.list=o.list;var s=j.find(".msi-barrow");s.addClass("sel"),k.onHide=function(){s.removeClass("sel")},k.clk=o.clk,k.ulClass="zm_compul",k.defaultclass=!1,k.spanClass="SC_dd wbdr"}k.align=k.align||"pleft","pleft"!==k.align&&"pright"!==k.align||!j.attr("data-drop")?zmDrop.consDropDown(k):(j.removeAttr("data-drop"),zmUtil.hideMenu())},getActionDrop:o,getViewDrop:r,getSelectDrop:s,getCustomizeViewDrop:t};window.zmDrop=$.extend(window.zmDrop||{},u)}(),function(a){"use strict";function b(a){this.dropObj=a}var c=function(a){var b,d;for(b=0;b<a.length;b++)a[b]&&(a[b].child&&(a[b].child.divId?$("#"+a[b].child.divId).remove():$("#"+a[b].child().divId).remove()),d="function"==typeof a[b].child?a[b].child("rem"):a[b].child,d&&d.list&&c(d.list))},d=function(a,b,c){a&&a.removeAttr("data-drop"),b&&zmUtil.removeHighlight(),c.onHide&&c.onHide()};b.prototype={setDropObj:function(a){this.dropObj=a},paint:function(){this.dropObj.showArrow?this.paintArrowDrop():this.paintDrop()},paintDrop:function(){var a,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u=this.dropObj,v=u.list||[],w=u.liDom||[],x=$(u.par),y=u.align,z=u.divId,A=x.offset(),B=x.outerHeight(),C=A.left,D=u.container||document.body,E=u.htm,F=A.top,G=void 0===u.defaultclass||u.defaultclass,H=u.dir,I=$(D).offset(),J=u.avoidScroll,K=u.paddingOffset||40,L=parseInt($(D).css("border-top-width")),M=parseInt($(D).css("margin-top")),N=v.length||w.length;h=D.offsetHeight,i=D.offsetWidth,y||(e=zmsuite.getCenter()[0].$el,g=e.offset().left+e.width()/2,y=x.offset().left>g?"pright":"pleft"),r=this,q=$("<div/>"),z?($("#"+z).remove(),q[0].id=z):($("#zm_dropDown").remove(),q[0].id="zm_dropDown");var O="SC_dd";if(!G&&u.spanClass&&(O=u.spanClass),q.addClass(O+" shw"),q.mousedown(function(a){_zm.stopEvents(a,!0)}),N){if(p=$("<ul/>"),u.clk&&p.click(function(a){var b,c=a.target||a.srcElement,d=$(c).closest("li");b=d.data(),d.hasClass("SC_op3")||u.clk(b,c,a)}),u.ulClass&&p.addClass(u.ulClass),u.liDom)for(N=u.liDom.length,m=0;m<N;m++)p.append(u.liDom[m]);else{var P=function(a,d,e){return function(){if("disabled"!==v[a].state){var f,g,h,i,j;c(v),f="function"==typeof v[a].child?v[a].child():v[a].child,f&&(v[a].align?g=v[a].align:(i=zmail.isComposeMail?$("#zmComposeWrapper"):zmsuite.getCenter()[0].$el,j=i.offset().left+i.width()/2,g=x.offset().left>j?"cright":"cleft"),f.par=d,f.align=g,f.clk=f.clk||u.clk,f.isChild=!0,f.container=e.dropObj.container,h=new b(f),h.paint())}}};for(m=0;m<N;m++)v[m]&&(o=$("<li/>"),v[m].sep?o.addClass("SC_lne"):o.html(v[m].htm),v[m].className&&o.addClass(v[m].className),v[m].nohover&&o.addClass("nohr"),v[m].data&&o.data(v[m].data),"disabled"===v[m].state&&o.addClass("SC_op3"),o.mouseover(P(m,o,r)),p.append(o))}p.on("contextmenu",function(){return!1}),a=$("<div/>"),a.append(p),q.append(a)}else E&&q.append(E);$(D).append(q),u.parWidth&&q.width()<x.outerWidth()&&q.width(x.outerWidth());var Q=q.height();"cleft"===y||"colorpicker"===y?(n="cleft"===y?x.parent().width():x.width(),f=q.width(),A.left+n+f>i?(q.find("ul").addClass("SC_ddr"),q.css("right",i-A.left)):q.css("left",C+n),F-=parseInt(q.find("ul").css("padding-top")),F+Q>h&&F-Q>0?q.css({top:F+B-Q}):q.css({top:F})):"pright"===y?(f=x.outerWidth(!0),C-=I.left,F-=I.top,C=i-(C+f),u.loadCopt&&(C+=1),q.find("ul").addClass("SC_ddr"),H&&"bottom"===H?(t=F-Q,C+=1,k="SC_ddRtB",l="botRt"):(t=F+B-L-M,k="SC_ddRt",l="topRt"),a&&a.addClass(k),q.css({right:C+"px",top:t+"px"})):"cright"===y?(f=x.outerWidth(!0),C-=I.left,F-=I.top,C=i-C,q.find("ul").addClass("SC_ddr"),q.css({right:C+"px"}),q.find("ul").length&&(F-=parseInt(q.find("ul").css("padding-top"))),a&&a.addClass("SC_ddRt"),F+Q>h&&F-Q>0?q.css({top:F+B-Q}):q.css({top:F})):"pleft"===y?(s=C-I.left,F-=I.top,.7*D.getBoundingClientRect().height<F&&(H="bottom"),H&&"bottom"===H?(q.find("ul").addClass("SC_ddr"),t=F-Q,l="botLt"):(t=F+B-L-M-1,l="topLt"),q.css({left:s+"px",top:t+"px"})):"mright"===y&&(f=x.width(),C=i-C,q.find("ul").addClass("SC_ddr"),q.css({right:C+"px",top:F-q.height()/2})),l&&q.addClass(l),j=q.height()+q.offset().top-I.top-(h-K),j>0&&a&&!J&&(j+=K,a.height(q.height()-j)),$("[data-drop='1']").removeAttr("data-drop"),"pleft"!==y&&"pright"!==y||x.attr("data-drop","1"),setTimeout(function(){q.addClass("shw")},300),$.publish("/mail/menuCreated",[{element:q[0],menuHandler:d,menuArgsArray:[x,!u.isChild,u]}]),this.$el=q},paintArrowDrop:function(){var a,b,c,e,f,g,h,i,j,k,l,m,n,o,p,q=this.dropObj,r=q.list,s=$(q.par),t=s.offset(),u=s.height(),v=s.width(),w=q.divId,x=0;if(c=$(document.body).height(),e=$(document.body).width(),k=$("<span/>"),w?($("#"+w).remove(),k[0].id=w):($("#zm_dropDown").remove(),k[0].id="zm_dropDown"),k.addClass("SC_arm"),k.mousedown(function(a){_zm.stopEvents(a,!0)}),f=q.ulClass||(q.liHover===!1?"":"SC_Phr "),j=$("<ul/>"),j[0].className=f,q.spanClass&&k.addClass(q.spanClass),q.clk&&j.click(function(a){var b,c=a.target||a.srcElement;b=$(c).closest("li").data(),q.clk(b,c)}),q.liDom)for(l=q.liDom.length,h=0;h<l;h++)j.append(q.liDom[h]);else if(r&&r.length)for(l=r.length,h=0;h<l;h++)r[h]&&(i=$("<li/>"),r[h].sep?i.addClass("SC_lne"):i.html(r[h].htm),r[h].data&&i.data(r[h].data),"disabled"===r[h].state&&i.addClass("SC_op3"),r[h].nohover&&i.addClass("nohr"),j.append(i));if(q.buttons){for(n=q.buttons,x=n.length,o=$("<div class='SC_PUbtm'/>"),i=$("<li/>"),h=0;h<x;h++)m=$("<span/>"),m.html(n[h].txt),m.on("click",n[h].callback),o.append(m);i.append(o),j.append(i)}q.htm&&q.loadHTML?k.append(q.htm):k.append(j);var y=12;if(q.removeArrow&&(k.addClass("na"),y=0),q.direction||(q.autoPosition=!0,t.top>c/2&&(q.direction="bottom")),"left"===q.direction)a=q.left||t.left+v,b=q.top||t.top,k.addClass("lt"),k.css({left:a+"px",top:b+"px"}),$(document.body).append(k),setTimeout(function(){k.addClass("shw"),k.css("left",k.offset().left+y+"px")},200);else if("bottom"===q.direction)y&&(y+=11),$(document.body).append(k),a=q.left+v/2-k.width()/2||t.left+v/2-k.width()/2,b=q.top-k.height()||t.top-k.height(),b<10&&(j.css("height",t.top-(70+y)),j.css("overflow-y","auto"),b=70+y),k.addClass("bt"),k.css({left:a+"px",top:b+"px"}),setTimeout(function(){k.addClass("shw"),k.css("top",k.offset().top-y+"px")},200);else if("right"===q.direction)$(document.body).append(k),p=k.height(),b=q.top||t.top+u/2-p/2,g=15,a=q.right||e-t.left,b<10||b+p/2<c-g?(t.top<c/2?(b=t.top-y,k.addClass("rtt"),b+k.height()>c-g&&(j.css("height",k.height()-(b+k.height()-c+g)),j.css("overflow-y","auto"))):(b=q.top||t.top+u-k.height(),k.addClass("rtb"),!q.top&&b<1&&(b=y,j.css("height",t.top+y),j.css("overflow-y","auto"))),k.css({right:a+"px",top:b+"px"}),setTimeout(function(){k.addClass("shw"),k.css("right",e-k.offset().left-k.width()+y+"px")},200)):(k.addClass("rt"),k.css({right:a+"px",top:b+"px"}),setTimeout(function(){k.addClass("shw"),k.css("right",e-k.offset().left-k.width()+y+"px")},200));else if("rightBottom"===q.direction)$(document.body).append(k),a=q.right||e-t.left,b=q.top||t.top+u-k.height(),k.addClass("rtb"),!q.top&&b<1&&(b=y,j.css("height",t.top+y),j.css("overflow-y","auto")),k.css({right:a+"px",top:b+"px"}),q.bottom&&k.css({bottom:q.bottom}),setTimeout(function(){k.addClass("shw"),k.css("right",e-k.offset().left-k.width()+y+"px")},200);else{if($(document.body).append(k),a=q.left||t.left+v/2-k.width()/2,b=q.top||t.top,p=k.height(),k.addClass("tp"),b+p+10>c){var z=p+b-c;z+=70,j.css("height",p-z+"px"),j.css("overflow-y","auto")}k.css({left:a+"px",top:b+u+"px"}),setTimeout(function(){k.addClass("shw"),k.css("top",k.offset().top+y+"px")},200)}$.publish("/mail/menuCreated",[{element:k[0],menuHandler:d,menuArgsArray:[null,!q.isChild,q]}]),j.on("contextmenu",function(){return!1}),this.$el=k}},b.prototype.hide=function(){var a=this;a.$el.hide()},b.prototype.remove=function(){var a=this;a.$el.remove(),"function"==typeof a.dropObj.onHide&&a.dropObj.onHide()},b.prototype.show=function(){var a=this;a.$el.show(),a.position()},b.prototype.position=function(a){var b=this,c=zmail.Components.AutoFill.Helper.getAutofillViewPort();a=a||{},a.arrowPadding=a.arrowPadding||12,b.dropObj.showArrow||(a.arrowPadding=0);var d=$(b.$el)[0],e=$(b.dropObj.par)[0],f=null,g=null,h=null,i=a.arrowPadding,j=0,k=0,l=!1,m=!0;f={left:0,top:0},d&&e&&($(d).css({height:"auto"}),g=e.getBoundingClientRect(),h=d.getBoundingClientRect(),f.left=g.left,f.left-=(h.width-g.width)/2,j=Math.abs(g.top-c.top),k=Math.abs(g.bottom-c.bottom),b.dropObj.autoPosition||"top"!==b.dropObj.direction?b.dropObj.autoPosition===!0&&(m=j<k):m=!1,$(d).removeClass("tp").removeClass("bt").removeClass("scroll-active"),m?(f.top=g.bottom+i,k<h.height+i&&($(d).css({height:k-i+"px"}).addClass("scroll-active"),l=!0),$(d).addClass("tp")):(f.top=g.top-h.height-i,f.top<c.top&&(f.top=c.top),j<h.height+i&&($(d).css({height:j-i+"px"}).addClass("scroll-active"),l=!0),$(d).addClass("bt")),$(d).hide(),$(d).css({top:f.top+"px",left:f.left+"px"}),$(d).show(),l&&"function"==typeof a.onResize&&a.onResize({wrapperDOM:d,height:d.getBoundingClientRect().height,position:m?"bottom":"top",insufficientSpace:l}))},a.zmDropDownMenu=b}(window),function(a){"use strict";function b(a){this.menuObj=a&&a.menuObj}var c=function(a,b){a&&b&&zmUtil.removeRightClickSelection(a)};b.prototype={setMenuObj:function(a){this.menuObj=a},paint:function(a){var b,d=this.menuObj.conArr,e=this;if(d){b=this.menuObj.divId||"zmCntxtMenu";var f=d.length;if(f){var g=$("<div/>");$("#"+b).remove(),g[0].id=b,g[0].className="SC_dd shw notrans",g.mousedown(function(a){zmUtil.stopEvents(a,!0)});var h=$("<div/>");g.append(h),g.click(function(a){var b=a.target||a.srcElement;b=$(b).closest("li"),b.hasClass("SC_op3")||e.menuObj.clk(a,b.data())}),g.on("contextmenu",function(){return!1});var i=$("<ul/>");h.append(i);for(var j=0;j<f;j++){var k=$("<li/>"),l=d[j].cEdit===!0,m=d[j].id?d[j].id:"";if(k.data(d[j].data),d[j].htm)if(l){var n=$("<div/>");n[0].innerHTML=d[j].htm,n[0].id=m,k.append(n)}else k[0].innerHTML=d[j].htm,k[0].id=m;else d[j].sep&&(k[0].className="SC_lne",k[0].id=m);i.append(k)}var o=a.clientY,p=a.clientX;$("body").append(g);var q=$("#"+b).height()+o,r=$("#"+b).height(),s=$(document.body).height();if(g)if(q>s-100&&o-r>=0){var t=s-o;g.css({bottom:t,left:p})}else g.css({top:o,left:p});$.publish("/mail/menuCreated",[{element:g[0],menuHandler:c,menuArgsArray:[a.target||a.srcElement,this.menuObj.removeSelection]}])}}}},a.zmContextMenu=b}(window);