window.zmComponent=function(a){"use strict";a=a||{};var b={},c={push:function(a){c.handle(a)},addHandler:function(a,c){b[a]=c},commonHandler:function(a){window.console.log("unhandled notification : ",a),a.error?zmUtil.updOutbox(a):a.shareId?zmshare.shNotify(a):a.bulk||a.sweep?zmmailAct.notifyBulkAction(a):zmmailAct.doActions("newm","chat",a)},handle:function(a){var d=a.module||"";(b[d]||c.commonHandler)(a)}};return a.notifier={push:c.push,addHandler:c.addHandler},a}(window.zmComponent),window.zmComponent=function(a){"use strict";a=a||{};var b,c,d,e,f=[],g=[],h=0,i={new_notification:function(a){return["DIV",{attrs:{"class":"SC_newmail"},child:[["UL",{attrs:{"class":"SC_P2r"},child:[["LI",{child:[["DIV",{child:[["SPAN",{child:[["text",a.sender]]}],["SPAN",{child:[["text",a.subject]]}]]}]]}]]}]]}]}},j={newNotification:function(a){var b={};b.subject=a.SB||"",b.sender=a.SN||"";var c=zmComponent.htmlizer(i.new_notification(b));return c}},k={start:function(){return h<b?void k.create():void(h=h>b?0:h)},add2Q:function(a){a.elm=j.newNotification(a),f.push(a),d=d||setInterval(function(){k.start()},1e3)},popFromQ:function(a){k.destroy(a)},addElm2Parent:function(a){var b=c.firstChild;b?_zm.before(b,a):_zm.append(c,a)},create:function(){if(f.length>0){var a=f.shift(),b=a.elm;g.push(a),k.action(b,a),k.addElm2Parent(b),h++,zmComponent.soundNotifier.play("mail"),setTimeout(function(){k.popFromQ(b)},4e3)}else clearInterval(d),d=void 0},action:function(a,b){zmComponent.bind({elm:a,ev:"click",fn:e,args:[b]})},destroy:function(a){_zm.addClass(a,"SC_hde"),setTimeout(function(){_zm.remove(a)},200),h=h>0?h-1:0}},l=function(d){return c=d&&d.parent||document.body,b=d&&d.notifications2Display||2,e=d&&d.openMail||function(a){window.console.log("open mail for this notification : ",a)},{push:function(a){k.add2Q(a)},nobj:function(){return a.debug?g:""}}};return a.mailNotifier=function(a){return l(a)},a}(window.zmComponent),function(){"use strict";zmComponent.soundNotifier={};var a,b=zmComponent.soundNotifier,c={},d=["mail","stream"],e=".mp3",f={},g=1,h=0,i="undefined"!=typeof window.Audio&&"function"==typeof window.Audio,j={1:"Bell",2:"Electric",3:"Cue",4:"Wink",5:"Ting"},k=[h];Object.keys(j).forEach(function(a){k.push(Number(a))});var l=function(a){var b;if(j.hasOwnProperty(a)&&i)return b=j[a]+e,new Audio(zmail.mediaPath+b)},m=function(a){var b,c=f[a];return b=j.hasOwnProperty(c)?j[c]+e:j[g]+e,new Audio(zmail.mediaPath+b)},n=function(a){"undefined"!=typeof c[a]&&(c[a].pause(),c[a].currentTime=0)},o=function(a,b){d.indexOf(a)>-1&&(f[a]=b||h,b&&i&&(c[a]=m(a)))},p=function(){zmail._newSettings&&(a=zmail.Settings.MailSuite.Settings.General.MailSoundNotifier.Setting,o("mail",a.get()),a.on("props.change",function(a){a=a||{},a.changed.hasOwnProperty("value")&&o("mail",a.changed.value)}))};b.play=_.throttle(function(a){var b=zmUtil.getWindowVisibilityStatus();b=b<=0;try{if(!b||!f[a]||!i)return;"undefined"==typeof c[a]?c[a]=m(a):n(a),c[a].play()}catch(d){}},500),b.stop=function(a){"undefined"!=typeof c[a]&&c[a].pause()},b.initialize=p,b._allowedValues=k,b.soundCodesMap=j,b._getAudioObject=l,b._isSupported=i}();