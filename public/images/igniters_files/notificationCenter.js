window.zmNCenter=function(a){"use strict";a=a||{};var b={};return b.moduleName="notificationCenter",b.ncount=0,b.uri=zmail.conPath+"/ncenter.do",b.streamsModuleName="streamsApp",b.streamuri=zmail.conPath+"/stream.do",b.streamTabName="zm_stream",b.popoutElmId="zmncpreview",b.workSpaceName="zmncenter",b.newNotification={tab:"/ncenter/newNotification/tab",popout:"/ncenter/newNotification/popout"},b.topbarCloseEvent="ztopbarpopoverclose",b.hideMenuEvent="/mail/menuCreated",b.actionIconId="ztb-notifications",b.popoutId="notifications",b.viewSelfData="viewSelfData",b.viewGroupData="viewGroupEntity",b.pagination="pagination",b.systemIcon=zmail.imgPath+"mail-icon.png",b.systemName="Zoho Mail",b.removePopoutPreview="/ncenter/closePreview",b.range=20,b.reconnect="zmailReconnect",b.types={addPost:"30",groupMember:["50","51"],sharedFolder:["52","53","54","60"],removeSelfFor:["23","31","49"]},b.formatter={showUsers:3,replacePatterns:{groupName:"{{groupName}}",entityName:"{{entityName}}",role:"{{role}}",folderName:"{{folderName}}",zuid:"{{zuid}}"}},b.css={streamIconHighlight:"SC_newActivity",popoutStyle:"width: 510px; opacity: 1",workSpaceClass:"SC_notification",tabIcon:"msi-notification",closeIcon:"msi-close",entityIcon:{1:"msi-mail",2:"msi-notes",3:"msi-task",4:"msi-calendar",6:"msi-status",9:"msi-mail"},actionIcon:{31:"msi-chat",36:"msi-chat",43:"msi-chat",25:"msi-mention",38:"msi-mention",44:"msi-mention",45:"msi-mention",23:"msi-love",49:"msi-love",29:"msi-invitee",50:"msi-addgroup"},list:{selection:"zmSLst"}},b.params={mode:"groupedlist",eType:"-1"},b.notificationTypes={4:"MAIL_TYPE",23:"LIKE",25:"POST_MENTION",27:"UNSHARED",29:"INVITE",30:"ADD_POST",31:"ADD_COMMENT",32:"DELETE_POST",34:"DELETE_COMMENT",35:"DELETE_PRIVATE_COMMENT",36:"ADD_PRIVATE_COMMENT",37:"CHANGE_ENTITY",38:"COMMENT_MENTION",39:"BULK_UPDATE",40:"BULK_DELETE",41:"ADD_TASK",42:"REMINDER_TASK",43:"ADD_SHARE_COMMENT",44:"POST_GROUP_MENTION",45:"COMMENT_GROUP_MENTION",46:"ADD_EVENT",47:"UPDATE_EVENT",48:"DELETE_EVENT",49:"LIKE_COMMENT",50:"ADD_GROUP_MEMBER",51:"REMOVE_GROUP_MEMBER",52:"RESOURCE_SHARE",53:"SHAREPERM_CHANGE",54:"SHAREPERM_REMOVAL",55:"UPDATE_EVENT_STATUS_YES",56:"UPDATE_EVENT_STATUS_NO",57:"UPDATE_EVENT_STATUS_MAYBE",58:"TASK_ASSIGN",59:"MAIL_REMINDER",60:"ACCEPT_SHARE",61:"MAIL_SHARE",62:"ADD_ATTACHMENT",63:"CHANGE_TASK_DUE_DATE",64:"CHANGE_TASK_ASSIGNEE",65:"CHANGE_TASK_STATUS",66:"CHANGE_TASK_PRIORITY",67:"CHANGE_TASK_CATEGORY",68:"CHANGE_TASK_TITLE",69:"CHANGE_TASK_DESCRIPTION",70:"REMOVE_ATTACHMENT",71:"DRAFT_SHARE",72:"DRAFT_SHAREUPDATE",73:"DRAFT_MAILMENTION",74:"SHARE_UNSUBSCRIBE",75:"STREAM_GROUP_ENABLE",76:"STREAM_GROUP_DISABLE",77:"MAIL_STREAMS_ENABLE",78:"MAIL_STREAMS_DISABLE",79:"ADD_LINK",80:"CHANGE_LINK_CATEGORY",81:"CHANGE_LINK_TITLE",82:"CHANGE_LINK_DESCRIPTION",83:"CHANGE_LINK_URL",84:"MARK_LINK_FAV",85:"CALENDAR_REMINDER",86:"CALENDAR_REMINDER_MAILID_CHANGE",87:"CALENDAR_SHARING",88:"CALENDAR_UNSUBSCRIBE",89:"BIZ_SUB_ONLINE_RENEW_DUE_FEWDAY",90:"BIZ_SUB_ONLINE_RENEW_TDY",91:"BIZ_SUB_ONLINE_RENEW_OVERDUE",92:"BIZ_SUB_ONLINE_RENEW_OVERDUE_TDY",93:"BIZ_SUB_OFFLINE_RENEW_DUE_FEWDAY",94:"BIZ_SUB_OFFLINE_RENEW_TDY",95:"BIZ_SUB_OFFLINE_RENEW_OVERDUE",96:"BIZ_SUB_OFFLINE_RENEW_OVERDUE_TDY",97:"BIZ_SUB_PURCHASE_MORE",98:"BIZ_SUB_PURCHASE",99:"DOMAIN_NOT_VERIFIED",100:"DOMAINS_NOT_VERIFIED",101:"MAIL_HOSTING_NIL",102:"MX_NOT_POINTED_TO_ZOHO",103:"REG_DOMAIN_AUTO_RENEW",104:"REG_DOMAIN_MANUAL_RENEW",105:"ADD_SUBTASK",106:"EDIT_LINK",107:"LOCK_INVITES",108:"UNLOCK_INVITES",110:"DOMAIN_SPF_MISSING",111:"DOMAIN_DKIM_MISSING"},a.constants=b,a}(window.zmNCenter),window.zmNCenter=function(a){"use strict";return a=a||{},a.text=zmText.get("notificationCenter"),a.init=function(){a.core()},a}(window.zmNCenter),window.zmNCenter=function(a){"use strict";a=a||{};var b={},c=a.text;return b.nameWrapper=function(a){return["STRONG",{child:[["text",a]]}]},b.nameSeparator=["text",", "],b.textWrapper=function(a){return["text",a]},b.andWrapper=function(a,d){return[b.textWrapper(" "+c.common.and+" "),a?b.textWrapper(d+" "+c.common.others):b.nameWrapper(d)]},b.notificationItem=function(a){var b=_zm.getProperty(a,"photo"),c=_zm.getProperty(a,"framedText"),d=_zm.getProperty(a,"actionIcon"),e=_zm.getProperty(a,"timestamp"),f=_zm.getProperty(a,"ctime"),g=["DIV",{attrs:{"class":"zmL"},child:[["DIV",{attrs:{"class":"zmLst"},child:[["DIV",{attrs:{"class":"zmDtl"},child:[["DIV",{attrs:{"class":"zmImg"},child:[["IMG",{attrs:{src:b}}]]}],["DIV",{attrs:{"class":"zmFrm"},child:[["SPAN",{child:c}]]}],["DIV",{attrs:{"class":"zmSub"},child:[["I",{attrs:{"class":d}}],["SPAN",{attrs:{"class":"sum zmnTimer","zmn-time":f},child:[["text",e]]}]]}]]}]]}]]}];return _zm.getDOM(g)},b.eventNotificationItem=function(a){var b=a._eventData.title,c=a._eventData.remTime,d=a._eventData.stDate,e=["DIV",{attrs:{"class":"zmL"},child:[["DIV",{attrs:{"class":"zmLst"},child:[["DIV",{attrs:{"class":"zmDtl"},child:[["DIV",{attrs:{"class":"zmImg noBdr"},child:[["I",{attrs:{"class":"msi-remind"}}]]}],["DIV",{attrs:{"class":"zmFrm"},child:[["SPAN",{child:[["STRONG",{child:[["text",c],["H3",{child:[["text",b]]}]]}]]}]]}],["DIV",{attrs:{"class":"zmSub"},child:[["SPAN",{attrs:{"class":"sum"},child:[["text",d]]}]]}]]}]]}]]}];return _zm.getDOM(e)},b.systemNotificaitonItem=function(b,c){var d,e=a.constants.systemIcon,f=a.constants.systemName,g=["DIV",{attrs:{"class":"zmL zm_urd"},child:[["DIV",{attrs:{"class":"zmLst"},child:[["DIV",{attrs:{"class":"zmDtl"},child:[["DIV",{attrs:{"class":"zmImg"},child:[["IMG",{attrs:{src:e}}]]}],["DIV",{attrs:{"class":"zmFrm"},child:[["SPAN",{child:[["text",f]]}]]}],["DIV",{attrs:{"class":"zmSub",style:"width: inherit"},child:[["SPAN",{attrs:{"class":"sum",style:"white-space: normal"},child:[["text",b]]}]]}]]}]]}]]}];return c&&(d=["SPAN",{attrs:{"class":"SC_lnk"},child:[["text",c]]}],g[1].child[0][1].child[0][1].child[2][1].child.push(d)),_zm.getDOM(g)},b.getActionButton=function(a){return _zm.getDOM(["DIV",{attrs:{"class":"SC_PUbtm"},child:[["SPAN",{child:[["text",a]]}]]}])},b.seeAllBand=function(){return _zm.getDOM(["DIV",{attrs:{"class":"ztb-see"},child:[["SPAN",{child:[["text",c.common.seeAll]]}]]}])},b.emptyList=function(){return _zm.getDOM(["DIV",{attrs:{"class":"SC_nmsg"},child:[["text",c.common.noNotifications]]}])},b.popout=function(a){return _zm.getDOM(["DIV",{attrs:{id:a,"class":"SCS_popUp"}}])},a.views=b,a}(zmNCenter),window.zmNCenter=function(a){"use strict";a=a||{};var b,c={},d=a.text||{},e=a.views||{},f=a.constants;return b=function(a){var b={t:"POST",u:a.u||f.uri,p:a.param,h:!a.hasOwnProperty("setHeader")||a.setHeader,fn:function(a,b){b.fn(a,b.args)}};a.callback&&(b.ep=a.callback),a.onerror&&(b.onerror=a.onerror),a.onnetfailure&&(b.onnetfailure=a.onnetfailure),zmAjq.XHR(b)},c.getEntityName=function(a){return d.entity[a]},c.loadActionText=function(){d.actionText={}},c.req=b,c.getActionText=function(a,b,c,e){var g=d.notificationTypes,h=f.notificationTypes[a];return b=0===b?"_F":"_M",c=c?"_FOLLOWER":"",e=e?"_PLURAL":"",h=g.hasOwnProperty(h+b)?h+b:h,h=g.hasOwnProperty(h+e)?h+e:h,h=g.hasOwnProperty(h+c)?h+c:h,g[h]||h},c.getUser=function(a){return zmCont.getOrgContacts(a)[a]},c.getActionIcon=function(a,b){return f.css.actionIcon[a]||f.css.entityIcon[b]},c.getSummaryText=function(a,b){return b=b instanceof Array?b[0]:b,b=!a&&b&&b.trim().length>0?' : "'+b+'..."':""},c.getStreamIcon=function(){return _zm(".","msi-streams",_zm("#","ztb-topband"))[0]},c.getBadgeCount=function(a){b({param:{mode:"count"},callback:{fn:a}})},c.resetBadgeCount=function(a){b({param:{mode:"reset"},callback:{fn:a}})},c.paginate=function(a,b,c){var d=function(a,b,c){a.offsetHeight+a.scrollTop>=a.scrollHeight-50&&b(c)};_zm.bindReset(b,"scroll",d,[b,c,a])},c.folderShare=function(){var d,f,g,h,i=!1;return g=function(a){return _zm.getProperty(a,"folder.confirmationkey")},h=function(a,c,d,e,f){b({u:zmail.conPath+"/confirm.do",param:{mode:"sharedFolder",key:d,ownerZuid:c,shId:a},callback:{fn:e,args:f}})},f=function(a,b){if(!i){i=!0;var c=b.shId,d=b.owner,e=g(b);h(c,d,e,function(a,b){if(i=!1,a){var c=b[0];_zm.remove(c)}},[a,b])}},d=function(b,d){if(c.isNotificationOf.folderShare(b.ntype)){var h,i=g(b);i&&(h=e.getActionButton(a.text.label.accept),_zm.bind(h,"click",f,[h,b]),_zm.before(d.childNodes[0],h))}}}(),c.isNotificationOf={newMemberAddition:function(a){return f.types.groupMember.indexOf(a)>-1},folderShare:function(a){return f.types.sharedFolder.indexOf(a)>-1},removeSelf:function(a){return f.types.removeSelfFor.indexOf(a)>-1}},c.isItemViewable=function(a){var b=a.ntype;return!!f.notificationTypes.hasOwnProperty(b)&&(c.isNotificationOf.removeSelf(b)&&a.nby.indexOf(zmail.zuid)>-1&&a.nby.splice(a.nby.indexOf(zmail.zuid),1),a.nby.length>0)},c.isItemClickable=function(a){return this.isEventNotification(a)||!(a.isDeleted||"true"===String(_zm.getProperty(a,"sysevent")))},c.isCommentBoxEmpty=function(a){if(a){var b=_zm("<","textArea",_zm(".","zm_mention",a)[0])[0];if(b&&"fixed"===_zm.attr(b,"data-type")&&""!==b.value)return!window.confirm(d.common.unpublishedContentWarning)}return!0},c.loadPreview=function(a){var b=a.data,c=a.previewElm,d=a.fixedComment,e=a.openType;this.isEventNotification(b)?this.notificationPreview.event(b,c):this.notificationPreview.stream(b,c,d,e)},c.notificationPreview={stream:function(a,b,c,d){var e,g=a.group.id,h=a.eid,i=a.etype,j=a.group.isGroup?f.viewGroupData:f.viewSelfData,k=a.shId||"",l=a.ntype;return"59"===String(l)?void $.publish("ncenter/watchReminder",{mailID:a.eid,parentDOM:$(b)[0],isPopup:c}):(e=function(b,c,d){var e={gid:g,pid:h,etype:i,actionType:j,fixedComment:c,allComments:!0,elm:b,shId:k,ntype:l,group:a.group,markRead:!0,opentype:d};a.commentuuid&&(e.commentuuid=a.commentuuid),zmStreamsApp.events.openPost(e)},void("undefined"!=typeof zmStream?e(b,c,d):zmAppLoader.load(f.streamsModuleName).done(function(){e(b,c,d)})))},event:function(a,b){ZCL_streamEve.streamEveNotificationPreview(a,b)}},c.workspace=function(a){var b,c,e,g=a.name;return zmsuite.isWorkspaceAvailable(g)||(zmsuite.setWorkSpace(a.appConfig),b=zmsuite.getCenter()[0].getNodes(),b[0].push({left:[],right:[{actionArr:[{iconList:[f.css.closeIcon],data:"close",tooltip:d.common.close}]}]}),b[1].push({left:{leftHTML:a.appConfig.appname}}),b[0].setListener("click",function(b,c,d){"close"===d&&(zmsuite.closeWorkspace(g),a.destroy&&a.destroy())}),zmsuite.renderWorkSpace(),b=zmsuite.getCenter()[0].getNodes(),b[2].setListener("click",a.listingClick),c=zmsuite.getCenter()[1],e=c.getNodes()[0],_zm.addClass(e.$el.children(".SC_phd")[0],"SC_Sph"),e.push({text:"",rIcons:[[{tooltip:d.common.close,iconClass:f.css.closeIcon,data:"close"}]]}),e.setListener("click",function(b){"close"===b&&a.closePreview&&a.closePreview(c)})),zmsuite.showWorkSpace(g),b=zmsuite.getCenter(),{listArea:b[0].getNodes()[2].$el[0],previewCard:b[1]}},c.eventTimeRemaining=function(a,b){var c=b/1e3,d={unit:"millis",value:b,state:a};return c<60?(d.unit="seconds",d.value=c,d):(c/=60,c<60?(d.unit="minutes",d.value=c,d):(c/=60,c<24?(d.unit="hours",d.value=c,d):(c/=24,d.unit="days",d.value=c,d)))},c.isEventNotification=function(a){return"85"===String(_zm.getProperty(a,"ntype"))},c.parseJSON=function(a){_zm.getProperty(a,"folder")&&(a.folder="string"==typeof a.folder?$.parseJSON(a.folder):a.folder)},c.updateTime={start:function(a){return setInterval(function(){for(var b,d=_zm(".","zmnTimer",a),e=0,f=d.length;e<f;e++){b=d[e];var g=b.getAttribute("zmn-time");_zm.setTextContent(b,c.relativeTime(g),!0)}},5e3)},stop:function(a){clearInterval(a)}},c.relativeTime=function(a){return zmComponent.dateTimeUtil.relativeTime(a,"mm dd at hr:min")},c.showLoader=function(a){return zmComponent.loadingBand({container:a,type:f.pagination})},c.reconnect=function(){a.dataStore.cache.reset(),"undefined"!=typeof _zm.getProperty(a,"tab.list")&&a.tab.list.init(),"undefined"!=typeof _zm.getProperty(a,"popout.list")&&a.popout.list.init()},a.helper=c,a}(zmNCenter),function(a){"use strict";var b,c,d,e,f,g,h={},i=a.helper,j=a.constants,k=[],l=0;c=function(){i.req({u:"/biz/bizApi.do",param:{mode:"bannerMsg"},setHeader:!1,callback:{fn:function(b){k=b,l=b.length,a.counter.increment(l)}}})},d={item:function(b){var c,d=a.constants.systemIcon,e=a.constants.systemName;return c=["DIV",{attrs:{"class":"zmL sysNoti"},child:[["DIV",{attrs:{"class":"zmLst"},child:[["DIV",{attrs:{"class":"zmDtl"},child:[["DIV",{attrs:{"class":"zmImg"},child:[["IMG",{attrs:{src:d}}]]}],["DIV",{attrs:{"class":"zmFrm"},child:[["SPAN",{child:[["text",e]]}]]}],["DIV",{attrs:{"class":"zmSub",style:"width: inherit"},child:[["SPAN",{attrs:{"class":"sum",style:"white-space: normal"},child:[["text",b]]}],["SPAN",{attrs:{style:"white-space: normal; display: block","class":"zmn-bactions"}}]]}]]}]]}]]}],_zm.getDOM(c)},action:function(a){var b,c=a.text,d=a.type;return b=["B"],"goto"===d&&(b=["SPAN",{attrs:{"class":"SC_lnk",style:"display:inline"},child:[["text",c]]}]),_zm.getDOM(b)}},f=function(a){for(var c=0;c<l;c++){var f=k[c],g=f.actions,h=d.item(b(f));e(h,g),a.appendChild(h)}},b=function(a){var b=a.type,c=a.placeholder;return zmText.get(j.moduleName,"notificationTypes."+b,c)},e=function(a,b){for(var c=_zm(".","zmn-bactions",a)[0],e=0,f=b.length;e<f;e++){var h=b[e],i=d.action(h),j=h.uri,k=h.type;c.appendChild(i),"goto"===k&&g(i,j)}},g=function(a,b){_zm.bindReset(a,"click",function(a){window.open(a,"_blank")},[b])},h.render=f,h.data=function(){return k},h.count=function(){return l},c(),a.bizNotification=h}(zmNCenter||{}),function(a){"use strict";a=a||{};var b,c,d,e,f,g,h,i=a.helper,j=a.constants,k=!1,l=i.req,m=j.range||20;c=function(){var a,b,c,d,e,f,g,h,i,j,k=0;return f={keys:[],values:{},hasNext:!0},a=function(a){for(var b=a>0?a:0,c=0,d=[],e=f.keys.length;c<e;c++)d.push(f.values[f.keys[b+c]]);return d},b=function(a,b){var c=a.nid;f.keys.indexOf(c)<0&&(f.keys.splice(b,0,c),f.values[c]=a,k++)},c=function(a){f.hasNext=a.length>m;for(var c in a){var d=a[c];b(d,k)}},d=function(a){b(a,0)},i=function(a){return f.keys.length>(a?m:1)},j=function(){return f.hasNext},e=function(){f.keys=[],f.values={},f.hasNext=!0,k=0},g=function(){return(f.values[f.keys[k-1]]||{}).nid},h=function(){return k},{data:f,reset:e,get:a,append:c,prepend:d,itemIndex:h,lastItem:g,hasData:i,hasNext:j}}(),g=function(){var a,b,c,d,e=!1;return b=function(a){e=!0,d=i.showLoader(a)},c=function(){e=!1,d()},a=function(){return e},{inProgress:a,initiated:b,completed:c}}(),d=function(a){var b=a.callback,d=a.initialLoad;if(d){if(c.hasData(d))return b(c.get(0),a),!1;c.hasNext()||c.reset()}else if(!d&&!c.hasNext()||g.inProgress())return!1;g.initiated(a.listInstance.listWrapper);var f={},h=c.itemIndex(),i=c.lastItem();f.mode=j.params.mode,f.range=m,f.isPrev=!1,f.entityType=j.params.eType,k?f.startIndex=h:"undefined"!=typeof i&&(f.start=i),l({param:f,callback:{fn:e,args:[b,a]},onerror:g.completed,onnetfailure:g.completed})},h=function(a){var b=[];if(Array.isArray(a))k||(k=!0),b=a;else for(var c=a.list,d=a.order,e=0,f=d.length;e<f;e++)b.push(c[d[e]]);return b},e=function(a,b){var d=h(a),e=b[0],f=b[1];c.append(d),e(d,f),g.completed()},f=function(a){zmail.hasOwnProperty("ncount")?a(j.ncount):l({param:{mode:"count"},callback:{fn:function(a,b){c.count=a.count,b(c.count)},args:a}})},b={cache:c,count:f,get:d,put:c.prepend,hasNext:c.hasNext},a.dataStore=b}(zmNCenter),window.zmNCenter=function(a){"use strict";a=a||{},a.wmsData=a.wmsData||[];var b,c,d,e,f,g,h,i=a.constants;return b=function(){h(),d(),e(),c()},h=function(){var b=a.text.common;$("#ztb-notifications-popover .ztb-popover-content").addClass("SC_notification notiPopUp"),$("#ztb-notifications-popover .ztb-popover-label").text(b.title),$("#ztb-notifications-popover").width("450px"),$("#ztb-notifications-popover").append(a.views.seeAllBand())},d=function(){$("#ztb-notifications-popover div:last").click(function(){$("#ztb-notifications-popover .ztb-popoverClose").click(),a.tab()}),a.popout()},e=function(){$.subscribe(i.reconnect,c),zmComponent.notifier.addHandler("streams",f)},c=function(){a.counter(),a.helper.reconnect()},g=function(b){var c=b.refList.split(",");return c.indexOf(zmail.zuid)>-1&&(a.counter.increment(),!0)},f=function(b){g(b)&&(a.wmsData.push(b),a.helper.parseJSON(b),a.dataStore.put(b),$.publish(i.newNotification.tab,b),$.publish(i.newNotification.popout,b)),$.publish(b.module,b)},a.core=b,a}(window.zmNCenter),window.zmNCenter=function(a){"use strict";return a=a||{},a.handlers={add:function(a,b){$.subscribe(a,b)},remove:function(a,b){$.unsubscribe(a,b)}},a}(window.zmNCenter),window.zmNCenter=function(a){"use strict";a=a||{};var b,c,d={},e=a.views||{},f=a.helper||{},g=a.constants.formatter,h=e.textWrapper,i=e.nameWrapper,j=a.text;return b=function(a,b){var c,d=b.entityName,e=b.memberName,f=b.groupName,j=b.folderName,k=b.folderRole,l=g.replacePatterns,m=l.groupName,n=[];return a=a.replace(l.entityName,d),k&&(a=a.replace(l.role,k)),j&&(a=a.replace(l.folderName,j)),e&&(a=a.replace(l.zuid,e)),c=a.indexOf(m),c>-1?(n.push(h(a.substring(0,c))),n.push(i(f)),n.push(h(a.substring(c+m.length)))):n.push(h(a)),n},c=function(a,b){var c,d,h,j=[],k={},l=0,m=0,n=g.showUsers,o={},p=[];for(a="string"==typeof a?[a]:a,l=a.length,c=0;c<l;c++)o.hasOwnProperty(a[c])||(o[a[c]]=!0,p.push(a[c]));for(l=p.length,h=l>n,m=h?n:l,c=0;c<m;c++)d=p[c],d=f.getUser(d),p[c]=d,c>0&&j.push(e.nameSeparator),j.push(i(d.fn));return h&&(j=j.concat(e.andWrapper(h,h?l-n:a[n]))),k.recent=p[0],k.formatted=j,k.count=b,k},d.notificationItem=function(d){var g,i=[],j=d.etype,k=_zm.getProperty(a.text,"common.few_seconds_ago"),l=d.ctime,m=d.nby,n=d.ncount,o=d.ntype,p=d.owner===zmail.zuid,q=d.shgroup||d.group,r="undefined"!=typeof q&&q.isGroup,s=f.getActionIcon(o,j),t=c(m,n),u=t.recent.g,v=t.recent.photo,w=t.count>1,x=f.isNotificationOf.folderShare(o),y=x?d.folder:void 0,z=f.getActionText(o,u,!p,w),A={entityName:f.getEntityName(j),groupName:r?q.name:""};return f.isNotificationOf.newMemberAddition(o)&&(A.memberName=f.getUser(d.memberzuid).fn),x&&(A.folderRole=_zm.getProperty(y,"role"),A.folderName=_zm.getProperty(y,"fName")),i=t.formatted,g=f.getSummaryText(w,d.summary),i.push(h(" ")),i=i.concat(b(z,A)),i.push(h(g)),_zm.getProperty(d,"ctime")&&(k=f.relativeTime(d.ctime)),e.notificationItem({photo:v,framedText:i,actionIcon:s,timestamp:k,ctime:l})},d.eventNotificationItem=function(a){var b=a.summary[0];return a._eventData="string"==typeof b?$.parseJSON(b):b,b=a._eventData,b.remTime=this.eventTimeRemaining("0"===String(b.remType)?"start":"end",b.remTime),e.eventNotificationItem(a)},d.eventTimeRemaining=function(a,b){var c=j.eventNotification.timeRemaining,d=f.eventTimeRemaining(a,b),e=d.unit,g=d.value;return zmText.applyArgs(c[e][a],{value:g})},a.formatter=d,a}(window.zmNCenter),window.zmNCenter=function(a){"use strict";a=a||{};var b,c,d,e,f,g=a.helper;return d=function(a){ztopbar.updateNotificationsCount(a)},e=function(a){c+="undefined"==typeof a?1:Number(a),d(c)},f=function(){c>0&&g.resetBadgeCount(function(a){c=0,d(c)})},b=function(){g.getBadgeCount(function(b){c=b.count,c+=a.bizNotification.count(),d(c)})},b.count=function(){return c},b.increment=e,b.reset=f,a.counter=b,a}(window.zmNCenter),window.zmNCenter=function(a){"use strict";a=a||{};var b,c,d,e,f=a.constants;return c=function(b){a.helper.req({u:f.streamuri,param:{mode:"groups",actionType:"unread"},callback:{fn:function(a){"true"===a.unread&&d()}}})},d=function(b){_zm[b?"removeClass":"addClass"](a.helper.getStreamIcon(),f.css.streamIconHighlight)},e=function(a){zmTab.currentTab!==f.streamTabName&&a.ntype===f.types.addPost&&d()},b=function(){c()},b.onNotification=e,b.defaultStreamIcon=function(){d(!0)},b.blueStreamIcon=function(){d()},a.icon=b,a}(window.zmNCenter),function(a){"use strict";a=a||{};var b,c=a.constants,d=a.helper,e=a.formatter,f=a.dataStore;b=function(b){var g,h,i,j,k;this.listWrapper=b.parent,this.onPagination=b.onPagination,this.whenSelected=b.whenSelected,i=function(a,b,d){var e=c.css.list.selection,f=_zm(".",e,a.parentNode)[0];_zm.removeClass(f,e),_zm.addClass(a,e),d.whenSelected(a,b)},h=function(a,b){if(!d.isItemViewable(b))return!1;var c;return d.isEventNotification(b)?c=e.eventNotificationItem(b):(c=e.notificationItem(b),d.folderShare(b,_zm(".","zmSub",c)[0])),c&&(d.isItemClickable(b)?_zm.bind(c,"click",i,[c,b,a]):_zm.addClass(c,"noPreview")),c},this.addItem=function(a,b,c){_zm.remove(_zm(".","SC_nmsg",c.listWrapper)[0]);var d=h(c,b);d&&(c.listWrapper.hasChildNodes()?_zm.before(c.listWrapper.firstChild,d):c.listWrapper.appendChild(d))},k=function(a,b){for(var c,d=0,e=a.length,f=b.listInstance;d<e;d++){c=a[d],c.isMail="4"===c.ntype,c.isDeleted="34"===c.ntype;var g=h(f,c);g&&f.listWrapper.appendChild(g)}f.emptyList()},g=function(a){f.hasNext()&&(a.loadList(),"undefined"!=typeof onPagination&&a.onPagination())},this.emptyList=function(){this.listWrapper.hasChildNodes()||(this.listWrapper.innerHTML="",this.listWrapper.appendChild(a.views.emptyList()),$(".ztb-see").hide())},this.reset=function(){this.listWrapper.innerHTML="",d.updateTime.stop(j)},this.loadList=function(a){var b=this;zmail.contactsLoadProcess.done(function(){f.get({callback:k,listInstance:b,initialLoad:a})})},this.init=function(){this.reset(),this.timerUpdate=d.updateTime.start(this.listWrapper),a.bizNotification.render(this.listWrapper),this.loadList(!0),d.paginate(this,this.listWrapper,g)},this.init()},a.list=b}(zmNCenter),window.zmNCenter=function(a){"use strict";a=a||{};var b,c,d,e,f,g,h=!1,i=a.constants;return b=function(){var b=_zm("#",i.actionIconId),c=function(){h||(h=!0,a.counter.reset(),d())};_zm.bindReset(b,"click",c),$(document).on(i.topbarCloseEvent,function(a){h&&(h=!1,f())}),e=_zm("#",i.popoutId)},f=function(){$.unsubscribe(i.newNotification.popout,c.addItem),c&&c.reset(),delete a.popout.list},d=function(){c=new a.list({parent:e,whenSelected:function(b,c){a.popout.preview({fromElement:e,data:c})},onPagination:function(){}}),a.popout.list=c,$.unsubscribe(i.newNotification.popout),$.subscribe(i.newNotification.popout,g)},g=function(a,b){c.addItem(a,b,c)},a.popout=b,a}(window.zmNCenter),window.zmNCenter=function(a){"use strict";a=a||{},a.popout=a.popout||{};var b,c,d,e,f,g,h,i=a.constants;return b=function(b){c=b.fromElement;var g=b.data,h="59"!==String(g.ntype);h&&(e(),f()),a.helper.loadPreview({data:g,previewElm:h?d:null,fixedComment:!0})},b.destroy=function(){$.publish(i.removePopoutPreview,[{element:d}]),_zm.remove(d),d=void 0},e=function(){return d?d:(d=a.views.popout(i.popoutElmId),document.body.appendChild(d),_zm.setAttr(d,{style:i.css.popoutStyle}),g(),d)},f=function(){if(d){var a=c.getBoundingClientRect(),b=document.body.getBoundingClientRect().width-a.left,e=a.top-1,f=document.body.getBoundingClientRect().height,g=_zm("#","wmstoolbar").getBoundingClientRect().height;d.style.top=e+"px",d.style.right=b+"px",d.style.maxHeight=f-(g+e+10)+"px"}},h=function(a){zmStreamsApp&&zmStreamsApp.util.hideMenu&&zmStreamsApp.util.hideMenu(),zmUtil.stopEvents(a,!0)},g=function(){_zm.bind(d,"mousedown",h),_zm.bind(d,"mouseup",h),_zm.bind(window,"resize",b.destroy),$.publish(i.hideMenuEvent,[{element:d,menuHandler:function(){$.publish(i.removePopoutPreview,[{element:d}]),d=void 0}}])},a.popout.preview=b,a}(window.zmNCenter),window.zmNCenter=function(a){"use strict";a=a||{};var b,c,d,e,f,g,h,i=a.text,j=a.constants;return b=function(){var b=a.helper.workspace({name:j.workSpaceName,appConfig:{appname:i.common.title,appId:j.workSpaceName,data:{CNodes:"3"},appClass:j.css.workSpaceClass,appIcon:j.css.tabIcon,hashKey:"notifications",hashChangeHandler:function(a,b){var c=this;zmUtil.debugLog("Notifications hash-url changed",b,c)}},destroy:function(){d()},listingClick:function(){},closePreview:function(a){$.publish(j.removePopoutPreview,[{element:a.$el}]),a.close()}});f=b.listArea,g=b.previewCard,e()},e=function(){c=new a.list({parent:f,whenSelected:function(b,c){var d,e="59"!==String(c.ntype);e&&(g.getNodes()[0].headerArr.text=[],g.show(),d=g.getNodes()[1].getDOMNode()[0],d.innerHTML=""),a.helper.loadPreview({data:c,previewElm:e?d:null,fixedComment:!1,openType:"preview"})},range:15}),a.tab.list=c,$.unsubscribe(j.newNotification.tab),$.subscribe(j.newNotification.tab,h)},h=function(a,b){c.addItem(a,b,c)},d=function(){g&&g.close(),$.unsubscribe(j.newNotification.tab),c&&c.reset(),delete a.tab.list},a.tab=b,a}(window.zmNCenter);